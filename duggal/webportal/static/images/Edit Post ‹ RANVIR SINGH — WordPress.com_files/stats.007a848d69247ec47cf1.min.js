webpackJsonp([11],{1632:function(module,exports,__webpack_require__){"use strict";var page=__webpack_require__(33);var controller=__webpack_require__(720),statsController=__webpack_require__(2948),config=__webpack_require__(12);module.exports=function(){if(config.isEnabled("manage/stats")){page("/stats",controller.siteSelection,controller.navigation,statsController.overview);page("/stats/day",controller.siteSelection,controller.navigation,statsController.overview);page("/stats/week",controller.siteSelection,controller.navigation,statsController.overview);page("/stats/month",controller.siteSelection,controller.navigation,statsController.overview);page("/stats/year",controller.siteSelection,controller.navigation,statsController.overview);page("/stats/insights/:site_id",controller.siteSelection,controller.navigation,statsController.insights);page("/stats/day/:site_id",controller.siteSelection,controller.navigation,statsController.site);page("/stats/week/:site_id",controller.siteSelection,controller.navigation,statsController.site);page("/stats/month/:site_id",controller.siteSelection,controller.navigation,statsController.site);page("/stats/year/:site_id",controller.siteSelection,controller.navigation,statsController.site);page("/stats/:module/:site_id",controller.siteSelection,controller.navigation,statsController.summary);page("/stats/day/:module/:site_id",controller.siteSelection,controller.navigation,statsController.summary);page("/stats/week/:module/:site_id",controller.siteSelection,controller.navigation,statsController.summary);page("/stats/month/:module/:site_id",controller.siteSelection,controller.navigation,statsController.summary);page("/stats/year/:module/:site_id",controller.siteSelection,controller.navigation,statsController.summary);page("/stats/post/:post_id/:site_id",controller.siteSelection,controller.navigation,statsController.post);page("/stats/page/:post_id/:site_id",controller.siteSelection,controller.navigation,statsController.post);page("/stats/follows/:follow_type/:site_id",controller.siteSelection,controller.navigation,statsController.follows);page("/stats/follows/:follow_type/:page_num/:site_id",controller.siteSelection,controller.navigation,statsController.follows);if(config.isEnabled("ui/first-view/reset-route")){page("/stats/reset-first-view",statsController.resetFirstView)}page("/stats/(.*)",controller.siteSelection,controller.navigation,statsController.redirectToDefaultSitePage,controller.sites)}}},1680:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _toConsumableArray2=__webpack_require__(41);var _toConsumableArray3=_interopRequireDefault(_toConsumableArray2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _noop=__webpack_require__(38);var _noop2=_interopRequireDefault(_noop);var _button=__webpack_require__(69);var _button2=_interopRequireDefault(_button);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _gridicon=__webpack_require__(26);var _gridicon2=_interopRequireDefault(_gridicon);var _analytics=__webpack_require__(20);var _analytics2=_interopRequireDefault(_analytics);var _sitesList=__webpack_require__(53);var _sitesList2=_interopRequireDefault(_sitesList);var _plans=__webpack_require__(715);var _productsValues=__webpack_require__(62);var _trackComponentView=__webpack_require__(284);var _trackComponentView2=_interopRequireDefault(_trackComponentView);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var sites=(0,_sitesList2.default)();exports.default=_react2.default.createClass({displayName:"UpgradeNudge",propTypes:{onClick:_react2.default.PropTypes.func,className:_react2.default.PropTypes.string,message:_react2.default.PropTypes.string,icon:_react2.default.PropTypes.string,event:_react2.default.PropTypes.string,href:_react2.default.PropTypes.string,jetpack:_react2.default.PropTypes.bool,compact:_react2.default.PropTypes.bool,feature:_react2.default.PropTypes.oneOf([false].concat((0,_toConsumableArray3.default)((0,_plans.getValidFeatureKeys)()))),shouldDisplay:_react2.default.PropTypes.func},getDefaultProps:function getDefaultProps(){return{onClick:_noop2.default,message:"And get your own domain address.",icon:"star",event:null,jetpack:false,feature:false,compact:false,shouldDisplay:null}},handleClick:function handleClick(){if(this.props.event||this.props.feature){_analytics2.default.tracks.recordEvent("calypso_upgrade_nudge_cta_click",{cta_name:this.props.event,cta_feature:this.props.feature,cta_size:"regular"})}this.props.onClick()},shouldDisplay:function shouldDisplay(site){var _props=this.props;var feature=_props.feature;var jetpack=_props.jetpack;var shouldDisplay=_props.shouldDisplay;if(shouldDisplay){return shouldDisplay()}if(!site){return false}if(feature&&(0,_plans.hasFeature)(feature,site.ID)){return false}if(!feature&&!(0,_productsValues.isFreePlan)(site.plan)){return false}if(feature==="no-adverts"&&site.options.wordads){return false}if(!jetpack&&site.jetpack||jetpack&&!site.jetpack){return false}return true},render:function render(){var classes=(0,_classnames2.default)(this.props.className,"upgrade-nudge");var site=sites.getSelectedSite();var href=this.props.href;if(!this.shouldDisplay(site)){return null}if(!this.props.href&&site){if(this.props.feature){href="/plans/"+site.slug+"?feature="+this.props.feature}else{href="/plans/"+site.slug}}if(this.props.compact){return _react2.default.createElement(_button2.default,{className:classes,onClick:this.handleClick,href:href},_react2.default.createElement(_gridicon2.default,{className:"upgrade-nudge__icon",icon:this.props.icon}),_react2.default.createElement("div",{className:"upgrade-nudge__info"},_react2.default.createElement("span",{className:"upgrade-nudge__title"},this.props.title||this.translate("Upgrade to Premium")),_react2.default.createElement("span",{className:"upgrade-nudge__message"},this.props.message)))}return _react2.default.createElement(_card2.default,{compact:true,className:classes,onClick:this.handleClick,href:href},_react2.default.createElement(_gridicon2.default,{className:"upgrade-nudge__icon",icon:this.props.icon,size:18}),_react2.default.createElement("div",{className:"upgrade-nudge__info"},_react2.default.createElement("span",{className:"upgrade-nudge__title"},this.props.title||this.translate("Upgrade to Premium")),_react2.default.createElement("span",{className:"upgrade-nudge__message"},this.props.message)),(this.props.event||this.props.feature)&&_react2.default.createElement(_trackComponentView2.default,{eventName:"calypso_upgrade_nudge_impression",eventProperties:{cta_name:this.props.event,cta_feature:this.props.feature,cta_size:"regular"}}))}});module.exports=exports["default"]},1729:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=__webpack_require__(21);var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=__webpack_require__(8);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(9);var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=__webpack_require__(23);var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=__webpack_require__(22);var _inherits3=_interopRequireDefault(_inherits2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _spinner=__webpack_require__(282);var _spinner2=_interopRequireDefault(_spinner);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var StatsModulePlaceholder=function(_PureComponent){(0,_inherits3.default)(StatsModulePlaceholder,_PureComponent);function StatsModulePlaceholder(){(0,_classCallCheck3.default)(this,StatsModulePlaceholder);return(0,_possibleConstructorReturn3.default)(this,(StatsModulePlaceholder.__proto__||(0,_getPrototypeOf2.default)(StatsModulePlaceholder)).apply(this,arguments))}(0,_createClass3.default)(StatsModulePlaceholder,[{key:"render",value:function render(){var _props=this.props;var className=_props.className;var isLoading=_props.isLoading;if(!isLoading){return null}var classes=(0,_classnames2.default)("stats-module__placeholder","is-void",className);return _react2.default.createElement("div",{className:classes},_react2.default.createElement(_spinner2.default,null))}}]);return StatsModulePlaceholder}(_react.PureComponent);StatsModulePlaceholder.propTypes={className:_react.PropTypes.string,isLoading:_react.PropTypes.bool};exports.default=StatsModulePlaceholder;module.exports=exports["default"]},1730:function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default={DOMAINS_WITH_PLANS_ONLY:"calypso_domains_with_plans_only"};module.exports=exports["default"]},1792:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getDomainsSuggestions=getDomainsSuggestions;exports.isRequestingDomainsSuggestions=isRequestingDomainsSuggestions;exports.getDomainsSuggestionsError=getDomainsSuggestionsError;var _utils=__webpack_require__(775);function getDomainsSuggestions(state,queryObject){var serializedQuery=(0,_utils.getSerializedDomainsSuggestionsQuery)(queryObject);if(serializedQuery){return state.domains.suggestions.items[serializedQuery]}return null}function isRequestingDomainsSuggestions(state,queryObject){var serializedQuery=(0,_utils.getSerializedDomainsSuggestionsQuery)(queryObject);if(serializedQuery){return!!state.domains.suggestions.requesting[serializedQuery]}return false}function getDomainsSuggestionsError(state,queryObject){var serializedQuery=(0,_utils.getSerializedDomainsSuggestionsQuery)(queryObject);if(serializedQuery){return state.domains.suggestions.errors[serializedQuery]||null}return null}},1817:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),classNames=__webpack_require__(10),debug=__webpack_require__(3)("calypso:stats:list");var StatsListItem=__webpack_require__(2973);module.exports=React.createClass({displayName:"StatsList",getInitialState:function getInitialState(){return{activeGroups:[]}},isGroupActive:function isGroupActive(groupName){return this.state.activeGroups.indexOf(groupName)>=0},clickHandler:function clickHandler(event,data){debug("clickHandler");if("function"===typeof this.props.clickHandler){this.props.clickHandler(event,data)}},buildLists:function buildLists(groups,parentKey){var results,listClass=classNames("module-content-list",{"module-content-list-sublist":parentKey,"is-expanded":this.isGroupActive(parentKey)});results=groups.map(function(group,groupIndex){var childResults,active,groupTree=parentKey?[parentKey]:[],groupKey,clickHandler=this.props.clickHandler?this.props.clickHandler:false;groupTree.push(groupIndex);groupKey=groupTree.join(":");active=this.isGroupActive(groupKey);if(group.children){childResults=this.buildLists(group.children,groupKey)}return React.createElement(StatsListItem,{moduleName:this.props.moduleName,data:group,active:active,children:childResults,key:groupKey,itemClickHandler:clickHandler,followList:this.props.followList})},this);return React.createElement("ul",{className:listClass},results)},render:function render(){var list=this.buildLists(this.props.data);return list}})},1818:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _mixin=__webpack_require__(111);var _mixin2=_interopRequireDefault(_mixin);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsListLegend",mixins:[_mixin2.default],propTypes:{value:_react.PropTypes.string,label:_react.PropTypes.string},render:function render(){var _props=this.props;var value=_props.value;var label=_props.label;var valueSpan=void 0;if(value){valueSpan=_react2.default.createElement("span",{className:"module-content-list-item-right"},_react2.default.createElement("span",{className:"module-content-list-item-value"},value))}return _react2.default.createElement("ul",{className:"module-content-list module-content-list-legend"},_react2.default.createElement("li",{className:"module-content-list-item"},_react2.default.createElement("span",{className:"module-content-list-item-wrapper"},valueSpan,_react2.default.createElement("span",{className:"module-content-list-item-label"},label))))}});module.exports=exports["default"]},1849:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _mixin=__webpack_require__(111);var _mixin2=_interopRequireDefault(_mixin);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsError",mixins:[_mixin2.default],propTypes:{message:_react.PropTypes.string,className:_react.PropTypes.string},render:function render(){var message=this.props.message||this.translate("Some stats didn't load in time. Please try again later.");return _react2.default.createElement("div",{className:(0,_classnames2.default)("module-content-text","is-error",this.props.className)},_react2.default.createElement("p",null,message))}});module.exports=exports["default"]},1850:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _mixin=__webpack_require__(111);var _mixin2=_interopRequireDefault(_mixin);var _firstView=__webpack_require__(2047);var _firstView2=_interopRequireDefault(_firstView);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"stats-first-view",mixins:[_mixin2.default],render:function render(){return _react2.default.createElement(_firstView2.default,null,_react2.default.createElement("div",null,this.renderIcon(),_react2.default.createElement("h1",null,this.translate("See How Your Site Is Performing")),_react2.default.createElement("p",null,this.translate("The Stats page tells you everything you need to know about your site's traffic and visitors â€” which of your posts are taking off, where your audience is coming from, and who's now following you."))))},renderIcon:function renderIcon(){return _react2.default.createElement("div",{className:"first-view__icon"},_react2.default.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 792 612",enableBackground:"new 0 0 792 612"},_react2.default.createElement("g",null,_react2.default.createElement("circle",{fill:"#D2DCE4",cx:"395.8",cy:"305.5",r:"287.1"}),_react2.default.createElement("rect",{x:"219.8",y:"267.8",fill:"#8FACBF",width:"101",height:"219.4"}),_react2.default.createElement("rect",{x:"344.2",y:"153",fill:"#8FACBF",width:"101",height:"334.2"}),_react2.default.createElement("rect",{x:"394.7",y:"152.6",opacity:"8.000000e-02",fill:"#485566",width:"50.5",height:"334.6"}),_react2.default.createElement("rect",{x:"468.6",y:"210.6",fill:"#8FACBF",width:"101",height:"276.6"}),_react2.default.createElement("rect",{x:"271.1",y:"267.8",opacity:"8.000000e-02",fill:"#485566",width:"49.7",height:"219.4"}),_react2.default.createElement("rect",{x:"519.5",y:"210.2",opacity:"8.000000e-02",fill:"#485566",width:"50",height:"277"}),_react2.default.createElement("path",{opacity:"0.45",fill:"#647A88",d:"M406.2,402.6"}),_react2.default.createElement("g",null,_react2.default.createElement("path",{opacity:"0.4",fill:"#647A88",d:"M398.5,377.5l-27.5,19.6l-17.1-14.7c-0.8,1.1-1.6,2.3-2.3,3.5l-7.4-4.7v20.2l3.5,2.3 c1.4,15.9,14.6,28.3,30.8,28.3c17.1,0,31-13.9,31-31c0-5.1-1.2-9.8-3.4-14l39-59.2v-31l-49.4,74.8L398.5,377.5z"}),_react2.default.createElement("path",{opacity:"0.4",fill:"#647A88",d:"M548.2,317l-1.2-11.5c-1.4,1.5-2.6,3-3.7,4.7l-40.7-31.1c1.2-1.8,2.2-3.7,3.1-5.7 l-23.7-16.5h-13.5v34.1c2.8,0.8,5.7,1.3,8.7,1.3c4.1,0,8-0.8,11.6-2.3l49.7,38c0.8,16.3,14.1,29.3,30.6,29.5v-37L548.2,317z"}),_react2.default.createElement("path",{opacity:"0.4",fill:"#647A88",d:"M292.5,335.7l-56,2l-3.4-1.8c0.9,3,2.2,5.7,3.8,8.2l-17.1,17.1v24.1l30.1-30 c3.9,1.8,8.2,2.8,12.8,2.8c4.5,0,8.8-1,12.7-2.8l45.3,28.9v-20.2l-31.9-20.3C290.4,341.2,291.6,338.5,292.5,335.7z"})),_react2.default.createElement("path",{opacity:"0.17",fill:"#FFFFFF",d:"M569.2,335.7L474.8,264l-97.7,140.7l-121.2-81L139.4,434.6c47.3,93.7,144.3,158,256.4,158 c158.6,0,287.1-128.5,287.1-287.1c0-41.2-8.8-80.4-24.4-115.8L569.2,335.7z"}),_react2.default.createElement("path",{fill:"#647A88",d:"M652.4,176.7l-85.2,137.6l-96.3-73.6l-94.9,143.8L257.5,309L136.8,429.3c2.6,5.4,5.4,10.7,8.3,15.8 l114.8-114.4l121.2,77.2l94-142.6l96.7,73.9l89.1-144C658.3,189,655.5,182.8,652.4,176.7z"}),_react2.default.createElement("g",null,_react2.default.createElement("circle",{fill:"#FFFFFF",cx:"378.5",cy:"395.3",r:"25.2"})),_react2.default.createElement("g",null,_react2.default.createElement("circle",{fill:"#FFFFFF",cx:"262.7",cy:"323.7",r:"25.2"})),_react2.default.createElement("path",{fill:"#F0F3F4",d:"M262.7,298.6v50.3c13.9,0,25.2-11.3,25.2-25.2C287.9,309.8,276.6,298.6,262.7,298.6z"}),_react2.default.createElement("path",{fill:"#F0F3F4",d:"M378.5,370.1v50.3c13.9,0,25.2-11.3,25.2-25.2C403.7,381.4,392.4,370.1,378.5,370.1z"}),_react2.default.createElement("g",null,_react2.default.createElement("circle",{fill:"#FFFFFF",cx:"477.3",cy:"258.5",r:"25.2"})),_react2.default.createElement("path",{fill:"#F0F3F4",d:"M477.3,233.4v50.3c13.9,0,25.2-11.3,25.2-25.2C502.5,244.6,491.2,233.4,477.3,233.4z"}),_react2.default.createElement("g",null,_react2.default.createElement("circle",{fill:"#FFFFFF",cx:"569.5",cy:"323.7",r:"25.2"})),_react2.default.createElement("path",{fill:"#F0F3F4",d:"M569.2,298.6v50.3c13.9,0,25.2-11.3,25.2-25.2C594.4,309.8,583.1,298.6,569.2,298.6z"}))))}});module.exports=exports["default"]},1851:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _extends2=__webpack_require__(16);var _extends3=_interopRequireDefault(_extends2);var _defineProperty2=__webpack_require__(7);var _defineProperty3=_interopRequireDefault(_defineProperty2);var _find3=__webpack_require__(27);var _find4=_interopRequireDefault(_find3);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _tab=__webpack_require__(1852);var _tab2=_interopRequireDefault(_tab);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsTabs",propTypes:{activeKey:_react.PropTypes.string,activeIndex:_react.PropTypes.string,dataList:_react.PropTypes.object,selectedTab:_react.PropTypes.string,switchTab:_react.PropTypes.func,tabs:_react.PropTypes.array,borderless:_react.PropTypes.bool},render:function render(){var _props=this.props;var children=_props.children;var dataList=_props.dataList;var activeIndex=_props.activeIndex;var activeKey=_props.activeKey;var tabs=_props.tabs;var switchTab=_props.switchTab;var selectedTab=_props.selectedTab;var borderless=_props.borderless;var statsTabs=void 0;if(dataList){(function(){var data=(0,_find4.default)(dataList.response.data,(0,_defineProperty3.default)({},activeKey,activeIndex));statsTabs=tabs.map(function(tab){var hasData=data&&data[tab.attr]>=0&&data[tab.attr]!==null;var tabOptions={attr:tab.attr,gridicon:tab.gridicon,className:tab.className,label:tab.label,loading:!hasData,selected:selectedTab===tab.attr,tabClick:switchTab,value:hasData?data[tab.attr]:null};return _react2.default.createElement(_tab2.default,(0,_extends3.default)({key:tabOptions.attr},tabOptions))})})()}return _react2.default.createElement("ul",{className:(0,_classnames2.default)("stats-tabs",{"is-enabled":!!dataList},{"is-borderless":borderless})},statsTabs||children)}});module.exports=exports["default"]},1852:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _gridicon=__webpack_require__(26);var _gridicon2=_interopRequireDefault(_gridicon);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsTabsTab",propTypes:{className:_react.PropTypes.string,gridicon:_react.PropTypes.string,href:_react.PropTypes.string,label:_react.PropTypes.string,loading:_react.PropTypes.bool,selected:_react.PropTypes.bool,tabClick:_react.PropTypes.func,value:_react.PropTypes.oneOfType([_react.PropTypes.number,_react.PropTypes.string])},clickHandler:function clickHandler(event){if(this.props.tabClick){event.preventDefault();this.props.tabClick(this.props)}},ensureValue:function ensureValue(value){if(!this.props.loading&&(value||value===0)){return this.numberFormat(value)}return String.fromCharCode(8211)},render:function render(){var _props=this.props;var className=_props.className;var children=_props.children;var gridicon=_props.gridicon;var href=_props.href;var label=_props.label;var loading=_props.loading;var selected=_props.selected;var tabClick=_props.tabClick;var value=_props.value;var tabClass=(0,_classnames2.default)("stats-tab",className,{"is-selected":selected,"is-loading":loading,"is-low":!value});var tabIcon=gridicon?_react2.default.createElement(_gridicon2.default,{icon:gridicon,size:18}):null;var tabLabel=_react2.default.createElement("span",{className:"label"},label);var tabValue=_react2.default.createElement("span",{className:"value"},this.ensureValue(value));var hasClickAction=href||tabClick;return _react2.default.createElement("li",{className:tabClass,onClick:this.clickHandler},hasClickAction?_react2.default.createElement("a",{href:href},tabIcon,tabLabel,tabValue,children):_react2.default.createElement("span",{className:"no-link"},tabIcon,tabLabel,tabValue,children))}});module.exports=exports["default"]},1863:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getSiteStatsNormalizedData=exports.getSiteStatsTotalPostsForStreakQuery=exports.getSiteStatsMaxPostsByDay=exports.getSiteStatsPostStreakData=undefined;var _keys=__webpack_require__(39);var _keys2=_interopRequireDefault(_keys);var _reduce2=__webpack_require__(117);var _reduce3=_interopRequireDefault(_reduce2);var _get2=__webpack_require__(24);var _get3=_interopRequireDefault(_get2);var _forOwn2=__webpack_require__(287);var _forOwn3=_interopRequireDefault(_forOwn2);exports.isRequestingSiteStatsForQuery=isRequestingSiteStatsForQuery;exports.getSiteStatsForQuery=getSiteStatsForQuery;exports.getSiteStatsPostsCountByDay=getSiteStatsPostsCountByDay;var _i18nCalypso=__webpack_require__(11);var _i18nCalypso2=_interopRequireDefault(_i18nCalypso);var _createSelector=__webpack_require__(100);var _createSelector2=_interopRequireDefault(_createSelector);var _utils=__webpack_require__(833);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function isRequestingSiteStatsForQuery(state,siteId,statType,query){var serializedQuery=(0,_utils.getSerializedStatsQuery)(query);return!!(0,_get3.default)(state.stats.lists.requesting,[siteId,statType,serializedQuery])}function getSiteStatsForQuery(state,siteId,statType,query){var serializedQuery=(0,_utils.getSerializedStatsQuery)(query);return(0,_get3.default)(state.stats.lists.items,[siteId,statType,serializedQuery],null)}var getSiteStatsPostStreakData=exports.getSiteStatsPostStreakData=(0,_createSelector2.default)(function(state,siteId,query){var response={};var streakData=getSiteStatsForQuery(state,siteId,"statsStreak",query);if(streakData&&streakData.data){(0,_keys2.default)(streakData.data).forEach(function(timestamp){var postDay=_i18nCalypso2.default.moment.unix(timestamp).locale("en");var datestamp=postDay.format("YYYY-MM-DD");if("undefined"===typeof response[datestamp]){response[datestamp]=0}response[datestamp]+=streakData.data[timestamp]})}return response},function(state,siteId,query){return getSiteStatsForQuery(state,siteId,"statsStreak",query)},function(state,siteId,query){var serializedQuery=(0,_utils.getSerializedStatsQuery)(query);return[siteId,"statsStreak",serializedQuery].join()});var getSiteStatsMaxPostsByDay=exports.getSiteStatsMaxPostsByDay=(0,_createSelector2.default)(function(state,siteId,query){var max=0;(0,_forOwn3.default)(getSiteStatsPostStreakData(state,siteId,query),function(count){if(count>max){max=count}});return max||null},function(state,siteId,query){return getSiteStatsForQuery(state,siteId,"statsStreak",query)},function(state,siteId,query){var serializedQuery=(0,_utils.getSerializedStatsQuery)(query);return[siteId,"statsStreakMax",serializedQuery].join()});var getSiteStatsTotalPostsForStreakQuery=exports.getSiteStatsTotalPostsForStreakQuery=(0,_createSelector2.default)(function(state,siteId,query){return(0,_reduce3.default)(getSiteStatsPostStreakData(state,siteId,query),function(posts,sum){return sum+posts},0)},function(state,siteId,query){return getSiteStatsForQuery(state,siteId,"statsStreak",query)},function(state,siteId,query){var serializedQuery=(0,_utils.getSerializedStatsQuery)(query);return[siteId,"statsStreakMax",serializedQuery].join()});function getSiteStatsPostsCountByDay(state,siteId,query,date){var data=getSiteStatsPostStreakData(state,siteId,query);return data[date]||null}var getSiteStatsNormalizedData=exports.getSiteStatsNormalizedData=(0,_createSelector2.default)(function(state,siteId,statType,query){var data=getSiteStatsForQuery(state,siteId,statType,query);if("function"===typeof _utils.normalizers[statType]){return _utils.normalizers[statType].call(undefined,data)}return data},function(state,siteId,statType,query){return getSiteStatsForQuery(state,siteId,statType,query)},function(state,siteId,statType,query){var serializedQuery=(0,_utils.getSerializedStatsQuery)(query);return[siteId,statType,serializedQuery].join()})},1879:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=__webpack_require__(21);var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=__webpack_require__(8);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(9);var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=__webpack_require__(23);var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=__webpack_require__(22);var _inherits3=_interopRequireDefault(_inherits2);var _react=__webpack_require__(1);var _reactRedux=__webpack_require__(15);var _selectors=__webpack_require__(1792);var _actions=__webpack_require__(1921);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getQueryObject(props){var query=props.query;var vendor=props.vendor;var quantity=props.quantity;var includeSubdomain=props.includeSubdomain;return{query:query,vendor:vendor,quantity:quantity,include_wordpressdotcom:includeSubdomain}}var QueryDomainsSuggestions=function(_Component){(0,_inherits3.default)(QueryDomainsSuggestions,_Component);function QueryDomainsSuggestions(props){(0,_classCallCheck3.default)(this,QueryDomainsSuggestions);var _this=(0,_possibleConstructorReturn3.default)(this,(QueryDomainsSuggestions.__proto__||(0,_getPrototypeOf2.default)(QueryDomainsSuggestions)).call(this,props));_this.requestDomainsSuggestions=_this.requestDomainsSuggestions.bind(_this);return _this}(0,_createClass3.default)(QueryDomainsSuggestions,[{key:"requestDomainsSuggestions",value:function requestDomainsSuggestions(){var props=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.props;if(!props.requestingDomainsSuggestions){props.requestDomainsSuggestions(getQueryObject(props))}}},{key:"componentWillMount",value:function componentWillMount(){this.requestDomainsSuggestions()}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){if(nextProps.requestingDomainsSuggestions||this.props.query===nextProps.query&&this.props.vendor===nextProps.vendor&&this.props.quantity===nextProps.quantity&&this.props.includeSubdomain===nextProps.includeSubdomain){return}this.requestDomainsSuggestions(nextProps)}},{key:"render",value:function render(){return null}}]);return QueryDomainsSuggestions}(_react.Component);QueryDomainsSuggestions.propTypes={query:_react.PropTypes.string.isRequired,vendor:_react.PropTypes.string.isRequired,quantity:_react.PropTypes.number,includeSubdomain:_react.PropTypes.bool,requestingDomainsSuggestions:_react.PropTypes.bool,requestDomainsSuggestions:_react.PropTypes.func};QueryDomainsSuggestions.defaultProps={requestDomainsSuggestions:function requestDomainsSuggestions(){},includeSubdomain:false,quantity:5};exports.default=(0,_reactRedux.connect)(function(state,ownProps){return{requestingDomainsSuggestions:(0,_selectors.isRequestingDomainsSuggestions)(state,getQueryObject(ownProps))}},{requestDomainsSuggestions:_actions.requestDomainsSuggestions})(QueryDomainsSuggestions);module.exports=exports["default"]},1881:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=__webpack_require__(21);var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=__webpack_require__(8);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(9);var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=__webpack_require__(23);var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=__webpack_require__(22);var _inherits3=_interopRequireDefault(_inherits2);var _react=__webpack_require__(1);var _reactRedux=__webpack_require__(15);var _shallowEqual=__webpack_require__(291);var _shallowEqual2=_interopRequireDefault(_shallowEqual);var _actions=__webpack_require__(3307);var _selectors=__webpack_require__(1863);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var QuerySiteStats=function(_Component){(0,_inherits3.default)(QuerySiteStats,_Component);function QuerySiteStats(){(0,_classCallCheck3.default)(this,QuerySiteStats);return(0,_possibleConstructorReturn3.default)(this,(QuerySiteStats.__proto__||(0,_getPrototypeOf2.default)(QuerySiteStats)).apply(this,arguments))}(0,_createClass3.default)(QuerySiteStats,[{key:"componentWillMount",value:function componentWillMount(){this.request(this.props)}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){if(this.props.siteId===nextProps.siteId&&this.props.statType===nextProps.statType&&(0,_shallowEqual2.default)(this.props.query,nextProps.query)){return}this.request(nextProps)}},{key:"request",value:function request(props){if(props.requesting){return}props.requestSiteStats(props.siteId,props.statType,props.query)}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(){return false}},{key:"render",value:function render(){return null}}]);return QuerySiteStats}(_react.Component);QuerySiteStats.propTypes={siteId:_react.PropTypes.number.isRequired,statType:_react.PropTypes.string.isRequired,query:_react.PropTypes.object,
requesting:_react.PropTypes.bool.isRequired,requestSiteStats:_react.PropTypes.func.isRequired};QuerySiteStats.defaultProps={query:{}};exports.default=(0,_reactRedux.connect)(function(state,ownProps){return{requesting:(0,_selectors.isRequestingSiteStatsForQuery)(state,ownProps.siteId,ownProps.statType,ownProps.query)}},{requestSiteStats:_actions.requestSiteStats})(QuerySiteStats);module.exports=exports["default"]},1907:function(module,exports,__webpack_require__){"use strict";var Emitter=__webpack_require__(36),debug=__webpack_require__(3)("calypso:stats-list");var wpcom=__webpack_require__(28),statsParser=__webpack_require__(2662)(),analytics=__webpack_require__(20);var responseHandler,_buildExportArray,trackExtraStats=false,documentedEndpoints=["statsVideo","statsPublicize","statsStreak","statsFollowers","statsCommentFollowers","statsTopAuthors","statsTags","statsComments","statsPostViews","statsVideoPlays","stats","statsVisits","statsReferrers","statsTopPosts","statsClicks","statsCountryViews","statsSearchTerms"],undocumentedEndpoints=["statsEvents","statsInsights","statsPodcastDownloads"];responseHandler=function responseHandler(){return function(error,data){var parsedData=data,timeSpent,timeGroup;debug("new payload",data);if(error){if(this.performRetry){this.performRetry=false;if(trackExtraStats){analytics.mc.bumpStat("calypso_stats_retries",this.statType)}this.fetch()}else{debug("encountered an api error",error);this.error=error;this.loading=false;this.emit("change");analytics.mc.bumpStat("calypso_stats_errors",this.statType)}return}if(this.startedAt&&trackExtraStats){timeSpent=Date.now()-this.startedAt;if(timeSpent<1e3){timeGroup="0-1"}else if(timeSpent<2e3){timeGroup="1-2"}else if(timeSpent<3e3){timeGroup="2-3"}else if(timeSpent<6e3){timeGroup="3-6"}else if(timeSpent<9e3){timeGroup="6-9"}else{timeGroup="9plus"}analytics.mc.bumpStat("calypso_stats_"+this.statType.replace(/^stats/,""),timeGroup)}this.loading=false;if("function"===typeof statsParser[this.statType]){parsedData=statsParser[this.statType].call(this,data)}if(this.isEmpty()&&trackExtraStats){analytics.mc.bumpStat("calypso_stats_empty",this.statType.replace(/^stats/,""))}this.response=parsedData;debug("updated data",this);this.emit("change")}};_buildExportArray=function buildExportArray(data,parent){var exportData=[],label=parent?parent+" > "+data.label:data.label,escapedLabel;escapedLabel=label.replace(/\"/,'""');exportData.push(['"'+escapedLabel+'"',data.value]);if(data.children){var childData=data.children.map(function(child){return _buildExportArray(child,label)});childData=childData.concat.apply([],childData);exportData=exportData.concat(childData)}return exportData};function StatsList(options){if(!(this instanceof StatsList)){return new StatsList(options)}if("number"!==typeof options.siteID){throw new TypeError("options.siteID must be a number")}if(undocumentedEndpoints.indexOf(options.statType)===-1&&documentedEndpoints.indexOf(options.statType)===-1){throw new TypeError("options.statType must be one of the following: "+undocumentedEndpoints.concat(documentedEndpoints).join(", "))}["siteID","statType"].forEach(function(attr){this[attr]=options[attr];delete options[attr]},this);this.options=options;this.response={data:[]};this.error=null;this.loading=true;this.performRetry=true;this.startedAt=null;this.isDocumentedEndpoint=documentedEndpoints.indexOf(this.statType)>=0;this.fetch();return this}StatsList.prototype.fetch=function(){var wpcomSite,options=this.options,postIdEndpoints=["statsVideo","statsPostViews"];var siteIdOrDomain=this.siteID||options.domain;if(!siteIdOrDomain){return}if(this.isDocumentedEndpoint){wpcomSite=wpcom.site(siteIdOrDomain)}else{wpcomSite=wpcom.undocumented().site(siteIdOrDomain)}if(postIdEndpoints.indexOf(this.statType)>=0){options=this.options.post}this.startedAt=Date.now();wpcomSite[this.statType].call(wpcomSite,options,responseHandler(this.options).bind(this))};StatsList.prototype.isLoading=function(){return this.loading||0===this.siteID};StatsList.prototype.isError=function(){return!!this.error&&0!==this.siteID};StatsList.prototype.isEmpty=function(dataAttribute){if(this.response.data instanceof Array){return!this.isLoading()&&this.response.data.length===0}else if(dataAttribute&&this.response.data&&this.response.data[dataAttribute]){return!this.isLoading()&&this.response.data[dataAttribute].length===0}};StatsList.prototype.csvData=function(){var csvData=[],data=this.response.data.map(function(item){return _buildExportArray(item)});return csvData.concat.apply([],data)};Emitter(StatsList.prototype);module.exports=StatsList},1912:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _utils=__webpack_require__(169);var _utils2=_interopRequireDefault(_utils);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsDatePicker",propTypes:{period:_react.PropTypes.string.isRequired,date:_react.PropTypes.oneOfType([_react.PropTypes.object.isRequired,_react.PropTypes.string.isRequired]),summary:_react.PropTypes.bool},dateForDisplay:function dateForDisplay(){var locale=_utils2.default.getLocaleSlug();var date=this.moment(this.props.date).locale(locale);var formattedDate=void 0;switch(this.props.period){case"week":formattedDate=this.translate("%(startDate)s - %(endDate)s",{context:"Date range for which stats are being displayed",args:{startDate:date.startOf("week").add(1,"d").format("LL"),endDate:date.endOf("week").add(1,"d").format("LL")}});break;case"month":formattedDate=date.format("MMMM YYYY");break;case"year":formattedDate=date.format("YYYY");break;default:formattedDate=date.format("LL")}return formattedDate},render:function render(){var sectionTitle=this.translate("Stats for {{period/}}",{components:{period:_react2.default.createElement("span",{className:"period"},_react2.default.createElement("span",{className:"date"},this.dateForDisplay()))},context:"Stats: Main stats page heading",comment:'Example: "Stats for December 7", "Stats for December 8 - December 14", "Stats for December", "Stats for 2014"'});return _react2.default.createElement("div",null,this.props.summary?_react2.default.createElement("span",null,sectionTitle):_react2.default.createElement("h3",{className:"stats-section-title"},sectionTitle))}});module.exports=exports["default"]},1921:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.receiveDomainsSuggestions=receiveDomainsSuggestions;exports.requestDomainsSuggestions=requestDomainsSuggestions;var _wp=__webpack_require__(28);var _wp2=_interopRequireDefault(_wp);var _actionTypes=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function receiveDomainsSuggestions(suggestions,queryObject){return{type:_actionTypes.DOMAINS_SUGGESTIONS_RECEIVE,queryObject:queryObject,suggestions:suggestions}}function requestDomainsSuggestions(queryObject){return function(dispatch){dispatch({type:_actionTypes.DOMAINS_SUGGESTIONS_REQUEST,queryObject:queryObject});return _wp2.default.domains().suggestions(queryObject).then(function(suggestions){dispatch(receiveDomainsSuggestions(suggestions,queryObject));dispatch({type:_actionTypes.DOMAINS_SUGGESTIONS_REQUEST_SUCCESS,queryObject:queryObject})}).catch(function(error){dispatch({type:_actionTypes.DOMAINS_SUGGESTIONS_REQUEST_FAILURE,queryObject:queryObject,error:error})})}}},1926:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isRequestingPostStat=isRequestingPostStat;exports.getPostStat=getPostStat;var _get=__webpack_require__(24);var _get2=_interopRequireDefault(_get);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function isRequestingPostStat(state,stat,siteId,postId){return(0,_get2.default)(state.stats.posts.requesting,[siteId,postId,stat],false)}function getPostStat(state,stat,siteId,postId){return(0,_get2.default)(state.stats.posts.items,[siteId,postId,stat],null)}},1929:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _findLast2=__webpack_require__(1867);var _findLast3=_interopRequireDefault(_findLast2);var _find2=__webpack_require__(27);var _find3=_interopRequireDefault(_find2);var _takeRightWhile2=__webpack_require__(2211);var _takeRightWhile3=_interopRequireDefault(_takeRightWhile2);var _startsWith2=__webpack_require__(83);var _startsWith3=_interopRequireDefault(_startsWith2);var _some2=__webpack_require__(63);var _some3=_interopRequireDefault(_some2);exports.getConfigForCurrentView=getConfigForCurrentView;exports.isUserEligible=isUserEligible;exports.isQueryStringEnabled=isQueryStringEnabled;exports.isViewEnabled=isViewEnabled;exports.wasFirstViewHiddenSinceEnteringCurrentSection=wasFirstViewHiddenSinceEnteringCurrentSection;exports.shouldViewBeVisible=shouldViewBeVisible;exports.secondsSpentOnCurrentView=secondsSpentOnCurrentView;exports.bucketedTimeSpentOnCurrentView=bucketedTimeSpentOnCurrentView;var _moment=__webpack_require__(4);var _moment2=_interopRequireDefault(_moment);var _constants=__webpack_require__(2185);var _selectors=__webpack_require__(794);var _selectors2=__webpack_require__(138);var _selectors3=__webpack_require__(47);var _actionTypes=__webpack_require__(2);var _selectors4=__webpack_require__(90);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getConfigForCurrentView(state){var currentRoute=(0,_findLast3.default)((0,_selectors.getActionLog)(state),{type:_actionTypes.ROUTE_SET});var path=currentRoute.path?currentRoute.path:"";var config=(0,_find3.default)(_constants.FIRST_VIEW_CONFIG,function(entry){return(0,_some3.default)(entry.paths,function(entryPath){return(0,_startsWith3.default)(path,entryPath)})});return config||false}function isUserEligible(state,config){var userStartDate=(0,_selectors4.getCurrentUserDate)(state);if(!config.startDate){return true}if(!userStartDate){return false}return(0,_moment2.default)(userStartDate).isAfter(config.startDate)}function isQueryStringEnabled(state,config){var queryArguments=(0,_selectors3.getInitialQueryArguments)(state);return queryArguments.firstView===config.name}function isViewEnabled(state,config){if(!(0,_selectors2.preferencesLastFetchedTimestamp)(state)){return false}var latestFirstViewHistory=(0,_findLast3.default)((0,_selectors2.getPreference)(state,"firstViewHistory"),{view:config.name});var isViewDisabled=latestFirstViewHistory?!!latestFirstViewHistory.disabled:false;if(isViewDisabled){return false}return isQueryStringEnabled(state,config)||config.enabled&&isUserEligible(state,config)}function wasFirstViewHiddenSinceEnteringCurrentSection(state,config){var actionsSinceEnteringCurrentSection=(0,_takeRightWhile3.default)((0,_selectors.getActionLog)(state),function(action){return action.type!==_actionTypes.ROUTE_SET||action.type===_actionTypes.ROUTE_SET&&routeSetIsInCurrentSection(state,action)});return(0,_some3.default)(actionsSinceEnteringCurrentSection,function(action){return action.type===_actionTypes.FIRST_VIEW_HIDE&&action.view===config.name})}function routeSetIsInCurrentSection(state,routeSet){var section=state.ui.section;return(0,_some3.default)(section.paths,function(path){return(0,_startsWith3.default)(routeSet.path,path)})}function shouldViewBeVisible(state){var firstViewConfig=getConfigForCurrentView(state);if(!firstViewConfig){return false}return isViewEnabled(state,firstViewConfig)&&!wasFirstViewHiddenSinceEnteringCurrentSection(state,firstViewConfig)&&!(0,_selectors3.isSectionLoading)(state)}function secondsSpentOnCurrentView(state){var now=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Date.now();var currentRoute=(0,_findLast3.default)((0,_selectors.getActionLog)(state),{type:_actionTypes.ROUTE_SET});return currentRoute?(now-currentRoute.timestamp)/1e3:-1}function bucketedTimeSpentOnCurrentView(state){var now=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Date.now();var timeSpent=secondsSpentOnCurrentView(state,now);if(-1===timeSpent){return"unknown"}if(timeSpent<2){return"under2"}if(timeSpent<5){return"2-5"}if(timeSpent<10){return"5-10"}if(timeSpent<20){return"10-20"}if(timeSpent<60){return"20-60"}return"60plus"}},1944:function(module,exports,__webpack_require__){var baseSlice=__webpack_require__(140);function baseWhile(array,predicate,isDrop,fromRight){var length=array.length,index=fromRight?length:-1;while((fromRight?index--:++index<length)&&predicate(array[index],index,array)){}return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}module.exports=baseWhile},1973:function(module,exports,__webpack_require__){"use strict";var _find2=__webpack_require__(27);var _find3=_interopRequireDefault(_find2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var FollowListSite=__webpack_require__(2608);function FollowList(){if(!(this instanceof FollowList)){return new FollowList}this.data=[]}FollowList.prototype.add=function(object){var site=this.siteExists(object.site_id);if(!site){site=new FollowListSite(object);this.data.push(site)}return site};FollowList.prototype.siteExists=function(site_id){return(0,_find3.default)(this.data,{site_id:site_id})||false};module.exports=FollowList},2034:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=__webpack_require__(21);var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=__webpack_require__(8);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(9);var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=__webpack_require__(23);var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=__webpack_require__(22);var _inherits3=_interopRequireDefault(_inherits2);var _react=__webpack_require__(1);var _reactRedux=__webpack_require__(15);var _redux=__webpack_require__(6);var _selectors=__webpack_require__(1926);var _actions=__webpack_require__(2182);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var QueryPostStats=function(_Component){(0,_inherits3.default)(QueryPostStats,_Component);function QueryPostStats(){(0,_classCallCheck3.default)(this,QueryPostStats);return(0,_possibleConstructorReturn3.default)(this,(QueryPostStats.__proto__||(0,_getPrototypeOf2.default)(QueryPostStats)).apply(this,arguments))}(0,_createClass3.default)(QueryPostStats,[{key:"componentWillMount",value:function componentWillMount(){var _props=this.props;var requestingPostStat=_props.requestingPostStat;var siteId=_props.siteId;var postId=_props.postId;var stat=_props.stat;if(!requestingPostStat&&siteId&&postId&&stat){this.requestPostStat(this.props)}}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.clearInterval()}},{key:"componentWillReceiveProps",value:function componentWillReceiveProps(nextProps){var _props2=this.props;var siteId=_props2.siteId;var postId=_props2.postId;var stat=_props2.stat;var heartbeat=_props2.heartbeat;if(!(siteId&&postId&&stat)||siteId===nextProps.siteId&&postId===nextProps.postId&&stat===nextProps.stat&&heartbeat===nextProps.heartbeat){return}this.requestPostStat(nextProps)}},{key:"requestPostStat",value:function requestPostStat(props){var siteId=props.siteId;var postId=props.postId;var stat=props.stat;var heartbeat=props.heartbeat;props.requestPostStat(stat,siteId,postId);this.clearInterval();if(heartbeat){this.interval=setInterval(function(){props.requestPostStat(stat,siteId,postId)},heartbeat)}}},{key:"clearInterval",value:function(_clearInterval){function clearInterval(){return _clearInterval.apply(this,arguments)}clearInterval.toString=function(){return _clearInterval.toString()};return clearInterval}(function(){if(this.interval){clearInterval(this.interval)}})},{key:"render",value:function render(){return null}}]);return QueryPostStats}(_react.Component);QueryPostStats.propTypes={siteId:_react.PropTypes.number,postId:_react.PropTypes.number,stat:_react.PropTypes.string,requestingPostStat:_react.PropTypes.bool,requestPostStat:_react.PropTypes.func,heartbeat:_react.PropTypes.number};QueryPostStats.defaultProps={requestPostStat:function requestPostStat(){},heartbeat:0};exports.default=(0,_reactRedux.connect)(function(state,ownProps){return{requestingPostStat:(0,_selectors.isRequestingPostStat)(state,ownProps.stat,ownProps.siteId,ownProps.postId)}},function(dispatch){return(0,_redux.bindActionCreators)({requestPostStat:_actions.requestPostStat},dispatch)})(QueryPostStats);module.exports=exports["default"]},2044:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _mixin=__webpack_require__(111);var _mixin2=_interopRequireDefault(_mixin);var _twemoji=__webpack_require__(2023);var _twemoji2=_interopRequireDefault(_twemoji);var _config=__webpack_require__(12);var _config2=_interopRequireDefault(_config);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"Emojify",mixins:[_mixin2.default],propTypes:{children:_react.PropTypes.string.isRequired,size:_react.PropTypes.oneOf(["16x16","36x36","72x72"]),className:_react.PropTypes.string},componentDidMount:function componentDidMount(){this._parseEmoji()},componentDidUpdate:function componentDidUpdate(){this._parseEmoji()},getDefaultProps:function getDefaultProps(){return{size:"36x36",className:"emojify__emoji"}},_parseEmoji:function _parseEmoji(){var _props=this.props;var size=_props.size;var className=_props.className;_twemoji2.default.parse(this.refs.emojified,{base:(0,_config2.default)("twemoji_cdn_url"),size:size,className:className})},render:function render(){return _react2.default.createElement("span",{ref:"emojified"},this.props.children)}});module.exports=exports["default"]},2047:function(module,exports,__webpack_require__){(function(process){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _mixin=__webpack_require__(111);var _mixin2=_interopRequireDefault(_mixin);var _reactAddonsCssTransitionGroup=__webpack_require__(736);var _reactAddonsCssTransitionGroup2=_interopRequireDefault(_reactAddonsCssTransitionGroup);var _reactRedux=__webpack_require__(15);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _button=__webpack_require__(69);var _button2=_interopRequireDefault(_button);var _rootChild=__webpack_require__(177);var _rootChild2=_interopRequireDefault(_rootChild);var _selectors=__webpack_require__(47);var _selectors2=__webpack_require__(1929);var _actions=__webpack_require__(2184);var _config=__webpack_require__(12);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var TransitionGroupComponent=function TransitionGroupComponent(props){var children=_react2.default.Children.toArray(props.children);return children[0]||null};var FirstView=_react2.default.createClass({displayName:"FirstView",mixins:[_mixin2.default],getInitialState:function getInitialState(){return{isEnabled:false}},componentDidMount:function componentDidMount(){this.updateDocumentStyles()},componentDidUpdate:function componentDidUpdate(){this.updateDocumentStyles()},componentWillUnmount:function componentWillUnmount(){this.updateDocumentStylesForHiddenFirstView()},render:function render(){var classes=(0,_classnames2.default)("first-view",{"is-visible":this.props.isVisible});var firstViewContentClasses=(0,_classnames2.default)("first-view__content");var firstViewHidePreferenceClasses=(0,_classnames2.default)("first-view__hide-preference");return _react2.default.createElement(_rootChild2.default,{className:classes},_react2.default.createElement(_reactAddonsCssTransitionGroup2.default,{transitionName:"first-view-transition",component:TransitionGroupComponent,transitionEnter:false,transitionEnterTimeout:0,transitionLeaveTimeout:250},this.props.isVisible&&_react2.default.createElement(_card2.default,{key:"content",className:firstViewContentClasses},this.props.children,_react2.default.createElement(_button2.default,{primary:true,onClick:this.hide},this.translate("Got It!",{context:"Button that dismisses the introduction overlay."})),_react2.default.createElement("div",{className:firstViewHidePreferenceClasses},_react2.default.createElement("label",null,_react2.default.createElement("input",{type:"checkbox",checked:!this.state.isEnabled,onChange:this.enableOrDisableNextTime}),this.translate("Don't show this again"))))))},hide:function hide(){this.props.hideView({enabled:this.state.isEnabled})},enableOrDisableNextTime:function enableOrDisableNextTime(event){this.setState({isEnabled:!event.target.checked})},updateDocumentStyles:function updateDocumentStyles(){if(this.props.isVisible){this.updateDocumentStylesForVisibleFirstView()}else{this.updateDocumentStylesForHiddenFirstView()}},updateDocumentStylesForVisibleFirstView:function updateDocumentStylesForVisibleFirstView(){var _this=this;document.documentElement.classList.add("no-scroll");document.documentElement.classList.add("is-first-view-active");process.nextTick(function(){if(_this.props.isVisible){document.documentElement.classList.add("is-first-view-visible")}})},updateDocumentStylesForHiddenFirstView:function updateDocumentStylesForHiddenFirstView(){var _this2=this;document.documentElement.classList.remove("no-scroll");document.documentElement.classList.remove("is-first-view-visible");setTimeout(function(){if(!_this2.props.isVisible){document.documentElement.classList.remove("is-first-view-active")}},600)}});exports.default=(0,_reactRedux.connect)(function(state){return{sectionName:(0,_selectors.getSectionName)(state),isVisible:(0,_config.isEnabled)("ui/first-view")&&(0,_selectors2.shouldViewBeVisible)(state)}},{hideView:_actions.hideView})(FirstView);module.exports=exports["default"]}).call(exports,__webpack_require__(54))},2128:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsModuleContentText",propTypes:{className:_react.PropTypes.string},render:function render(){return _react2.default.createElement("div",{className:(0,_classnames2.default)("module-content-text",this.props.className)},this.props.children)}});module.exports=exports["default"]},2129:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _dataObserve=__webpack_require__(131);var _dataObserve2=_interopRequireDefault(_dataObserve);var _statsError=__webpack_require__(1849);var _statsError2=_interopRequireDefault(_statsError);var _statsList=__webpack_require__(1817);var _statsList2=_interopRequireDefault(_statsList);var _legend=__webpack_require__(1818);var _legend2=_interopRequireDefault(_legend);var _statsDownloadCsv=__webpack_require__(2325);var _statsDownloadCsv2=_interopRequireDefault(_statsDownloadCsv);var _statsDatePicker=__webpack_require__(1912);var _statsDatePicker2=_interopRequireDefault(_statsDatePicker);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _placeholder=__webpack_require__(1729);var _placeholder2=_interopRequireDefault(_placeholder);var _sectionHeader=__webpack_require__(1644);var _sectionHeader2=_interopRequireDefault(_sectionHeader);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatModule",mixins:[(0,_dataObserve2.default)("dataList")],data:function data(){return this.props.dataList.response.data},getDefaultProps:function getDefaultProps(){return{showPeriodDetail:false}},getInitialState:function getInitialState(){return{noData:this.props.dataList.isEmpty()}},componentWillReceiveProps:function componentWillReceiveProps(nextProps){this.setState({noData:nextProps.dataList.isEmpty()})},getModuleLabel:function getModuleLabel(){if(!this.props.summary){return this.props.moduleStrings.title}return _react2.default.createElement(_statsDatePicker2.default,{period:this.props.period.period,date:this.props.period.startOf,summary:true})},getHref:function getHref(){if(!this.props.summary&&this.props.period&&this.props.path&&this.props.site){return"/stats/"+this.props.period.period+"/"+this.props.path+"/"+this.props.site.slug+"?startDate="+this.props.date}return null},render:function render(){var data=this.data();var noData=this.props.dataList.isEmpty();var hasError=this.props.dataList.isError();var isLoading=this.props.dataList.isLoading();var _props=this.props;var className=_props.className;var summary=_props.summary;var site=_props.site;var path=_props.path;var dataList=_props.dataList;var period=_props.period;var moduleStrings=_props.moduleStrings;var followList=_props.followList;var viewSummary=void 0;var classes=(0,_classnames2.default)("stats-module",{"is-loading":isLoading,"has-no-data":noData,"is-showing-error":hasError||noData});if(!summary&&dataList.response.viewAll){viewSummary=_react2.default.createElement("div",{key:"view-all",className:"module-expand"},_react2.default.createElement("a",{href:this.getHref()},this.translate("View All",{context:"Stats: Button label to expand a panel"}),_react2.default.createElement("span",{className:"right"})))}var statsList=_react2.default.createElement(_statsList2.default,{moduleName:path,data:data,followList:followList});return _react2.default.createElement("div",null,_react2.default.createElement(_sectionHeader2.default,{label:this.getModuleLabel(),href:!summary?this.getHref():null},summary?_react2.default.createElement(_statsDownloadCsv2.default,{period:period,path:path,site:site,dataList:dataList}):null),_react2.default.createElement(_card2.default,{compact:true,className:classes},_react2.default.createElement("div",{className:className},_react2.default.createElement("div",{className:"module-content"},noData&&!hasError?_react2.default.createElement(_statsError2.default,{className:"is-empty-message",message:moduleStrings.empty}):null,hasError?_react2.default.createElement(_statsError2.default,{className:"network-error"}):null,_react2.default.createElement(_legend2.default,{value:moduleStrings.value,label:moduleStrings.item}),_react2.default.createElement(_placeholder2.default,{isLoading:isLoading}),statsList)),viewSummary))}});module.exports=exports["default"]},2130:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _selectDropdown=__webpack_require__(1761);var _selectDropdown2=_interopRequireDefault(_selectDropdown);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsModuleSelectDropdown",propTypes:{options:_react.PropTypes.array,onSelect:_react.PropTypes.func},getDefaultProps:function getDefaultProps(){return{onSelect:function onSelect(){}}},render:function render(){var _props=this.props;var onSelect=_props.onSelect;var options=_props.options;return _react2.default.createElement("div",{className:"stats-module__select-dropdown-wrapper"},_react2.default.createElement(_selectDropdown2.default,{options:options,onSelect:onSelect}))}});module.exports=exports["default"]},2131:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1);var SectionNav=__webpack_require__(1664),NavTabs=__webpack_require__(1661),NavItem=__webpack_require__(1660),siteStatsStickyTabActions=__webpack_require__(820);module.exports=React.createClass({displayName:"exports",propTypes:{section:React.PropTypes.string.isRequired,site:React.PropTypes.oneOfType([React.PropTypes.bool,React.PropTypes.object])},componentDidMount:function componentDidMount(){var slug=this.props.site?this.props.site.slug:"";siteStatsStickyTabActions.saveFilterAndSlug(this.props.section,slug)},componentDidUpdate:function componentDidUpdate(){var slug=this.props.site?this.props.site.slug:"";siteStatsStickyTabActions.saveFilterAndSlug(this.props.section,slug)},render:function render(){var activeSection=this.props.section,siteFragment=this.props.site?"/"+this.props.site.slug:"",sectionTitles={insights:this.translate("Insights"),day:this.translate("Days"),week:this.translate("Weeks"),month:this.translate("Months"),year:this.translate("Years")};return React.createElement(SectionNav,{selectedText:sectionTitles[activeSection]},React.createElement(NavTabs,{label:this.translate("Stats")},React.createElement(NavItem,{path:"/stats/insights"+siteFragment,selected:activeSection==="insights"},sectionTitles.insights),React.createElement(NavItem,{path:"/stats/day"+siteFragment,selected:activeSection==="day"},sectionTitles.day),React.createElement(NavItem,{path:"/stats/week"+siteFragment,selected:activeSection==="week"},sectionTitles.week),React.createElement(NavItem,{path:"/stats/month"+siteFragment,selected:activeSection==="month"},sectionTitles.month),React.createElement(NavItem,{path:"/stats/year"+siteFragment,selected:activeSection==="year"},sectionTitles.year)))}})},2132:function(module,exports,__webpack_require__){"use strict";var i18n=__webpack_require__(11);module.exports=function(){var statsStrings={};statsStrings.posts={title:i18n.translate("Posts & Pages",{context:"Stats: title of module"}),item:i18n.translate("Title",{context:"Stats: module row header for post title."}),value:i18n.translate("Views",{context:"Stats: module row header for number of post views."}),empty:i18n.translate("No posts or pages viewed",{context:"Stats: Info box label when the Posts & Pages module is empty"})};statsStrings.referrers={title:i18n.translate("Referrers",{context:"Stats: title of module"}),item:i18n.translate("Referrer",{context:"Stats: module row header for post referrer."}),value:i18n.translate("Views",{context:"Stats: module row header for number of post views by referrer."}),empty:i18n.translate("No referrers recorded",{context:"Stats: Info box label when the Referrers module is empty"})};statsStrings.clicks={title:i18n.translate("Clicks",{context:"Stats: title of module"}),item:i18n.translate("Link",{context:"Stats: module row header for links in posts."}),value:i18n.translate("Clicks",{context:"Stats: module row header for number of clicks on a given link in a post."}),empty:i18n.translate("No clicks recorded",{context:"Stats: Info box label when the Clicks module is empty"})};statsStrings.search={title:i18n.translate("Search Terms",{context:"Stats: title of module"}),item:i18n.translate("Search Term",{context:"Stats: module row header for search in search terms."}),value:i18n.translate("Views",{context:"Stats: module row header for views of a given search in search terms."}),empty:i18n.translate("No search terms recorded",{context:"Stats: Info box label when the Search Terms module is empty"})};statsStrings.authors={title:i18n.translate("Authors",{context:"Stats: title of module"
}),item:i18n.translate("Author",{context:"Stats: module row header for authors."}),value:i18n.translate("Views",{context:"Stats: module row header for number of views per author."}),empty:i18n.translate("No posts or pages viewed",{context:"Stats: Info box label when the Authors module is empty"})};statsStrings.videoplays={title:i18n.translate("Videos",{context:"Stats: title of module"}),item:i18n.translate("Video",{context:"Stats: module row header for videos."}),value:i18n.translate("Plays",{context:"Stats: module row header for number of plays per video."}),empty:i18n.translate("No videos played",{context:"Stats: Info box label when the Videos module is empty"})};statsStrings.podcastdownloads={title:i18n.translate("Podcasts",{context:"Stats: title of module"}),item:i18n.translate("Episodes",{context:"Stats: module row header for podcast."}),value:i18n.translate("Downloads",{context:"Stats: module row header for number of downloads per podcast episode."}),empty:i18n.translate("No episodes downloaded",{context:"Stats: Info box label when the Podcasts module is empty"})};statsStrings.tags={title:i18n.translate("Tags & Categories",{context:"Stats: title of module"}),item:i18n.translate("Topic",{context:"Stats: module row header for tags and categories."}),value:i18n.translate("Views",{context:"Stats: module row header for number of views per tag or category."}),empty:i18n.translate("No tagged posts or pages viewed",{context:"Stats: Info box label when the Tags module is empty"})};statsStrings.publicize={title:i18n.translate("Publicize",{context:"Stats: title of module"}),item:i18n.translate("Service",{context:"Stats: module row header for publicize service."}),value:i18n.translate("Followers",{context:"Stats: module row header for number of followers on the service."}),empty:i18n.translate("No publicize followers recorded",{context:"Stats: Info box label when the publicize module is empty"})};return statsStrings}},2182:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.receivePostStat=receivePostStat;exports.requestPostStat=requestPostStat;var _wp=__webpack_require__(28);var _wp2=_interopRequireDefault(_wp);var _actionTypes=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function receivePostStat(stat,siteId,postId,value){return{type:_actionTypes.POST_STATS_RECEIVE,stat:stat,siteId:siteId,postId:postId,value:value}}function requestPostStat(stat,siteId,postId){return function(dispatch){dispatch({type:_actionTypes.POST_STATS_REQUEST,stat:stat,postId:postId,siteId:siteId});return _wp2.default.site(siteId).statsPostViews(postId,{fields:stat}).then(function(data){if(stat in data){dispatch(receivePostStat(stat,siteId,postId,data[stat]))}dispatch({type:_actionTypes.POST_STATS_REQUEST_SUCCESS,stat:stat,siteId:siteId,postId:postId})}).catch(function(error){dispatch({type:_actionTypes.POST_STATS_REQUEST_FAILURE,stat:stat,siteId:siteId,postId:postId,error:error})})}}},2184:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _toConsumableArray2=__webpack_require__(41);var _toConsumableArray3=_interopRequireDefault(_toConsumableArray2);var _filter2=__webpack_require__(77);var _filter3=_interopRequireDefault(_filter2);exports.hideView=hideView;var _actionTypes=__webpack_require__(2);var _actions=__webpack_require__(133);var _actions2=__webpack_require__(226);var _selectors=__webpack_require__(138);var _selectors2=__webpack_require__(1929);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function hideView(_ref){var enabled=_ref.enabled;return function(dispatch,getState){var timeBucket=(0,_selectors2.bucketedTimeSpentOnCurrentView)(getState());var config=(0,_selectors2.getConfigForCurrentView)(getState());if(!config||!config.name){return false}var hideAction={type:_actionTypes.FIRST_VIEW_HIDE,view:config.name};var tracksEvent=(0,_actions.recordTracksEvent)("calypso_first_view_dismissed",{view:config.name,showAgain:enabled,timeSpent:timeBucket});dispatch((0,_actions.bumpStat)("calypso_first_view_dismissed",enabled?"show_again":"dont_show"));dispatch((0,_actions.bumpStat)("calypso_first_view_duration",timeBucket));dispatch(tracksEvent);dispatch(hideAction);dispatch(persistToPreferences({getState:getState,view:config.name,disabled:!enabled}))}}function persistToPreferences(_ref2){var getState=_ref2.getState;var view=_ref2.view;var disabled=_ref2.disabled;return(0,_actions2.savePreference)("firstViewHistory",[].concat((0,_toConsumableArray3.default)((0,_filter3.default)((0,_selectors.getPreference)(getState(),"firstViewHistory"),function(item){return item.view!==view})),[{view:view,timestamp:Date.now(),disabled:disabled}]))}},2185:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FIRST_VIEW_CONFIG=undefined;var _config=__webpack_require__(12);var FIRST_VIEW_CONFIG=exports.FIRST_VIEW_CONFIG=[{name:"stats",paths:["/stats"],enabled:true,startDate:"2016-07-26"},{name:"pages-prototype",paths:["/pages"],enabled:(0,_config.isEnabled)("pages/first-view-prototype")}]},2187:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var saveAs=saveAs||function(view){"use strict";if(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var doc=view.document,get_URL=function(){return view.URL||view.webkitURL||view},save_link=doc.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,click=function(node){var event=new MouseEvent("click");node.dispatchEvent(event)},webkit_req_fs=view.webkitRequestFileSystem,req_fs=view.requestFileSystem||webkit_req_fs||view.mozRequestFileSystem,throw_outside=function(ex){(view.setImmediate||view.setTimeout)(function(){throw ex},0)},force_saveable_type="application/octet-stream",fs_min_size=0,arbitrary_revoke_timeout=500,revoke=function(file){var revoker=function(){if(typeof file==="string"){get_URL().revokeObjectURL(file)}else{file.remove()}};if(view.chrome){revoker()}else{setTimeout(revoker,arbitrary_revoke_timeout)}},dispatch=function(filesaver,event_types,event){event_types=[].concat(event_types);var i=event_types.length;while(i--){var listener=filesaver["on"+event_types[i]];if(typeof listener==="function"){try{listener.call(filesaver,event||filesaver)}catch(ex){throw_outside(ex)}}}},auto_bom=function(blob){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)){return new Blob(["\ufeff",blob],{type:blob.type})}return blob},FileSaver=function(blob,name,no_auto_bom){if(!no_auto_bom){blob=auto_bom(blob)}var filesaver=this,type=blob.type,blob_changed=false,object_url,target_view,dispatch_all=function(){dispatch(filesaver,"writestart progress write writeend".split(" "))},fs_error=function(){if(blob_changed||!object_url){object_url=get_URL().createObjectURL(blob)}if(target_view){target_view.location.href=object_url}else{var new_tab=view.open(object_url,"_blank");if(new_tab==undefined&&typeof safari!=="undefined"){view.location.href=object_url}}filesaver.readyState=filesaver.DONE;dispatch_all();revoke(object_url)},abortable=function(func){return function(){if(filesaver.readyState!==filesaver.DONE){return func.apply(this,arguments)}}},create_if_not_found={create:true,exclusive:false},slice;filesaver.readyState=filesaver.INIT;if(!name){name="download"}if(can_use_save_link){object_url=get_URL().createObjectURL(blob);save_link.href=object_url;save_link.download=name;setTimeout(function(){click(save_link);dispatch_all();revoke(object_url);filesaver.readyState=filesaver.DONE});return}if(view.chrome&&type&&type!==force_saveable_type){slice=blob.slice||blob.webkitSlice;blob=slice.call(blob,0,blob.size,force_saveable_type);blob_changed=true}if(webkit_req_fs&&name!=="download"){name+=".download"}if(type===force_saveable_type||webkit_req_fs){target_view=view}if(!req_fs){fs_error();return}fs_min_size+=blob.size;req_fs(view.TEMPORARY,fs_min_size,abortable(function(fs){fs.root.getDirectory("saved",create_if_not_found,abortable(function(dir){var save=function(){dir.getFile(name,create_if_not_found,abortable(function(file){file.createWriter(abortable(function(writer){writer.onwriteend=function(event){target_view.location.href=file.toURL();filesaver.readyState=filesaver.DONE;dispatch(filesaver,"writeend",event);revoke(file)};writer.onerror=function(){var error=writer.error;if(error.code!==error.ABORT_ERR){fs_error()}};"writestart progress write abort".split(" ").forEach(function(event){writer["on"+event]=filesaver["on"+event]});writer.write(blob);filesaver.abort=function(){writer.abort();filesaver.readyState=filesaver.DONE};filesaver.readyState=filesaver.WRITING}),fs_error)}),fs_error)};dir.getFile(name,{create:false},abortable(function(file){file.remove();save()}),abortable(function(ex){if(ex.code===ex.NOT_FOUND_ERR){save()}else{fs_error()}}))}),fs_error)}),fs_error)},FS_proto=FileSaver.prototype,saveAs=function(blob,name,no_auto_bom){return new FileSaver(blob,name,no_auto_bom)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(blob,name,no_auto_bom){if(!no_auto_bom){blob=auto_bom(blob)}return navigator.msSaveOrOpenBlob(blob,name||"download")}}FS_proto.abort=function(){var filesaver=this;filesaver.readyState=filesaver.DONE;dispatch(filesaver,"abort")};FS_proto.readyState=FS_proto.INIT=0;FS_proto.WRITING=1;FS_proto.DONE=2;FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null;return saveAs}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content);if(typeof module!=="undefined"&&module.exports){module.exports.saveAs=saveAs}else if("function"!=="undefined"&&__webpack_require__(2217)!==null&&__webpack_require__(780)!=null){!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return saveAs}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}},2211:function(module,exports,__webpack_require__){var baseIteratee=__webpack_require__(35),baseWhile=__webpack_require__(1944);function takeRightWhile(array,predicate){return array&&array.length?baseWhile(array,baseIteratee(predicate,3),false,true):[]}module.exports=takeRightWhile},2217:function(module,exports){module.exports=function(){throw new Error("define cannot be used indirect")}},2220:function(module,exports,__webpack_require__){"use strict";var _throttle2=__webpack_require__(388);var _throttle3=_interopRequireDefault(_throttle2);var _noop2=__webpack_require__(38);var _noop3=_interopRequireDefault(_noop2);var _some2=__webpack_require__(63);var _some3=_interopRequireDefault(_some2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var React=__webpack_require__(1),debug=__webpack_require__(3)("calypso:chart");var BarContainer=__webpack_require__(2478),observe=__webpack_require__(131),touchDetect=__webpack_require__(216);module.exports=React.createClass({displayName:"ModuleChart",mixins:[observe("dataList")],propTypes:{loading:React.PropTypes.bool,data:React.PropTypes.array,minTouchBarWidth:React.PropTypes.number,minBarWidth:React.PropTypes.number,barClick:React.PropTypes.func},getInitialState:function getInitialState(){return{maxBars:100,width:650}},getDefaultProps:function getDefaultProps(){return{minTouchBarWidth:42,minBarWidth:15,barClick:_noop3.default}},componentDidMount:function componentDidMount(){this.resize=(0,_throttle3.default)(this.resize,400);window.addEventListener("resize",this.resize);this.resize()},componentWillUnmount:function componentWillUnmount(){window.removeEventListener("resize",this.resize)},componentWillReceiveProps:function componentWillReceiveProps(nextProps){if(this.props.loading&&!nextProps.loading){this.resize()}},resize:function resize(){if(this.isMounted()){var node=this.refs.chart,width=node.clientWidth-82,maxBars;if(touchDetect.hasTouch()){width=width<=0?350:width;maxBars=Math.floor(width/this.props.minTouchBarWidth)}else{maxBars=Math.floor(width/this.props.minBarWidth)}this.setState({maxBars:maxBars,width:width})}},getYAxisMax:function getYAxisMax(values){var max=Math.max.apply(null,values),operand=Math.pow(10,max.toString().length-1),rounded=Math.ceil((max+1)/operand)*operand;if(rounded<10){rounded=10}return rounded},getData:function getData(){var data=this.props.data;data=data.slice(0-this.state.maxBars);return data},getValues:function getValues(){var data=this.getData();data=data.map(function(item){return item.value},this);return data},isEmptyChart:function isEmptyChart(values){return!(0,_some3.default)(values,function(value){return value>0})},render:function render(){debug("Rendering chart with props: ",this.props);var values=this.getValues(),yAxisMax=this.getYAxisMax(values),data=this.getData(),emptyChart;if(values.length&&this.isEmptyChart(values)){emptyChart=React.createElement("div",{className:"chart__empty"},React.createElement("span",{className:"chart__empty_notice"},this.translate("No activity this period",{context:"Message on empty bar chart in Stats",comment:"Should be limited to 32 characters to prevent wrapping"})))}return React.createElement("div",{ref:"chart",className:"chart"},React.createElement("div",{className:"chart__y-axis-markers"},React.createElement("div",{className:"chart__y-axis-marker is-hundred"}),React.createElement("div",{className:"chart__y-axis-marker is-fifty"}),React.createElement("div",{className:"chart__y-axis-marker is-zero"})),React.createElement("div",{className:"chart__y-axis"},React.createElement("div",{className:"chart__y-axis-width-fix"},this.numberFormat(1e5)),React.createElement("div",{className:"chart__y-axis-label is-hundred"},this.numberFormat(yAxisMax)),React.createElement("div",{className:"chart__y-axis-label is-fifty"},this.numberFormat(yAxisMax/2)),React.createElement("div",{className:"chart__y-axis-label is-zero"},this.numberFormat(0))),React.createElement(BarContainer,{barClick:this.props.barClick,data:data,yAxisMax:yAxisMax,chartWidth:this.state.width,isTouch:touchDetect.hasTouch()}),emptyChart)}})},2323:function(module,exports,__webpack_require__){"use strict";var store=__webpack_require__(46),debug=__webpack_require__(3)("calypso:stats:mixin-toggle");var analytics=__webpack_require__(20),titlecase=__webpack_require__(724);module.exports=function(){var localValue=Array.prototype.slice.call(arguments).pop();return{getInitialState:function getInitialState(){if(this.props.site){var localKey="statsHide"+this.props.site.ID,hiddenSiteModules=store.get(localKey)||[],localStorageValue=this.props.path||localValue;return{showModule:(hiddenSiteModules.indexOf(localStorageValue)<0||this.props.summary)&&!this.props.defaultClosed}}else{return{showModule:!this.props.defaultClosed,showInfo:false}}},toggleInfo:function toggleInfo(event){event.stopPropagation();event.preventDefault();var gaEvent=this.state.showInfo?"Closed":"Opened";if(this.props.path){analytics.ga.recordEvent("Stats",gaEvent+" More Information Panel",titlecase(this.props.path))}this.setState({showInfo:!this.state.showInfo,showModule:this.state.showModule})},toggleModule:function toggleModule(event){event.preventDefault();var localKey="statsHide"+this.props.site.ID,localStorageValue=this.props.path||localValue,hiddenSiteModules=store.get(localKey)||[],showInfo=this.state.showInfo,gaEvent=this.state.showModule?"Collapsed":"Expanded",newState;newState={showModule:!this.state.showModule,showInfo:showInfo};analytics.ga.recordEvent("Stats",gaEvent+" Module",titlecase(this.props.path));if(this.props.summary){return true}else{if(this.state.showModule){hiddenSiteModules.push(localStorageValue)}else{hiddenSiteModules=hiddenSiteModules.filter(function(displayName){return localStorageValue!==displayName},this)}debug("hiddensitemodules",hiddenSiteModules);store.set(localKey,hiddenSiteModules);this.setState(newState)}}}}},2324:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _geochart=__webpack_require__(2950);var _geochart2=_interopRequireDefault(_geochart);var _statsList=__webpack_require__(1817);var _statsList2=_interopRequireDefault(_statsList);var _dataObserve=__webpack_require__(131);var _dataObserve2=_interopRequireDefault(_dataObserve);var _statsDownloadCsv=__webpack_require__(2325);var _statsDownloadCsv2=_interopRequireDefault(_statsDownloadCsv);var _statsDatePicker=__webpack_require__(1912);var _statsDatePicker2=_interopRequireDefault(_statsDatePicker);var _statsError=__webpack_require__(1849);var _statsError2=_interopRequireDefault(_statsError);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _placeholder=__webpack_require__(1729);var _placeholder2=_interopRequireDefault(_placeholder);var _legend=__webpack_require__(1818);var _legend2=_interopRequireDefault(_legend);var _gridicon=__webpack_require__(26);var _gridicon2=_interopRequireDefault(_gridicon);var _sectionHeader=__webpack_require__(1644);var _sectionHeader2=_interopRequireDefault(_sectionHeader);var _upgradeNudge=__webpack_require__(1680);var _upgradeNudge2=_interopRequireDefault(_upgradeNudge);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatCountries",mixins:[(0,_dataObserve2.default)("dataList")],propTypes:{summary:_react.PropTypes.bool,dataList:_react.PropTypes.object,path:_react.PropTypes.string,period:_react.PropTypes.object,site:_react.PropTypes.oneOfType([_react.PropTypes.object,_react.PropTypes.boolean]),date:_react.PropTypes.string},data:function data(nextProps){var props=nextProps||this.props;return props.dataList.response.data},getInitialState:function getInitialState(){return{noData:this.props.dataList.isEmpty()}},componentWillReceiveProps:function componentWillReceiveProps(nextProps){this.setState({noData:nextProps.dataList.isEmpty()})},getModuleLabel:function getModuleLabel(){if(!this.props.summary){return this.translate("Countries")}return _react2.default.createElement(_statsDatePicker2.default,{period:this.props.period.period,date:this.props.period.startOf,summary:true})},render:function render(){var mapData=[[this.translate("Country").toString(),this.translate("Views").toString()]];var data=this.data();var viewSummary=void 0;var _props=this.props;var dataList=_props.dataList;var period=_props.period;var site=_props.site;var date=_props.date;var summary=_props.summary;var path=_props.path;var hasError=dataList.isError();var noData=dataList.isEmpty();var isLoading=dataList.isLoading();var summaryPageLink="/stats/"+period.period+"/countryviews/"+site.slug+"?startDate="+date;var classes=(0,_classnames2.default)("stats-module","is-countries",{summary:summary,"is-loading":isLoading,"has-no-data":noData,"is-showing-error":hasError||noData});data.forEach(function(country){mapData.push([country.label,country.value])});if(!summary&&dataList.response.viewAll){viewSummary=_react2.default.createElement("div",{key:"view-all",className:"module-expand"},_react2.default.createElement("a",{href:summaryPageLink},this.translate("View All",{context:"Stats: Button label to expand a panel"}),_react2.default.createElement("span",{className:"right"})))}return _react2.default.createElement("div",null,_react2.default.createElement(_sectionHeader2.default,{label:this.getModuleLabel(),href:!summary?summaryPageLink:null},this.props.summary?_react2.default.createElement(_statsDownloadCsv2.default,{period:period,path:path,site:site,dataList:dataList}):null),_react2.default.createElement(_card2.default,{className:classes},_react2.default.createElement("div",{className:"countryviews"},_react2.default.createElement("div",{className:"module-content"},_react2.default.createElement("div",{className:"module-content-text module-content-text-info"},_react2.default.createElement("p",null,this.translate("Explore the list to see which countries and regions generate the most traffic to your site.")),_react2.default.createElement("ul",{className:"documentation"},_react2.default.createElement("li",null,_react2.default.createElement("a",{href:"http://en.support.wordpress.com/stats/#views-by-country",target:"_blank",rel:"noopener noreferrer"},_react2.default.createElement(_gridicon2.default,{icon:"info-outline"})," ",this.translate("About Countries"))))),noData&&!hasError?_react2.default.createElement(_statsError2.default,{className:"is-empty-message",message:this.translate("No countries recorded")}):null,_react2.default.createElement(_geochart2.default,{data:mapData,dataList:dataList}),_react2.default.createElement(_placeholder2.default,{className:"is-block",isLoading:isLoading}),_react2.default.createElement(_legend2.default,{value:this.translate("Views"),label:this.translate("Country")}),_react2.default.createElement(_placeholder2.default,{isLoading:isLoading}),_react2.default.createElement(_statsList2.default,{moduleName:path,data:data}),this.props.summary&&_react2.default.createElement(_upgradeNudge2.default,{title:this.translate("Add Google Analytics"),message:this.translate("Upgrade to a Business Plan for Google Analytics integration."),event:"googleAnalytics-stats-countries",feature:"google-analytics"}),hasError?_react2.default.createElement(_statsError2.default,{className:"network-error"}):null),viewSummary)))}});module.exports=exports["default"]},2325:function(module,exports,__webpack_require__){"use strict";var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _browserFilesaver=__webpack_require__(2187);var _toTitleCase=__webpack_require__(724);var _toTitleCase2=_interopRequireDefault(_toTitleCase);var _analytics=__webpack_require__(20);var _analytics2=_interopRequireDefault(_analytics);var _gridicon=__webpack_require__(26);var _gridicon2=_interopRequireDefault(_gridicon);var _button=__webpack_require__(69);var _button2=_interopRequireDefault(_button);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}module.exports=_react2.default.createClass({displayName:"StatsDownloadCsv",propTypes:{site:_react.PropTypes.object.isRequired,path:_react.PropTypes.string.isRequired,period:_react.PropTypes.object.isRequired,dataList:_react.PropTypes.object.isRequired},downloadCsv:function downloadCsv(event){event.preventDefault();var _props=this.props;var dataList=_props.dataList;var site=_props.site;var path=_props.path;var period=_props.period;var data=dataList.csvData();var fileName=[site.slug,path,period.period,period.startOf.format("L"),period.endOf.format("L")].join("_")+".csv";_analytics2.default.ga.recordEvent("Stats","CSV Download "+(0,_toTitleCase2.default)(path));var csvData=data.map(function(row){return row.join(",")}).join("\n");var blob=new Blob([csvData],{type:"text/csv;charset=utf-8"});(0,_browserFilesaver.saveAs)(blob,fileName)},render:function render(){try{var isFileSaverSupported=!!new Blob}catch(e){return null}return _react2.default.createElement(_button2.default,{compact:true,onClick:this.downloadCsv},_react2.default.createElement(_gridicon2.default,{icon:"cloud-download"})," ",this.translate("Download data as CSV",{context:"Action shown in stats to download data as csv."}))}})},2326:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _reactRedux=__webpack_require__(15);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _statsTabs=__webpack_require__(1851);var _statsTabs2=_interopRequireDefault(_statsTabs);var _tab=__webpack_require__(1852);var _tab2=_interopRequireDefault(_tab);var _sectionHeader=__webpack_require__(1644);var _sectionHeader2=_interopRequireDefault(_sectionHeader);var _querySiteStats=__webpack_require__(1881);var _querySiteStats2=_interopRequireDefault(_querySiteStats);var _selectors=__webpack_require__(1863);var _selectors2=__webpack_require__(79);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var StatsSiteOverview=_react2.default.createClass({displayName:"StatsSiteOverview",proptypes:{siteId:_react.PropTypes.number,siteSlug:_react.PropTypes.string,period:_react.PropTypes.string,date:_react.PropTypes.string,path:_react.PropTypes.string.isRequired,query:_react.PropTypes.object,summaryData:_react.PropTypes.object,insights:_react.PropTypes.bool,title:_react.PropTypes.string},isValueLow:function isValueLow(value){return!value||0===value},render:function render(){var _props=this.props;var siteId=_props.siteId;var siteSlug=_props.siteSlug;var path=_props.path;var summaryData=_props.summaryData;var query=_props.query;var title=_props.title;var views=summaryData.views;var visitors=summaryData.visitors;var likes=summaryData.likes;var comments=summaryData.comments;var siteStatsPath=[path,siteSlug].join("/");var headerPath=siteStatsPath;return _react2.default.createElement("div",null,siteId&&_react2.default.createElement(_querySiteStats2.default,{siteId:siteId,statType:"statsSummary",query:query}),_react2.default.createElement(_sectionHeader2.default,{label:title,href:headerPath}),_react2.default.createElement(_card2.default,{className:"stats__overview stats-module is-site-overview"},_react2.default.createElement(_statsTabs2.default,{borderless:true},_react2.default.createElement(_tab2.default,{className:this.isValueLow(views)?"is-low":null,href:siteStatsPath,gridicon:"visible",label:this.translate("Views",{context:"noun"}),value:views}),_react2.default.createElement(_tab2.default,{className:this.isValueLow(visitors)?"is-low":null,href:siteStatsPath+"?tab=visitors",gridicon:"user",label:this.translate("Visitors",{context:"noun"}),value:visitors}),_react2.default.createElement(_tab2.default,{className:this.isValueLow(likes)?"is-low":null,href:siteStatsPath+"?tab=likes",gridicon:"star",label:this.translate("Likes",{context:"noun"}),value:likes}),_react2.default.createElement(_tab2.default,{className:this.isValueLow(comments)?"is-low":null,href:siteStatsPath+"?tab=comments",gridicon:"comment",label:this.translate("Comments",{context:"noun"}),value:comments}))))}});exports.default=(0,_reactRedux.connect)(function(state,ownProps){var siteId=ownProps.siteId;var date=ownProps.date;var period=ownProps.period;var siteSlug=ownProps.siteSlug;var query={date:date,period:period};var slug=(0,_selectors2.getSiteSlug)(state,siteId)||siteSlug;return{summaryData:(0,_selectors.getSiteStatsForQuery)(state,siteId,"statsSummary",query)||{},siteSlug:slug,query:query}})(StatsSiteOverview);module.exports=exports["default"]},2327:function(module,exports,__webpack_require__){"use strict";var _extends2=__webpack_require__(16);var _extends3=_interopRequireDefault(_extends2);var _find2=__webpack_require__(27);var _find3=_interopRequireDefault(_find2);var _isEqual2=__webpack_require__(98);var _isEqual3=_interopRequireDefault(_isEqual2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var React=__webpack_require__(1),classNames=__webpack_require__(10);var observe=__webpack_require__(131),ElementChart=__webpack_require__(2220),StatsTabs=__webpack_require__(1851),StatsTab=__webpack_require__(1852),StatsModulePlaceholder=__webpack_require__(1729),analytics=__webpack_require__(20),Card=__webpack_require__(89);module.exports=React.createClass({displayName:"StatsSummaryChart",propTypes:{dataList:React.PropTypes.object.isRequired,labelKey:React.PropTypes.string.isRequired,dataKey:React.PropTypes.string.isRequired},mixins:[observe("dataList")],getInitialState:function getInitialState(){var chartDataLength=this.props.dataList.response.data?this.props.dataList.response.data.length:null;return{selectedBar:chartDataLength?this.props.dataList.response.data[chartDataLength-1]:null}},componentWillReceiveProps:function componentWillReceiveProps(nextProps){var selectedBar=this.state.selectedBar,chartDataLength=nextProps.dataList.response.data?nextProps.dataList.response.data.length:null;if(!selectedBar&&chartDataLength){selectedBar=nextProps.dataList.response.data[chartDataLength-1]}this.setState({selectedBar:selectedBar})},barClick:function barClick(bar){var selectedBar=(0,_find3.default)(this.props.dataList.response.data,function(data){return(0,_isEqual3.default)(data,bar.data)});analytics.ga.recordEvent("Stats","Clicked Summary Chart Bar");this.setState({selectedBar:selectedBar})},buildTooltipData:function buildTooltipData(item){var tooltipData=[],sectionClass;tooltipData.push({label:item.period,className:"is-date-label",value:null});switch(this.props.labelClass){case"visible":sectionClass="is-views";break;case"video":sectionClass="is-video";break;default:sectionClass=null}tooltipData.push({label:this.props.tabLabel,icon:this.props.labelClass,className:sectionClass,value:item.value});return tooltipData},buildChartData:function buildChartData(){var data;data=this.props.dataList.response.data.map(function(record){var chartDataItem,className;className=classNames({"is-selected":(0,_isEqual3.default)(this.state.selectedBar,record)});chartDataItem={label:record.period,value:record.value,nestedValue:null,className:className,data:record};chartDataItem.tooltipData=this.buildTooltipData(record);return chartDataItem},this);return data},chartTabs:function chartTabs(){var tabOptions,label,tabs,selectedBar=this.state.selectedBar;label=selectedBar?": "+selectedBar[this.props.labelKey]:"";tabOptions={attr:this.props.labelKey,value:selectedBar?this.state.selectedBar[this.props.dataKey]:null,selected:true,gridicon:this.props.labelClass,label:this.props.tabLabel+label};tabs=React.createElement(StatsTab,(0,_extends3.default)({key:"chart-tab"},tabOptions));return React.createElement(StatsTabs,null,tabs)},render:function render(){var classes,isLoading=this.props.dataList.isLoading();classes=["stats-module","is-summary-chart",{"is-loading":this.props.dataList.isLoading()}];return React.createElement(Card,{className:classNames.apply(null,classes)},React.createElement(StatsModulePlaceholder,{className:"is-chart",isLoading:isLoading}),React.createElement(ElementChart,{key:"chart",loading:isLoading,data:this.buildChartData(),barClick:this.barClick}),this.chartTabs())}})},2478:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1);var Bar=__webpack_require__(2479),XAxis=__webpack_require__(2482),user=__webpack_require__(48)();module.exports=React.createClass({displayName:"ModuleChartBarContainer",propTypes:{isTouch:React.PropTypes.bool,data:React.PropTypes.array,yAxisMax:React.PropTypes.number,width:React.PropTypes.number,barClick:React.PropTypes.func},buildBars:function buildBars(max){var bars,numberBars=this.props.data.length,tooltipPosition=user.isRTL()?"bottom left":"bottom right",width=this.props.chartWidth,barWidth=width/numberBars;bars=this.props.data.map(function(item,index){var barOffset=barWidth*(index+1);if(barOffset+230>width&&barOffset+barWidth-230>0){tooltipPosition=user.isRTL()?"bottom right":"bottom left"}return React.createElement(Bar,{index:index,key:index,isTouch:this.props.isTouch,tooltipPosition:tooltipPosition,className:item.className,clickHandler:this.props.barClick,data:item,max:max,count:numberBars})},this);return bars},render:function render(){return React.createElement("div",null,React.createElement("div",{className:"chart__bars"},this.buildBars(this.props.yAxisMax)),React.createElement(XAxis,{data:this.props.data,labelWidth:42}))}})},2479:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),classNames=__webpack_require__(10),debug=__webpack_require__(3)("calypso:module-chart:bar");var Tooltip=__webpack_require__(722),Gridicon=__webpack_require__(26);
module.exports=React.createClass({displayName:"ModuleChartBar",propTypes:{isTouch:React.PropTypes.bool,tooltipPosition:React.PropTypes.string,className:React.PropTypes.string,clickHandler:React.PropTypes.func,data:React.PropTypes.object.isRequired,max:React.PropTypes.number,count:React.PropTypes.number},getInitialState:function getInitialState(){return{showPopover:false}},buildSections:function buildSections(){var value=this.props.data.value,max=this.props.max,percentage=max?Math.ceil(value/max*1e4)/100:0,remain=100-percentage,remainFloor=Math.max(1,Math.floor(remain)),sections=[],remainStyle,valueStyle,nestedValue=this.props.data.nestedValue,nestedBar,nestedPercentage,nestedStyle,spacerClassOptions={"chart__bar-section":true,"is-spacer":true,"is-ghost":100===remain&&!this.props.active};remainStyle={height:remainFloor+"%"};sections.push(React.createElement("div",{key:"spacer",className:classNames(spacerClassOptions),style:remainStyle}));valueStyle={top:remainFloor+"%"};if(nestedValue){nestedPercentage=value?Math.ceil(nestedValue/value*1e4)/100:0;nestedStyle={height:nestedPercentage+"%"};nestedBar=React.createElement("div",{key:"nestedValue",className:"chart__bar-section-inner",style:nestedStyle})}sections.push(React.createElement("div",{ref:"valueBar",key:"value",className:"chart__bar-section is-bar",style:valueStyle},nestedBar));sections.push(React.createElement("div",{key:"label",className:"chart__bar-label"},this.props.label));return sections},clickHandler:function clickHandler(){if("function"===typeof this.props.clickHandler){this.props.clickHandler(this.props.data)}},mouseEnter:function mouseEnter(){this.setState({showPopover:true})},mouseLeave:function mouseLeave(){this.setState({showPopover:false})},renderTooltip:function renderTooltip(){if(!this.props.data.tooltipData||!this.props.data.tooltipData.length||this.props.isTouch){return null}var tooltipData=this.props.data.tooltipData;var listItemElements=tooltipData.map(function(options,i){var wrapperClasses=["module-content-list-item"],gridiconSpan;if(options.icon){gridiconSpan=React.createElement(Gridicon,{icon:options.icon,size:18})}wrapperClasses.push(options.className);return React.createElement("li",{key:i,className:wrapperClasses.join(" ")},React.createElement("span",{className:"wrapper"},React.createElement("span",{className:"value"},options.value),React.createElement("span",{className:"label"},gridiconSpan,options.label)))});return React.createElement(Tooltip,{className:"chart__tooltip",id:"popover__chart-bar",showDelay:200,context:this.refs&&this.refs.valueBar,isVisible:this.state.showPopover,position:this.props.tooltipPosition},React.createElement("ul",null,listItemElements))},render:function render(){debug("Rendering bar",this.state);var barStyle,barClass,count=this.props.count||1;barClass={chart__bar:true};if(this.props.className){barClass[this.props.className]=true}barStyle={width:1/count*100+"%"};return React.createElement("div",{onClick:this.clickHandler,onMouseEnter:this.mouseEnter,onMouseLeave:this.mouseLeave,className:classNames(barClass),style:barStyle},this.buildSections(),React.createElement("div",{className:"chart__bar-marker is-hundred"}),React.createElement("div",{className:"chart__bar-marker is-fifty"}),React.createElement("div",{className:"chart__bar-marker is-zero"}),this.renderTooltip())}})},2480:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),debug=__webpack_require__(3)("calypso:module-chart:label");var user=__webpack_require__(48)();module.exports=React.createClass({displayName:"ModuleChartLabel",propTypes:{width:React.PropTypes.number.isRequired,x:React.PropTypes.number.isRequired,label:React.PropTypes.string.isRequired},render:function render(){debug("Rendering label");var labelStyle,dir=user.isRTL()?"right":"left";labelStyle={width:this.props.width+"px"};labelStyle[dir]=this.props.x+"px";return React.createElement("div",{className:"chart__x-axis-label",style:labelStyle},this.props.label)}})},2481:function(module,exports,__webpack_require__){"use strict";var _find2=__webpack_require__(27);var _find3=_interopRequireDefault(_find2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var React=__webpack_require__(1),PureRenderMixin=__webpack_require__(111),debug=__webpack_require__(3)("calypso:module-chart:legend");var LegendItem=React.createClass({displayName:"ModuleChartLegendItem",mixins:[PureRenderMixin],propTypes:{checked:React.PropTypes.bool.isRequired,label:React.PropTypes.oneOfType([React.PropTypes.object,React.PropTypes.string]),attr:React.PropTypes.string.isRequired,changeHandler:React.PropTypes.func.isRequired},clickHandler:function clickHandler(){this.props.changeHandler(this.props.attr)},render:function render(){return React.createElement("li",{className:"chart__legend-option"},React.createElement("label",{htmlFor:"checkbox",className:"chart__legend-label is-selectable",onClick:this.clickHandler},React.createElement("input",{type:"checkbox",className:"chart__legend-checkbox",checked:this.props.checked,onChange:function onChange(){}}),React.createElement("span",{className:this.props.className}),this.props.label))}});var Legend=React.createClass({displayName:"ModuleChartLegend",propTypes:{activeTab:React.PropTypes.object.isRequired,tabs:React.PropTypes.array.isRequired,activeCharts:React.PropTypes.array.isRequired,availableCharts:React.PropTypes.array.isRequired,clickHandler:React.PropTypes.func.isRequired},onFilterChange:function onFilterChange(chartItem){this.props.clickHandler(chartItem)},render:function render(){debug("Rendering legend",this.props);var legendColors=["chart__legend-color is-dark-blue"],tab=this.props.activeTab,legendItems;legendItems=this.props.availableCharts.map(function(legendItem,index){var colorClass=legendColors[index],checked=-1!==this.props.activeCharts.indexOf(legendItem),tab;tab=(0,_find3.default)(this.props.tabs,{attr:legendItem});return React.createElement(LegendItem,{key:index,className:colorClass,label:tab.label,attr:tab.attr,changeHandler:this.onFilterChange,checked:checked})},this);return React.createElement("div",{className:"chart__legend"},React.createElement("ul",{className:"chart__legend-options"},React.createElement("li",{className:"chart__legend-option",key:"default-tab"},React.createElement("span",{className:"chart__legend-label"},React.createElement("span",{className:"chart__legend-color is-wordpress-blue"}),tab.label)),legendItems))}});module.exports=Legend},2482:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),debug=__webpack_require__(3)("calypso:module-chart:x-axis"),throttle=__webpack_require__(388);var Label=__webpack_require__(2480);module.exports=React.createClass({displayName:"ModuleChartXAxis",propTypes:{labelWidth:React.PropTypes.number.isRequired,data:React.PropTypes.array.isRequired},getInitialState:function getInitialState(){return{divisor:1,spacing:this.props.labelWidth}},componentDidMount:function componentDidMount(){this.resizeThrottled=throttle(this.resize,400);window.addEventListener("resize",this.resizeThrottled);this.resize()},componentWillUnmount:function componentWillUnmount(){if(this.resizeThrottled.cancel){this.resizeThrottled.cancel()}window.removeEventListener("resize",this.resizeThrottled)},componentWillReceiveProps:function componentWillReceiveProps(nextProps){this.resize(nextProps)},resize:function resize(nextProps){if(this.isMounted()){var node,props=this.props,width,dataCount,spacing,labelWidth,divisor;node=this.refs.axis;if(nextProps&&!(nextProps instanceof Event)){props=nextProps}node.style.overflow="hidden";width=node.clientWidth;node.style.overflow="visible";dataCount=props.data.length||1;spacing=width/dataCount;labelWidth=props.labelWidth;divisor=Math.ceil(labelWidth/spacing);this.setState({divisor:divisor,spacing:spacing})}},render:function render(){debug("Rendering chart x-axis",this.props.data);var labels,data=this.props.data;labels=data.map(function(item,index){var x=index*this.state.spacing+(this.state.spacing-this.props.labelWidth)/2,rightIndex=data.length-index-1,label;if(rightIndex%this.state.divisor===0){label=React.createElement(Label,{key:index,label:item.label,width:this.props.labelWidth,x:x})}return label},this);return React.createElement("div",{ref:"axis",className:"chart__x-axis"},labels)}})},2608:function(module,exports,__webpack_require__){"use strict";var debug=__webpack_require__(3)("calypso:follow-list:site");var wpcom=__webpack_require__(28),Emitter=__webpack_require__(36);function FollowListSite(args){if(!(this instanceof FollowListSite)){return new FollowListSite(args)}this.site_id=args.site_id;this.is_following=args.is_following;this.blog_domain=args.blog_domain}Emitter(FollowListSite.prototype);FollowListSite.prototype.follow=function(){if(!this.is_following){debug("following site",this.site_id);this.is_following=true;this.emit("change");wpcom.site(this.site_id).follow().add(function(resp){debug("follow success",resp)})}};FollowListSite.prototype.unfollow=function(){if(this.is_following){this.is_following=false;this.emit("change");wpcom.site(this.site_id).follow().del(function(resp){debug("unfollow success",resp)})}};module.exports=FollowListSite},2662:function(module,exports,__webpack_require__){"use strict";var i18n=__webpack_require__(11);var sites=__webpack_require__(53)();function StatsParser(){if(!(this instanceof StatsParser)){return new StatsParser}return this}function rangeOfPeriod(period,date){date=new i18n.moment(date).locale("en");var periodRange={period:period,startOf:date.clone().startOf(period),endOf:date.clone().endOf(period)};if("week"===period){if("0"===date.format("d")){periodRange.startOf.subtract(6,"d")}else{periodRange.startOf.add(1,"d");periodRange.endOf.add(1,"d")}}return periodRange}function parseAvatar(avatarUrl){var avatar,avatarParts;if(avatarUrl){avatarParts=avatarUrl.split("?");avatar=avatarParts[0]+"?d=mm"}return avatar}StatsParser.prototype.stats=function(payload){var response={posts:null,views:null,visitors:null,"best-views":{day:null,count:null}};if(payload.stats){response.posts=payload.stats.posts;response.views=payload.stats.views;response.visitors=payload.stats.visitors;response["best-views"].day=payload.stats.views_best_day;response["best-views"].count=payload.stats.views_best_day_total}return response};StatsParser.prototype.statsInsights=function(payload){var response={day:false,percent:0,hour:0},dayOfWeek;if(payload.highest_day_of_week||0===payload.highest_day_of_week){dayOfWeek=payload.highest_day_of_week+1;if(dayOfWeek>6){dayOfWeek=0}response.day=i18n.moment().day(dayOfWeek).format("dddd");response.percent=Math.round(payload.highest_day_percent);response.hour=i18n.moment().hour(payload.highest_hour).startOf("hour").format("LT");response.hour_percent=Math.round(payload.highest_hour_percent)}return response};StatsParser.prototype.statsStreak=function(payload){var response={days:{},best:{day:0,percent:0},max:0},timestamp,datestamp,postDay,total=0,days=[0,0,0,0,0,0,0],maxDay;for(timestamp in payload.data){postDay=i18n.moment.unix(timestamp);datestamp=postDay.format("YYYY-MM-DD");if("undefined"===typeof response.days[datestamp]){response.days[datestamp]=0}response.days[datestamp]+=payload.data[timestamp];days[postDay.day()]+=payload.data[timestamp];total+=payload.data[timestamp]}for(datestamp in response.days){if(response.days[datestamp]>response.max){response.max=response.days[datestamp]}}maxDay=Math.max.apply(null,days);response.best.day=days.indexOf(maxDay);if(total){response.best.percent=Math.round(100*(maxDay/total))}return response};StatsParser.prototype.statsSearchTerms=function(payload){var response={data:[]},periodRange=rangeOfPeriod(this.options.period,this.options.date),startDate=periodRange.startOf.format("YYYY-MM-DD");if(payload&&payload.date&&payload.days&&payload.days[startDate]){response.data=payload.days[startDate].search_terms.map(function(day){return{label:day.term,className:"user-selectable",value:day.views}});if(payload.days[startDate].encrypted_search_terms){response.data.push({label:i18n.translate("Unknown Search Terms"),value:payload.days[startDate].encrypted_search_terms,link:"http://en.support.wordpress.com/stats/#search-engine-terms",labelIcon:"external"})}if(payload.days[startDate].other_search_terms){response.viewAll=true}if(payload.days[startDate].total_search_terms){response.total=payload.days[startDate].total_views}}return response};StatsParser.prototype.statsVisits=function(payload){var response={},attributes=["visits","likes","visitors","comments","posts"];response.data=payload.data.map(function(record){var dataRecord={},date,dayOfWeek,localizedDate;record.forEach(function(value,i){if("period"===payload.fields[i]){value=value.replace(/W/g,"-")}dataRecord[payload.fields[i]]=value});attributes.forEach(function(attribute){if(0!==dataRecord[attribute]&&!dataRecord[attribute]){dataRecord[attribute]=null}});dataRecord.labelDay="";dataRecord.labelWeek="";dataRecord.labelMonth="";dataRecord.labelYear="";dataRecord.classNames=[];if(dataRecord.period){date=i18n.moment(dataRecord.period,"YYYY-MM-DD").locale("en");localizedDate=i18n.moment(dataRecord.period,"YYYY-MM-DD");if(date.isValid()){dayOfWeek=date.toDate().getDay();if("day"===payload.unit&&(6===dayOfWeek||0===dayOfWeek)){dataRecord.classNames.push("is-weekend")}dataRecord.labelDay=localizedDate.format("MMM D");dataRecord.labelWeek=localizedDate.format("MMM D");dataRecord.labelMonth=localizedDate.format("MMM");dataRecord.labelYear=localizedDate.format("YYYY")}}return dataRecord});return response};StatsParser.prototype.statsPublicize=function(payload){var response={data:[]},serviceInfo;serviceInfo={twitter:{label:"Twitter",icon:"https://secure.gravatar.com/blavatar/7905d1c4e12c54933a44d19fcd5f9356?s=48"},facebook:{label:"Facebook",icon:"https://secure.gravatar.com/blavatar/2343ec78a04c6ea9d80806345d31fd78?s=48"},tumblr:{label:"Tumblr",icon:"https://secure.gravatar.com/blavatar/84314f01e87cb656ba5f382d22d85134?s=48"},google_plus:{label:"Google+",icon:"https://secure.gravatar.com/blavatar/4a4788c1dfc396b1f86355b274cc26b3?s=48"},linkedin:{label:"LinkedIn",icon:"https://secure.gravatar.com/blavatar/f54db463750940e0e7f7630fe327845e?s=48"},path:{label:"Path",icon:"https://secure.gravatar.com/blavatar/3a03c8ce5bf1271fb3760bb6e79b02c1?s=48"}};if(payload&&payload.services){response.data=payload.services.map(function(service){var info=serviceInfo[service.service];return{label:info.label,value:service.followers,icon:info.icon}})}return response};StatsParser.prototype.statsEvents=function(payload){var response={data:[],resultCount:0};if(payload&&payload.posts){response.data=payload.posts.map(function(post){var detailPage="/stats/post/"+post.ID+"/"+this.options.domain;return{label:post.title,page:detailPage}},this);response.resultCount=payload.found}return response};StatsParser.prototype.statsReferrers=function(payload){var response={data:[]},periodRange=rangeOfPeriod(this.options.period,this.options.date),startDate=periodRange.startOf.format("YYYY-MM-DD");if(payload&&payload.date&&payload.days&&payload.days[startDate]&&payload.days[startDate].groups){response.data=payload.days[startDate].groups.map(function(item){var record,actions=[],hasChildren=item.results&&item.results.length>0;if(item.url&&-1!==item.url.indexOf(item.name)||!item.url&&item.name===item.group&&-1!==item.name.indexOf(".")){actions.push({type:"spam",data:{siteID:this.siteID,domain:item.name}})}record={label:item.name,value:item.total,link:item.url,labelIcon:hasChildren?null:"external",icon:item.icon,actions:actions,actionMenu:actions.length,children:null};if(hasChildren){record.children=item.results.map(function(child){var childData=child.children,children,childRecord;if(childData){children=childData.map(function(item){return{label:item.name,value:item.views,link:item.url,labelIcon:"external"}})}childRecord={label:child.name,value:child.views,link:child.url,labelIcon:childData?null:"external",children:children};if(child.icon){childRecord.icon=child.icon}return childRecord})}return record},this);if(payload.days[startDate].other_views){response.viewAll=true}if(payload.days[startDate].total_views){response.total=payload.days[startDate].total_views}}return response};StatsParser.prototype.statsTopAuthors=function(payload){var response={data:[]},periodRange=rangeOfPeriod(this.options.period,this.options.date),startDate=periodRange.startOf.format("YYYY-MM-DD");if(payload.days&&payload.date&&payload.days[startDate]){response.data=payload.days[startDate].authors.map(function(item){var record={label:item.name,iconClassName:"avatar-user",icon:parseAvatar(item.avatar),children:null,value:item.views,className:"module-content-list-item-large",actions:[{type:"follow",data:item.follow_data?item.follow_data.params:false}]};if(item.posts&&item.posts.length>0){record.children=item.posts.map(function(child){return{label:child.title,value:child.views,page:this.options?"/stats/post/"+child.id+"/"+this.options.domain:null,actions:[{type:"link",data:child.url}],children:null}},this)}return record},this);if(payload.days[startDate].other_views){response.viewAll=true}}return response};StatsParser.prototype.statsVideo=function(payload){var data={data:[],pages:[],post:null};if(payload&&payload.data){var views=payload.data.map(function(item){var date=i18n.moment(item[0]);return{period:date.format("MMM D"),value:item[1]}});data.data=views.slice(Math.max(views.length-10,1));data.post=payload.post}if(payload&&payload.pages){data.pages=payload.pages.map(function(item){return{label:item,link:item}})}return data};StatsParser.prototype.statsFollowers=function(payload){var data={page:0,pages:0,total:0,total_wpcom:0,total_email:0,subscribers:[],viewAll:false};data.page=payload.page||0;data.pages=payload.pages||0;data.total=payload.total||0;data.total_wpcom=payload.total_wpcom||0;data.total_email=payload.total_email||0;data.viewAll=data.pages>1?true:false;if(payload.subscribers){data.subscribers=payload.subscribers.map(function(item){return{label:item.label,iconClassName:"avatar-user",icon:parseAvatar(item.avatar),link:item.url,value:{type:"relative-date",value:item.date_subscribed},actions:[{type:"follow",data:item.follow_data?item.follow_data.params:false}]}})}return{data:data}};StatsParser.prototype.statsCommentFollowers=function(payload){var data={page:0,pages:0,total:0,posts:[],viewAll:false};data.page=payload.page||0;data.pages=payload.pages||0;data.total=payload.total||0;data.viewAll=data.pages>1?true:false;if(payload.posts){data.posts=payload.posts.map(function(item){if(0===item.id){return{label:"All Posts",value:item.followers}}return{label:item.title,link:item.url,labelIcon:"external",value:item.followers}})}return{data:data}};StatsParser.prototype.statsPostViews=function(payload){var views,defaultPostTitle=i18n.translate("Post %(number)d",{args:{number:this.options.post},context:"Stats: Title shown on Post Stats page"}),data={post:{},views:[],years:{},averages:{},weeks:[],highest_month:0,highest_day_average:0,highest_week_average:0};if(!this.options.post){defaultPostTitle="Home page / Archives"}if(payload){if(payload.data){views=payload.data.map(function(item){var date=i18n.moment(item[0]);return{period:date.format("MMM D"),value:item[1]}});data.data=views.slice(Math.max(views.length-10,1))}data.years=payload.years||{};data.averages=payload.averages||{};data.weeks=payload.weeks||[];data.highest_month=payload.highest_month||0;data.highest_day_average=payload.highest_day_average||0;data.highest_week_average=payload.highest_week_average||0;data.post=payload.post||{post_title:defaultPostTitle}}return data};StatsParser.prototype.statsVideoPlays=function(payload){var response={data:[]},periodRange=rangeOfPeriod(this.options.period,this.options.date),startDate=periodRange.startOf.format("YYYY-MM-DD");if(payload&&payload.date&&payload.days&&payload.days[startDate]){response.data=payload.days[startDate].plays.map(function(item){var detailPage="/stats/"+this.options.period+"/videodetails/"+this.options.domain+"?post="+item.post_id;return{label:item.title,page:detailPage,value:item.plays,actions:[{type:"link",data:item.url}]}},this);if(payload.days[startDate].other_plays){response.summaryPage=this.options?"/stats/"+this.options.period+"/videoplays/"+this.options.domain+"?startDate="+startDate:null}if(payload.days[startDate].total_plays){response.total=payload.days[startDate].total_plays}}return response};StatsParser.prototype.statsPodcastDownloads=function(payload){var response={data:[]},periodRange=rangeOfPeriod(this.options.period,this.options.date),startDate=periodRange.startOf.format("YYYY-MM-DD");if(payload&&payload.date&&payload.days&&payload.days[startDate]){response.data=payload.days[startDate].downloads.map(function(item){var detailPage="/stats/"+this.options.period+"/podcastdownloads/"+this.options.domain+"?post="+item.post_id;return{label:item.title,page:detailPage,value:item.downloads,actions:[{type:"link",data:item.url}]}},this);if(payload.days[startDate].other_downloads){response.summaryPage=this.options?"/stats/"+this.options.period+"/podcastdownloads/"+this.options.domain+"?startDate="+startDate:null}if(payload.days[startDate].total_downloads){response.total=payload.days[startDate].total_downloads}}return response};StatsParser.prototype.statsComments=function(payload){var response={data:{authors:[],posts:[]}},site=sites.getSite(this.options.domain),adminUrl=site?site.options.admin_url:"http://"+this.options.domain+"/wp-admin/";if(payload.authors){response.data.authors=payload.authors.map(function(author){return{label:author.name,value:author.comments,iconClassName:"avatar-user",icon:parseAvatar(author.gravatar),link:adminUrl+"edit-comments.php"+author.link,className:"module-content-list-item-large",actions:[{type:"follow",data:author.follow_data?author.follow_data.params:false}]}},this)}if(payload.posts){response.data.posts=payload.posts.map(function(post){return{label:post.name,value:post.comments,page:this.options?"/stats/post/"+post.id+"/"+this.options.domain:null,actions:[{type:"link",data:post.link}]}},this)}return response};StatsParser.prototype.statsTopPosts=function(payload){var response={data:[]},periodRange=rangeOfPeriod(this.options.period,this.options.date),startDate=periodRange.startOf.format("YYYY-MM-DD");if(payload&&payload.date&&payload.days&&payload.days[startDate]&&payload.days[startDate].postviews){response.data=payload.days[startDate].postviews.map(function(item){var detailPage="/stats/post/"+item.id+"/"+this.options.domain,postDate,inPeriod=false;if(item.date){postDate=i18n.moment(item.date);if((postDate.isAfter(periodRange.startOf)||postDate.isSame(periodRange.startOf))&&(postDate.isBefore(periodRange.endOf)||postDate.isSame(periodRange.endOf))){inPeriod=true}}return{label:item.title,value:item.views,page:detailPage,actions:[{type:"link",data:item.href}],labelIcon:null,children:null,className:inPeriod?"published":null}},this);if(payload.days[startDate].other_views){response.viewAll=true}if(payload.days[startDate].total_views){response.total=payload.days[startDate].total_views}}return response};StatsParser.prototype.statsTags=function(payload){var response={data:[]};if(payload&&payload.tags){response.data=payload.tags.map(function(item){var children,hasChildren=item.tags.length>1,labels;labels=item.tags.map(function(tagItem){var iconType;switch(tagItem.type){case"tag":iconType="tag";break;case"category":iconType="folder";break;default:iconType=tagItem.type}return{label:tagItem.name,labelIcon:iconType,link:hasChildren?null:tagItem.link}});if(hasChildren){children=item.tags.map(function(tagItem){var iconType;switch(tagItem.type){case"tag":iconType="tag";break;case"category":iconType="folder";break;default:iconType=tagItem.type}return{label:tagItem.name,labelIcon:iconType,value:null,children:null,link:tagItem.link}})}return{label:labels,link:labels.length>1?null:labels[0].link,value:item.views,children:children}})}return response};StatsParser.prototype.statsClicks=function(payload){var response={},data=[],periodRange=rangeOfPeriod(this.options.period,this.options.date),startDate=periodRange.startOf.format("YYYY-MM-DD");if(payload.date&&payload.days&&payload.days[startDate]){payload.days[startDate].clicks.forEach(function(item){var newRecord,hasChildren=item.children&&item.children.length>0;newRecord={label:item.name,value:item.views,children:null,link:item.url,icon:item.icon,labelIcon:hasChildren?null:"external"};if(item.children){newRecord.children=[];item.children.forEach(function(child){var childRecord={label:child.name,value:child.views,children:null,link:child.url,labelIcon:"external"};newRecord.children.push(childRecord)},this)}data.push(newRecord)},this);if(payload.days[startDate].other_clicks){response.viewAll=true}if(payload.days[startDate].total_clicks){response.total=payload.days[startDate].total_clicks}}response.data=data;return response};StatsParser.prototype.statsCountryViews=function(payload){var response={},data=[],periodRange=rangeOfPeriod(this.options.period,this.options.date),startDate=periodRange.startOf.format("YYYY-MM-DD");if(payload&&payload.days&&payload.days[startDate]&&payload.days[startDate].views){data=payload.days[startDate].views.filter(function(viewsObject){var country=payload["country-info"][viewsObject.country_code];return country}).map(function(viewsObject){var country=payload["country-info"][viewsObject.country_code],icon=country.flat_flag_icon.match(/grey\.png/)?null:country.flat_flag_icon;return{label:country.country_full.replace(/â€™/,"'"),value:viewsObject.views,region:country.map_region,icon:icon}});if(payload.days[startDate].other_views&&payload.days[startDate].other_views>0){response.viewAll=true}if(payload.days[startDate].total_views){response.total=payload.days[startDate].total_views}}response.data=data;return response};module.exports=StatsParser},2770:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _reactRedux=__webpack_require__(15);var _noop=__webpack_require__(38);var _noop2=_interopRequireDefault(_noop);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _selectors=__webpack_require__(79);var _selectors2=__webpack_require__(1792);var _selectors3=__webpack_require__(90);var _queryDomainsSuggestions=__webpack_require__(1879);var _queryDomainsSuggestions2=_interopRequireDefault(_queryDomainsSuggestions);var _constants=__webpack_require__(1730);var _upgradeNudge=__webpack_require__(1680);var _upgradeNudge2=_interopRequireDefault(_upgradeNudge);var _constants2=__webpack_require__(135);var _productsValues=__webpack_require__(62);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function getQueryObject(site,siteSlug){if(!site||!siteSlug){return null}return{query:siteSlug.split(".")[0],quantity:1,vendor:"domainsbot"}}var DomainTip=_react2.default.createClass({displayName:"DomainTip",propTypes:{className:_react2.default.PropTypes.string,event:_react2.default.PropTypes.string.isRequired,siteId:_react2.default.PropTypes.number.isRequired,domainsWithPlansOnly:_react2.default.PropTypes.bool.isRequired},getDefaultProps:function getDefaultProps(){return{quantity:_noop2.default}},noticeShouldDisplay:function noticeShouldDisplay(){return true},domainUpgradeNudge:function domainUpgradeNudge(){return _react2.default.createElement(_upgradeNudge2.default,{title:this.translate("Get a free Custom Domain"),message:this.translate("Custom domains are free when you upgrade to a Premium or Business plan."),feature:_constants2.FEATURE_CUSTOM_DOMAIN,event:this.props.event})},render:function render(){if(!this.props.site||this.props.site.jetpack||!this.props.siteSlug||this.props.domainsWithPlansOnly||!(0,_productsValues.isFreePlan)(this.props.site.plan)){return this.domainUpgradeNudge()}var classes=(0,_classnames2.default)(this.props.className,"domain-tip");var _getQueryObject=getQueryObject(this.props.site,this.props.siteSlug);var query=_getQueryObject.query;var quantity=_getQueryObject.quantity;var vendor=_getQueryObject.vendor;var suggestion=this.props.suggestions?this.props.suggestions[0]:null;return _react2.default.createElement("div",{className:classes},_react2.default.createElement(_queryDomainsSuggestions2.default,{query:query,quantity:quantity,vendor:vendor}),suggestion?_react2.default.createElement(_upgradeNudge2.default,{event:"domain_tip_"+this.props.event,shouldDisplay:this.noticeShouldDisplay,feature:_constants2.FEATURE_CUSTOM_DOMAIN,title:this.translate("{{span}}%(domain)s{{/span}} is available!",{args:{domain:suggestion.domain_name},components:{span:_react2.default.createElement("span",{className:"domain-tip__suggestion"})}}),message:this.translate("Upgrade your plan to register a domain."),href:"/domains/add/"+this.props.siteSlug}):this.domainUpgradeNudge())}});exports.default=(0,_reactRedux.connect)(function(state,ownProps){var site=(0,_selectors.getSite)(state,ownProps.siteId);var siteSlug=(0,_selectors.getSiteSlug)(state,ownProps.siteId);var queryObject=getQueryObject(site,siteSlug);return{suggestions:queryObject&&(0,_selectors2.getDomainsSuggestions)(state,queryObject),domainsWithPlansOnly:(0,_selectors3.currentUserHasFlag)(state,_constants.DOMAINS_WITH_PLANS_ONLY),site:site,siteSlug:siteSlug}})(DomainTip);module.exports=exports["default"]},2947:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _extends2=__webpack_require__(16);var _extends3=_interopRequireDefault(_extends2);var _getPrototypeOf=__webpack_require__(21);var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=__webpack_require__(8);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(9);var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=__webpack_require__(23);var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=__webpack_require__(22);var _inherits3=_interopRequireDefault(_inherits2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _reactRedux=__webpack_require__(15);var _pick=__webpack_require__(91);var _pick2=_interopRequireDefault(_pick);var _i18nCalypso=__webpack_require__(11);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _statsTabs=__webpack_require__(1851);var _statsTabs2=_interopRequireDefault(_statsTabs);var _tab=__webpack_require__(1852);var _tab2=_interopRequireDefault(_tab);var _sectionHeader=__webpack_require__(1644);var _sectionHeader2=_interopRequireDefault(_sectionHeader);var _querySiteStats=__webpack_require__(1881);var _querySiteStats2=_interopRequireDefault(_querySiteStats);var _selectors=__webpack_require__(47);var _selectors2=__webpack_require__(1863);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var StatsAllTime=function(_Component){(0,_inherits3.default)(StatsAllTime,_Component);function StatsAllTime(){(0,_classCallCheck3.default)(this,StatsAllTime);return(0,_possibleConstructorReturn3.default)(this,(StatsAllTime.__proto__||(0,_getPrototypeOf2.default)(StatsAllTime)).apply(this,arguments))}(0,_createClass3.default)(StatsAllTime,[{key:"render",value:function render(){var _props=this.props;var translate=_props.translate;var siteId=_props.siteId;var requesting=_props.requesting;var posts=_props.posts;var views=_props.views;var visitors=_props.visitors;var viewsBestDay=_props.viewsBestDay;var viewsBestDayTotal=_props.viewsBestDayTotal;var query=_props.query;var isLoading=requesting&&!views;var bestDay=void 0;if(viewsBestDay&&!isLoading){bestDay=(0,_i18nCalypso.moment)(viewsBestDay).format("LL")}var classes={"is-loading":requesting};return _react2.default.createElement("div",null,siteId&&_react2.default.createElement(_querySiteStats2.default,{
siteId:siteId,statType:"stats",query:query}),_react2.default.createElement(_sectionHeader2.default,{label:translate("All-time posts, views, and visitors")}),_react2.default.createElement(_card2.default,{className:(0,_classnames2.default)("stats-module","all-time",classes)},_react2.default.createElement(_statsTabs2.default,{borderless:true},_react2.default.createElement(_tab2.default,{gridicon:"posts",label:translate("Posts"),loading:isLoading,value:posts}),_react2.default.createElement(_tab2.default,{gridicon:"visible",label:translate("Views"),loading:isLoading,value:views}),_react2.default.createElement(_tab2.default,{gridicon:"user",label:translate("Visitors"),loading:isLoading,value:visitors}),_react2.default.createElement(_tab2.default,{className:"all-time__is-best",gridicon:"trophy",label:translate("Best Views Ever"),loading:isLoading,value:viewsBestDayTotal},_react2.default.createElement("span",{className:"all-time__best-day"},bestDay)))))}}]);return StatsAllTime}(_react.Component);StatsAllTime.propTypes={translate:_react.PropTypes.func,siteId:_react.PropTypes.number,requesting:_react.PropTypes.bool,query:_react.PropTypes.object,posts:_react.PropTypes.number,views:_react.PropTypes.number,viewsBestDay:_react.PropTypes.string,viewsBestDayTotal:_react.PropTypes.number};exports.default=(0,_reactRedux.connect)(function(state){var siteId=(0,_selectors.getSelectedSiteId)(state);var query={};var allTimeData=(0,_selectors2.getSiteStatsNormalizedData)(state,siteId,"stats",query)||{};var allTimeStats=(0,_pick2.default)(allTimeData,["posts","views","visitors","viewsBestDay","viewsBestDayTotal"]);return(0,_extends3.default)({requesting:(0,_selectors2.isRequestingSiteStatsForQuery)(state,siteId,"stats",query),query:query,siteId:siteId},allTimeStats)})((0,_i18nCalypso.localize)(StatsAllTime));module.exports=exports["default"]},2948:function(module,exports,__webpack_require__){"use strict";var _typeof2=__webpack_require__(32);var _typeof3=_interopRequireDefault(_typeof2);var _find2=__webpack_require__(27);var _find3=_interopRequireDefault(_find2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _page=__webpack_require__(33);var _page2=_interopRequireDefault(_page);var _i18nCalypso=__webpack_require__(11);var _i18nCalypso2=_interopRequireDefault(_i18nCalypso);var _config=__webpack_require__(12);var _config2=_interopRequireDefault(_config);var _user=__webpack_require__(48);var _user2=_interopRequireDefault(_user);var _sitesList=__webpack_require__(53);var _sitesList2=_interopRequireDefault(_sitesList);var _route=__webpack_require__(132);var _route2=_interopRequireDefault(_route);var _analytics=__webpack_require__(20);var _analytics2=_interopRequireDefault(_analytics);var _toTitleCase=__webpack_require__(724);var _toTitleCase2=_interopRequireDefault(_toTitleCase);var _actions=__webpack_require__(712);var _reactHelpers=__webpack_require__(711);var _actions2=__webpack_require__(226);var _selectors=__webpack_require__(181);var _actions3=__webpack_require__(82);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var user=(0,_user2.default)();var sites=(0,_sitesList2.default)();var analyticsPageTitle="Stats";function rangeOfPeriod(period,date){var periodRange={period:period,startOf:date.clone().startOf(period),endOf:date.clone().endOf(period)};if("week"===period){if("0"===date.format("d")){periodRange.startOf.subtract(6,"d");periodRange.endOf.subtract(6,"d")}else{periodRange.startOf.add(1,"d");periodRange.endOf.add(1,"d")}}periodRange.key=period+":"+periodRange.endOf.format("YYYY-MM-DD");return periodRange}function getNumPeriodAgo(momentSiteZone,date,period){var endOfCurrentPeriod=momentSiteZone.endOf(period);var durationAgo=_i18nCalypso2.default.moment.duration(endOfCurrentPeriod.diff(date));var numPeriodAgo=void 0;switch(period){case"day":numPeriodAgo=durationAgo.asDays();break;case"week":numPeriodAgo=durationAgo.asWeeks();break;case"month":numPeriodAgo=durationAgo.asMonths();break;case"year":numPeriodAgo=durationAgo.asYears();break}return numPeriodAgo}function getSiteFilters(siteId){var filters=[{title:_i18nCalypso2.default.translate("Insights"),path:"/stats/insights/"+siteId,id:"stats-insights"},{title:_i18nCalypso2.default.translate("Days"),path:"/stats/day/"+siteId,id:"stats-day",period:"day"},{title:_i18nCalypso2.default.translate("Weeks"),path:"/stats/week/"+siteId,id:"stats-week",period:"week"},{title:_i18nCalypso2.default.translate("Months"),path:"/stats/month/"+siteId,id:"stats-month",period:"month"},{title:_i18nCalypso2.default.translate("Years"),path:"/stats/year/"+siteId,id:"stats-year",period:"year"}];return filters}module.exports={resetFirstView:function resetFirstView(context){context.store.dispatch((0,_actions2.savePreference)("firstViewHistory",[]))},redirectToDefaultSitePage:function redirectToDefaultSitePage(context,next){var siteFragment=_route2.default.getSiteFragment(context.path);if(siteFragment){var currentLayoutFocus=(0,_selectors.getCurrentLayoutFocus)(context.store.getState());context.store.dispatch((0,_actions3.setNextLayoutFocus)(currentLayoutFocus));_page2.default.redirect(_route2.default.getStatsDefaultSitePage(siteFragment))}else{next()}},insights:function insights(context,next){var Insights=__webpack_require__(2968);var StatsList=__webpack_require__(1907);var FollowList=__webpack_require__(1973);var siteId=context.params.site_id;var basePath=_route2.default.sectionify(context.path);var followList=new FollowList;var summaryDate=void 0;var summarySites=[];var momentSiteZone=_i18nCalypso2.default.moment();var StatsComponent=Insights;context.store.dispatch((0,_actions.setDocumentHeadTitle)(_i18nCalypso2.default.translate("Stats",{textOnly:true})));var site=sites.getSite(siteId);if(!site){site=sites.getSite(parseInt(siteId,10))}siteId=site?site.ID||0:0;if(0===siteId){if(0===sites.data.length){sites.once("change",function(){(0,_page2.default)(context.path)})}else{next()}}if(site&&site.options&&typeof site.options.gmt_offset!=="undefined"){momentSiteZone=_i18nCalypso2.default.moment().utcOffset(site.options.gmt_offset);summaryDate=momentSiteZone.format("YYYY-MM-DD");summarySites.push({ID:siteId,date:summaryDate})}var siteDomain=site&&typeof site.slug!=="undefined"?site.slug:_route2.default.getSiteFragment(context.path);var commentsList=new StatsList({siteID:siteId,statType:"statsComments",domain:siteDomain});var tagsList=new StatsList({siteID:siteId,statType:"statsTags",domain:siteDomain});var wpcomFollowersList=new StatsList({siteID:siteId,statType:"statsFollowers",type:"wpcom",domain:siteDomain,max:7});var emailFollowersList=new StatsList({siteID:siteId,statType:"statsFollowers",type:"email",domain:siteDomain,max:7});var commentFollowersList=new StatsList({siteID:siteId,statType:"statsCommentFollowers",domain:siteDomain,max:7});_analytics2.default.pageView.record(basePath,analyticsPageTitle+" > Insights");(0,_reactHelpers.renderWithReduxStore)(_react2.default.createElement(StatsComponent,{site:site,followList:followList,commentsList:commentsList,tagsList:tagsList,wpcomFollowersList:wpcomFollowersList,emailFollowersList:emailFollowersList,commentFollowersList:commentFollowersList,summaryDate:summaryDate}),document.getElementById("primary"),context.store)},overview:function overview(context,next){var StatsComponent=__webpack_require__(2952);var filters=function filters(){return[{title:_i18nCalypso2.default.translate("Days"),path:"/stats/day",altPaths:["/stats"],id:"stats-day",period:"day"},{title:_i18nCalypso2.default.translate("Weeks"),path:"/stats/week",id:"stats-week",period:"week"},{title:_i18nCalypso2.default.translate("Months"),path:"/stats/month",id:"stats-month",period:"month"},{title:_i18nCalypso2.default.translate("Years"),path:"/stats/year",id:"stats-year",period:"year"}]};var basePath=_route2.default.sectionify(context.path);window.scrollTo(0,0);context.store.dispatch((0,_actions.setDocumentHeadTitle)(_i18nCalypso2.default.translate("Stats",{textOnly:true})));var activeFilter=(0,_find3.default)(filters(),function(filter){return context.pathname===filter.path||filter.altPaths&&-1!==filter.altPaths.indexOf(context.pathname)});if(!activeFilter){next()}else{_analytics2.default.mc.bumpStat("calypso_stats_overview_period",activeFilter.period);_analytics2.default.pageView.record(basePath,analyticsPageTitle+" > "+(0,_toTitleCase2.default)(activeFilter.period));(0,_reactHelpers.renderWithReduxStore)(_react2.default.createElement(StatsComponent,{period:activeFilter.period,sites:sites,path:context.pathname,user:user}),document.getElementById("primary"),context.store)}},site:function site(context,next){var siteId=context.params.site_id;var siteFragment=_route2.default.getSiteFragment(context.path);var queryOptions=context.query;var FollowList=__webpack_require__(1973);var SiteStatsComponent=__webpack_require__(2960);var StatsList=__webpack_require__(1907);var filters=getSiteFilters.bind(null,siteId);var date=void 0;var charts=function charts(){return[{attr:"views",legendOptions:["visitors"],gridicon:"visible",label:_i18nCalypso2.default.translate("Views",{context:"noun"})},{attr:"visitors",gridicon:"user",label:_i18nCalypso2.default.translate("Visitors",{context:"noun"})},{attr:"likes",gridicon:"star",label:_i18nCalypso2.default.translate("Likes",{context:"noun"})},{attr:"comments",gridicon:"comment",label:_i18nCalypso2.default.translate("Comments",{context:"noun"})}]};var chartDate=void 0;var chartTab=void 0;var visitsListFields=void 0;var endDate=void 0;var chartEndDate=void 0;var period=void 0;var chartPeriod=void 0;var siteOffset=0;var momentSiteZone=_i18nCalypso2.default.moment();var numPeriodAgo=0;var basePath=_route2.default.sectionify(context.path);var baseAnalyticsPath=void 0;var chartQuantity=10;var siteComponent=void 0;context.store.dispatch((0,_actions.setDocumentHeadTitle)(_i18nCalypso2.default.translate("Stats",{textOnly:true})));var currentSite=sites.getSite(siteId);if(!currentSite){currentSite=sites.getSite(parseInt(siteId,10))}siteId=currentSite?currentSite.ID||0:0;var activeFilter=(0,_find3.default)(filters(),function(filter){return context.pathname===filter.path||filter.altPaths&&-1!==filter.altPaths.indexOf(context.pathname)});if(!siteFragment||!activeFilter){next()}else{if(0===siteId){if(0===sites.data.length){sites.once("change",function(){(0,_page2.default)(context.path)})}else{next()}}if(currentSite&&currentSite.domain){context.store.dispatch((0,_actions.setDocumentHeadTitle)(_i18nCalypso2.default.translate("Stats",{textOnly:true})))}if(currentSite&&"object"===(0,_typeof3.default)(currentSite.options)&&"undefined"!==typeof currentSite.options.gmt_offset){siteOffset=currentSite.options.gmt_offset}momentSiteZone=_i18nCalypso2.default.moment().utcOffset(siteOffset);chartDate=rangeOfPeriod(activeFilter.period,momentSiteZone.clone().locale("en")).endOf;if(queryOptions.startDate&&_i18nCalypso2.default.moment(queryOptions.startDate).isValid){date=_i18nCalypso2.default.moment(queryOptions.startDate).locale("en");numPeriodAgo=getNumPeriodAgo(momentSiteZone,date,activeFilter.period)}else{date=rangeOfPeriod(activeFilter.period,momentSiteZone.clone().locale("en")).startOf}numPeriodAgo=parseInt(numPeriodAgo,10);if(numPeriodAgo){if(numPeriodAgo>9){numPeriodAgo="10plus"}numPeriodAgo="-"+numPeriodAgo}else{numPeriodAgo=""}baseAnalyticsPath=basePath+"/:site";_analytics2.default.mc.bumpStat("calypso_stats_site_period",activeFilter.period+numPeriodAgo);_analytics2.default.pageView.record(baseAnalyticsPath,analyticsPageTitle+" > "+(0,_toTitleCase2.default)(activeFilter.period));period=rangeOfPeriod(activeFilter.period,date);chartPeriod=rangeOfPeriod(activeFilter.period,chartDate);endDate=period.endOf.format("YYYY-MM-DD");chartEndDate=chartPeriod.endOf.format("YYYY-MM-DD");chartTab=queryOptions.tab||"views";visitsListFields=chartTab;if("views"===visitsListFields){visitsListFields="views,visitors"}switch(activeFilter.period){case"day":chartQuantity=30;break;case"month":chartQuantity=12;break;case"week":chartQuantity=13;break;case"year":break;default:chartQuantity=10;break}var siteDomain=currentSite&&typeof currentSite.slug!=="undefined"?currentSite.slug:siteFragment;var followList=new FollowList;var activeTabVisitsList=new StatsList({siteID:siteId,statType:"statsVisits",unit:activeFilter.period,quantity:chartQuantity,date:chartEndDate,stat_fields:visitsListFields,domain:siteDomain});var visitsList=new StatsList({siteID:siteId,statType:"statsVisits",unit:activeFilter.period,quantity:chartQuantity,date:chartEndDate,stat_fields:"views,visitors,likes,comments,post_titles",domain:siteDomain});var postsPagesList=new StatsList({siteID:siteId,statType:"statsTopPosts",period:activeFilter.period,date:endDate,domain:siteDomain});var referrersList=new StatsList({siteID:siteId,statType:"statsReferrers",period:activeFilter.period,date:endDate,domain:siteDomain});var clicksList=new StatsList({siteID:siteId,statType:"statsClicks",period:activeFilter.period,date:endDate,domain:siteDomain});var authorsList=new StatsList({siteID:siteId,statType:"statsTopAuthors",period:activeFilter.period,date:endDate,domain:siteDomain});var countriesList=new StatsList({siteID:siteId,statType:"statsCountryViews",period:activeFilter.period,date:endDate,domain:siteDomain});var videoPlaysList=new StatsList({siteID:siteId,statType:"statsVideoPlays",period:activeFilter.period,date:endDate,domain:siteDomain});var searchTermsList=new StatsList({siteID:siteId,statType:"statsSearchTerms",period:activeFilter.period,date:endDate,domain:siteDomain});var tagsList=new StatsList({siteID:siteId,statType:"statsTags",domain:siteDomain});var commentsList=new StatsList({siteID:siteId,statType:"statsComments",domain:siteDomain});var wpcomFollowersList=new StatsList({siteID:siteId,statType:"statsFollowers",type:"wpcom",domain:siteDomain,max:7});var emailFollowersList=new StatsList({siteID:siteId,statType:"statsFollowers",type:"email",domain:siteDomain,max:7});var commentFollowersList=new StatsList({siteID:siteId,statType:"statsCommentFollowers",domain:siteDomain,max:7});siteComponent=SiteStatsComponent;var siteComponentChildren={date:date,charts:charts,chartDate:chartDate,chartTab:chartTab,context:context,sites:sites,activeTabVisitsList:activeTabVisitsList,visitsList:visitsList,postsPagesList:postsPagesList,referrersList:referrersList,clicksList:clicksList,authorsList:authorsList,countriesList:countriesList,videoPlaysList:videoPlaysList,siteId:siteId,period:period,chartPeriod:chartPeriod,tagsList:tagsList,commentsList:commentsList,wpcomFollowersList:wpcomFollowersList,emailFollowersList:emailFollowersList,commentFollowersList:commentFollowersList,followList:followList,searchTermsList:searchTermsList,slug:siteDomain,path:context.pathname};if(_config2.default.isEnabled("manage/stats/podcasts")){siteComponentChildren.podcastDownloadsList=new StatsList({siteID:siteId,statType:"statsPodcastDownloads",period:activeFilter.period,date:endDate,domain:siteDomain})}(0,_reactHelpers.renderWithReduxStore)(_react2.default.createElement(siteComponent,siteComponentChildren),document.getElementById("primary"),context.store)}},summary:function summary(context,next){var siteId=context.params.site_id;var siteFragment=_route2.default.getSiteFragment(context.path);var queryOptions=context.query;var StatsList=__webpack_require__(1907);var FollowList=__webpack_require__(1973);var StatsSummaryComponent=__webpack_require__(2980);var filters=function(contextModule,_siteId){return[{title:_i18nCalypso2.default.translate("Days"),path:"/stats/"+contextModule+"/"+_siteId,altPaths:["/stats/day/"+contextModule+"/"+_siteId],id:"stats-day",period:"day",back:"/stats/"+_siteId},{title:_i18nCalypso2.default.translate("Weeks"),path:"/stats/week/"+contextModule+"/"+_siteId,id:"stats-week",period:"week",back:"/stats/week/"+_siteId},{title:_i18nCalypso2.default.translate("Months"),path:"/stats/month/"+contextModule+"/"+_siteId,id:"stats-month",period:"month",back:"/stats/month/"+_siteId},{title:_i18nCalypso2.default.translate("Years"),path:"/stats/year/"+contextModule+"/"+_siteId,id:"stats-year",period:"year",back:"/stats/year/"+_siteId}]}.bind(null,context.params.module,siteId);var date=void 0;var endDate=void 0;var period=void 0;var summaryList=void 0;var visitsList=void 0;var followList=new FollowList;var validModules=["posts","referrers","clicks","countryviews","authors","videoplays","videodetails","podcastdownloads","searchterms"];var momentSiteZone=_i18nCalypso2.default.moment();var basePath=_route2.default.sectionify(context.path);var site=sites.getSite(siteId);if(!site){site=sites.getSite(parseInt(siteId,10))}siteId=site?site.ID||0:0;var activeFilter=(0,_find3.default)(filters(),function(filter){return context.pathname===filter.path||filter.altPaths&&-1!==filter.altPaths.indexOf(context.pathname)});if(siteFragment&&0===siteId){if(0===sites.data.length){sites.once("change",function(){(0,_page2.default)(context.path)})}else{window.location="/stats"}}else if(!activeFilter||-1===validModules.indexOf(context.params.module)){next()}else{if("object"===(0,_typeof3.default)(site.options)&&"undefined"!==typeof site.options.gmt_offset){momentSiteZone=_i18nCalypso2.default.moment().utcOffset(site.options.gmt_offset)}if(queryOptions.startDate&&_i18nCalypso2.default.moment(queryOptions.startDate).isValid){date=_i18nCalypso2.default.moment(queryOptions.startDate)}else{date=momentSiteZone.endOf(activeFilter.period)}period=rangeOfPeriod(activeFilter.period,date);endDate=period.endOf.format("YYYY-MM-DD");var siteDomain=site&&typeof site.slug!=="undefined"?site.slug:siteFragment;switch(context.params.module){case"posts":visitsList=new StatsList({statType:"statsVisits",unit:activeFilter.period,siteID:siteId,quantity:10,date:endDate,domain:siteDomain});summaryList=new StatsList({statType:"statsTopPosts",siteID:siteId,period:activeFilter.period,date:endDate,max:0,domain:siteDomain});break;case"referrers":summaryList=new StatsList({siteID:siteId,statType:"statsReferrers",period:activeFilter.period,date:endDate,max:0,domain:siteDomain});break;case"clicks":summaryList=new StatsList({statType:"statsClicks",siteID:siteId,period:activeFilter.period,date:endDate,max:0,domain:siteDomain});break;case"countryviews":summaryList=new StatsList({siteID:siteId,statType:"statsCountryViews",period:activeFilter.period,date:endDate,max:0,domain:siteDomain});break;case"authors":summaryList=new StatsList({statType:"statsTopAuthors",siteID:siteId,period:activeFilter.period,date:endDate,max:0,domain:siteDomain});break;case"videoplays":summaryList=new StatsList({statType:"statsVideoPlays",siteID:siteId,period:activeFilter.period,date:endDate,max:0,domain:siteDomain});break;case"videodetails":summaryList=new StatsList({statType:"statsVideo",post:queryOptions.post,siteID:siteId,period:activeFilter.period,date:endDate,max:0,domain:siteDomain});break;case"searchterms":summaryList=new StatsList({siteID:siteId,statType:"statsSearchTerms",period:activeFilter.period,date:endDate,max:0,domain:siteDomain});break;case"podcastdownloads":summaryList=new StatsList({statType:"statsPodcastDownloads",siteID:siteId,period:activeFilter.period,date:endDate,max:0,domain:siteDomain});break}_analytics2.default.pageView.record(basePath,analyticsPageTitle+" > "+(0,_toTitleCase2.default)(activeFilter.period)+" > "+(0,_toTitleCase2.default)(context.params.module));(0,_reactHelpers.renderWithReduxStore)(_react2.default.createElement(StatsSummaryComponent,{date:date,context:context,path:context.pathname,sites:sites,filters:filters,summaryList:summaryList,visitsList:visitsList,followList:followList,siteId:siteId,period:period}),document.getElementById("primary"),context.store)}},post:function post(context){var siteId=context.params.site_id;var postId=parseInt(context.params.post_id,10);var StatsPostComponent=__webpack_require__(2978);var StatsList=__webpack_require__(1907);var pathParts=context.path.split("/");var postOrPage=pathParts[2]==="post"?"post":"page";var postViewsList=void 0;var site=sites.getSite(siteId);if(!site){site=sites.getSite(parseInt(siteId,10))}siteId=site?site.ID||0:0;if(0===siteId){if(0===sites.data.length){sites.once("change",function(){(0,_page2.default)(context.path)})}else{window.location="/stats"}}else{var siteDomain=site&&typeof site.slug!=="undefined"?site.slug:_route2.default.getSiteFragment(context.path);postViewsList=new StatsList({statType:"statsPostViews",siteID:siteId,post:postId,domain:siteDomain});_analytics2.default.pageView.record("/stats/"+postOrPage+"/:post_id/:site",analyticsPageTitle+" > Single "+(0,_toTitleCase2.default)(postOrPage));(0,_reactHelpers.renderWithReduxStore)(_react2.default.createElement(StatsPostComponent,{siteId:siteId,postId:postId,sites:sites,context:context,path:context.path,postViewsList:postViewsList}),document.getElementById("primary"),context.store)}},follows:function follows(context,next){var siteId=context.params.site_id;var FollowList=__webpack_require__(1973);var FollowsComponent=__webpack_require__(2949);var StatsList=__webpack_require__(1907);var validFollowTypes=["wpcom","email","comment"];var followType=context.params.follow_type;var pageNum=context.params.page_num;var followList=new FollowList;var followersList=void 0;var basePath=_route2.default.sectionify(context.path);var site=sites.getSite(siteId);if(!site){site=sites.getSite(parseInt(siteId,10))}siteId=site?site.ID||0:0;var siteDomain=site&&typeof site.slug!=="undefined"?site.slug:_route2.default.getSiteFragment(context.path);if(-1===validFollowTypes.indexOf(followType)){next()}else if(0===siteId){if(0===sites.data.length){sites.once("change",function(){(0,_page2.default)(context.path)})}else{window.location="/stats"}}else{pageNum=parseInt(pageNum,10);if(!pageNum||pageNum<1){pageNum=1}switch(followType){case"comment":followersList=new StatsList({siteID:siteId,statType:"statsCommentFollowers",domain:siteDomain,max:20,page:pageNum});break;case"email":case"wpcom":followersList=new StatsList({siteID:siteId,statType:"statsFollowers",domain:siteDomain,max:20,page:pageNum,type:followType});break}_analytics2.default.pageView.record(basePath.replace("/"+pageNum,""),analyticsPageTitle+" > Followers > "+(0,_toTitleCase2.default)(followType));(0,_reactHelpers.renderWithReduxStore)(_react2.default.createElement(FollowsComponent,{path:context.path,sites:sites,siteId:siteId,page:pageNum,perPage:20,total:10,followersList:followersList,followType:followType,followList:followList,domain:siteDomain}),document.getElementById("primary"),context.store)}}}},2949:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _page=__webpack_require__(33);var _page2=_interopRequireDefault(_page);var _dataObserve=__webpack_require__(131);var _dataObserve2=_interopRequireDefault(_dataObserve);var _statsFollowersPage=__webpack_require__(2966);var _statsFollowersPage2=_interopRequireDefault(_statsFollowersPage);var _headerCake=__webpack_require__(1650);var _headerCake2=_interopRequireDefault(_headerCake);var _analytics=__webpack_require__(20);var _analytics2=_interopRequireDefault(_analytics);var _main=__webpack_require__(166);var _main2=_interopRequireDefault(_main);var _statsFirstView=__webpack_require__(1850);var _statsFirstView2=_interopRequireDefault(_statsFirstView);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsFollows",mixins:[(0,_dataObserve2.default)("sites","site","followersList")],propTypes:{followType:_react.PropTypes.string,followList:_react.PropTypes.object,follwersList:_react.PropTypes.object,page:_react.PropTypes.number,perPage:_react.PropTypes.number,sites:_react.PropTypes.object},goBack:function goBack(){var site=this.props.sites.getSelectedSite();(0,_page2.default)("/stats/insights/"+site.slug)},componentDidMount:function componentDidMount(){window.scrollTo(0,0)},paginationHandler:function paginationHandler(pageNum){var site=this.props.sites.getSelectedSite();var path="/stats/follows/"+this.props.followType+"/";if(pageNum>1){path+=pageNum+"/"}path+=site.slug;_analytics2.default.ga.recordEvent("Stats","Used Pagination on Followers Page",pageNum);(0,_page2.default)(path)},changeFilter:function changeFilter(selection){var site=this.props.sites.getSelectedSite();var filter=selection.value;(0,_page2.default)("/stats/follows/"+filter+"/"+site.slug)},render:function render(){var _props=this.props;var followType=_props.followType;var followersList=_props.followersList;var followList=_props.followList;var perPage=_props.perPage;var sites=_props.sites;var site=sites.getSelectedSite();return _react2.default.createElement(_main2.default,null,_react2.default.createElement(_statsFirstView2.default,null),_react2.default.createElement("div",{id:"my-stats-content",className:"follows-detail follows-detail-"+followType},_react2.default.createElement(_headerCake2.default,{onClick:this.goBack},this.translate("Followers")),_react2.default.createElement(_statsFollowersPage2.default,{path:followType+"-follow-summary",site:site,followersList:followersList,followType:followType,followList:followList,page:this.props.page,perPage:perPage,pageClick:this.paginationHandler,changeFilter:this.changeFilter})))}});module.exports=exports["default"]},2950:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _throttle=__webpack_require__(388);var _throttle2=_interopRequireDefault(_throttle);var _analytics=__webpack_require__(20);var _analytics2=_interopRequireDefault(_analytics);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var loadScript=__webpack_require__(227).loadScript;exports.default=_react2.default.createClass({displayName:"StatsGeochart",visualizationsLoaded:false,visualization:null,propTypes:{data:_react.PropTypes.array.isRequired,dataList:_react.PropTypes.object.isRequired},componentDidMount:function componentDidMount(){if(!window.google){loadScript("https://www.google.com/jsapi");this.tick()}else{this.loadVisualizations()}this.resize=(0,_throttle2.default)(this.resize,1e3);window.addEventListener("resize",this.resize)},componentDidUpdate:function componentDidUpdate(){if(this.visualizationsLoaded){this.drawData()}},componentWillUnmount:function componentWillUnmount(){if(this.visualization){window.google.visualization.events.removeListener(this.visualization,"regionClick",this.recordEvent);this.visualization.clearChart()}if(this.resize.cancel){this.resize.cancel()}window.removeEventListener("resize",this.resize)},recordEvent:function recordEvent(){_analytics2.default.ga.recordEvent("Stats","Clicked Country on Map")},drawRegionsMap:function drawRegionsMap(){if(this.isMounted()){this.visualizationsLoaded=true;this.visualization=new window.google.visualization.GeoChart(this.refs.chart);window.google.visualization.events.addListener(this.visualization,"regionClick",this.recordEvent);this.drawData()}},resize:function resize(){if(this.visualizationsLoaded){this.drawData()}},drawData:function drawData(){var regionCodes=[];var _props=this.props;var data=_props.data;var dataList=_props.dataList;if(data.length>1){var chartData=window.google.visualization.arrayToDataTable(data);var node=this.refs.chart;var width=node.clientWidth;var options={width:100+"%",height:width<=480?"238":"480",keepAspectRatio:true,enableRegionInteractivity:true,region:"world",colorAxis:{colors:["#FFF088","#F34605"]}};dataList.response.data.map(function(country){if(regionCodes.indexOf(country.region)===-1){regionCodes.push(country.region)}});if(1===regionCodes.length){options.region=regionCodes[0]}this.visualization.draw(chartData,options)}},loadVisualizations:function loadVisualizations(){if(window.google){window.google.load("visualization","1",{packages:["geochart"],callback:this.drawRegionsMap});clearTimeout(this.timer)}else{this.tick()}},tick:function tick(){this.timer=setTimeout(this.loadVisualizations,1e3)},render:function render(){return _react2.default.createElement("div",{ref:"chart",className:"stats-geochart"})}});module.exports=exports["default"]},2951:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _extends2=__webpack_require__(16);var _extends3=_interopRequireDefault(_extends2);var _getPrototypeOf=__webpack_require__(21);var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=__webpack_require__(8);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(9);var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=__webpack_require__(23);var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=__webpack_require__(22);var _inherits3=_interopRequireDefault(_inherits2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _reactRedux=__webpack_require__(15);var _i18nCalypso=__webpack_require__(11);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _sectionHeader=__webpack_require__(1644);var _sectionHeader2=_interopRequireDefault(_sectionHeader);var _querySiteStats=__webpack_require__(1881);var _querySiteStats2=_interopRequireDefault(_querySiteStats);var _selectors=__webpack_require__(47);var _selectors2=__webpack_require__(1863);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var StatsMostPopular=function(_Component){(0,_inherits3.default)(StatsMostPopular,_Component);function StatsMostPopular(){(0,_classCallCheck3.default)(this,StatsMostPopular);return(0,_possibleConstructorReturn3.default)(this,(StatsMostPopular.__proto__||(0,_getPrototypeOf2.default)(StatsMostPopular)).apply(this,arguments))}(0,_createClass3.default)(StatsMostPopular,[{key:"render",value:function render(){var _props=this.props;var day=_props.day;var percent=_props.percent;var hour=_props.hour;var hourPercent=_props.hourPercent;var requesting=_props.requesting;var siteId=_props.siteId;var translate=_props.translate;var statType=_props.statType;var classes=(0,_classnames2.default)("most-popular","stats-module","is-site-overview",{"is-loading":requesting&&!percent,"is-empty":!percent});return _react2.default.createElement("div",null,siteId&&_react2.default.createElement(_querySiteStats2.default,{siteId:siteId,statType:statType}),_react2.default.createElement(_sectionHeader2.default,{label:translate("Most popular day and hour")}),_react2.default.createElement(_card2.default,{className:classes},_react2.default.createElement("div",{className:"most-popular__wrapper"},_react2.default.createElement("div",{className:"most-popular__item"},_react2.default.createElement("span",{className:"most-popular__label"},translate("Most popular day")),_react2.default.createElement("span",{className:"most-popular__day"},day),_react2.default.createElement("span",{className:"most-popular__percentage"},translate("%(percent)d%% of views",{args:{percent:percent||0},context:"Stats: Percentage of views"}))),_react2.default.createElement("div",{className:"most-popular__item"},_react2.default.createElement("span",{className:"most-popular__label"},translate("Most popular hour")),_react2.default.createElement("span",{className:"most-popular__hour"},hour),_react2.default.createElement("span",{className:"most-popular__percentage"},translate("%(percent)d%% of views",{args:{percent:hourPercent||0},context:"Stats: Percentage of views"}))),!percent&&!requesting&&_react2.default.createElement("div",{className:"most-popular__empty"},_react2.default.createElement("span",{className:"most-popular__notice"},translate("No popular day and time recorded",{context:"Message on stats insights page when no most popular data exists.",
comment:"Should be limited to 32 characters to prevent wrapping"}))))))}}]);return StatsMostPopular}(_react.Component);StatsMostPopular.propTypes={day:_react.PropTypes.string,percent:_react.PropTypes.number,hour:_react.PropTypes.string,hourPercent:_react.PropTypes.number,requesting:_react.PropTypes.bool,siteId:_react.PropTypes.number,query:_react.PropTypes.object,translate:_react.PropTypes.func};exports.default=(0,_reactRedux.connect)(function(state){var statType="statsInsights";var siteId=(0,_selectors.getSelectedSiteId)(state);var mostPopularData=(0,_selectors2.getSiteStatsNormalizedData)(state,siteId,statType,{});return(0,_extends3.default)({requesting:(0,_selectors2.isRequestingSiteStatsForQuery)(state,siteId,statType,{}),siteId:siteId,statType:statType},mostPopularData)})((0,_i18nCalypso.localize)(StatsMostPopular));module.exports=exports["default"]},2952:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _typeof2=__webpack_require__(32);var _typeof3=_interopRequireDefault(_typeof2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _dataObserve=__webpack_require__(131);var _dataObserve2=_interopRequireDefault(_dataObserve);var _sidebarNavigation=__webpack_require__(1656);var _sidebarNavigation2=_interopRequireDefault(_sidebarNavigation);var _statsSiteOverview=__webpack_require__(2326);var _statsSiteOverview2=_interopRequireDefault(_statsSiteOverview);var _statsOverviewPlaceholder=__webpack_require__(2977);var _statsOverviewPlaceholder2=_interopRequireDefault(_statsOverviewPlaceholder);var _statsDatePicker=__webpack_require__(1912);var _statsDatePicker2=_interopRequireDefault(_statsDatePicker);var _statsNavigation=__webpack_require__(2131);var _statsNavigation2=_interopRequireDefault(_statsNavigation);var _main=__webpack_require__(166);var _main2=_interopRequireDefault(_main);var _statsFirstView=__webpack_require__(1850);var _statsFirstView2=_interopRequireDefault(_statsFirstView);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsOverview",mixins:[(0,_dataObserve2.default)("sites")],propTypes:{path:_react.PropTypes.string},render:function render(){var _props=this.props;var path=_props.path;var period=_props.period;var sites=this.props.sites.getVisible();var statsPath=path==="/stats"?"/stats/day":path;var sitesSorted=sites.map(function(site){var momentSiteZone=this.moment();if("object"===(0,_typeof3.default)(site.options)&&"undefined"!==typeof site.options.gmt_offset){momentSiteZone=this.moment().utcOffset(site.options.gmt_offset)}site.periodEnd=momentSiteZone.endOf(this.props.period).format("YYYY-MM-DD");return site},this);sitesSorted.sort(function(a,b){if(a.periodEnd>b.periodEnd){return 1}if(a.periodEnd<b.periodEnd){return-1}if(a.primary){return-1}if(b.primary){return 1}if(a.title.toUpperCase()>b.title.toUpperCase()){return 1}if(a.title.toUpperCase()<b.title.toUpperCase()){return-1}return 0});var sitesList=sitesSorted.map(function(site,index){var siteOffset=0;var overview=[];if("object"===(0,_typeof3.default)(site.options)&&"undefined"!==typeof site.options.gmt_offset){siteOffset=site.options.gmt_offset}var date=this.moment().utcOffset(siteOffset).format("YYYY-MM-DD");if(0===index||sitesSorted[index-1].periodEnd!==site.periodEnd){overview.push(_react2.default.createElement(_statsDatePicker2.default,{period:period,date:date}))}overview.push(_react2.default.createElement(_statsSiteOverview2.default,{key:site.ID,siteId:site.ID,period:period,date:date,path:statsPath,title:site.title,siteSlug:site.slug}));return overview},this);return _react2.default.createElement(_main2.default,null,_react2.default.createElement(_statsFirstView2.default,null),_react2.default.createElement(_sidebarNavigation2.default,null),_react2.default.createElement(_statsNavigation2.default,{section:this.props.period}),sites.length!==0?sitesList:this.placeholders())},placeholders:function placeholders(){var items=[];var limit=Math.min(this.props.user.get().visible_site_count,10);items.push(_react2.default.createElement("h3",{className:"stats-section-title"},"Â "));for(var i=0;i<limit;i++){items.push(_react2.default.createElement(_statsOverviewPlaceholder2.default,{key:i}))}return items}});module.exports=exports["default"]},2953:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1);var PaginationPage=__webpack_require__(2954);module.exports=React.createClass({displayName:"StatModulePagination",propTypes:{page:React.PropTypes.number.isRequired,perPage:React.PropTypes.number.isRequired,total:React.PropTypes.number,pageClick:React.PropTypes.func.isRequired},render:function render(){var props=this.props,currentPage=props.page,pageList=[],perPage=props.perPage,total=props.total,pageCount=Math.ceil(total/perPage),pagination=null,i;if(pageCount>1){pageList=[1,currentPage-2,currentPage-1,currentPage,currentPage+1,currentPage+2,pageCount];pageList.sort(function(a,b){return a-b});pageList=pageList.filter(function(pageNumber,index,originalPageList){return pageNumber>=1&&pageNumber<=pageCount&&originalPageList.lastIndexOf(pageNumber)===index});for(i=pageList.length-2;i>=0;i--){if(2===pageList[i+1]-pageList[i]){pageList.splice(i+1,0,pageList[i+1]-1)}else if(pageList[i+1]-pageList[i]>1){pageList.splice(i+1,0,"...")}}pageList.unshift("-->");pageList.unshift("<--");pageList=pageList.map(function(pageNumber,index){return React.createElement(PaginationPage,{key:index,pageNumber:pageNumber,currentPage:currentPage,totalPages:pageCount,pageClick:this.props.pageClick})},this)}if(pageCount>1){pagination=React.createElement("div",{className:"stats-pagination"},React.createElement("ul",{className:"stats-pagination__list"},pageList))}else{pagination=null}return pagination}})},2954:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),classNames=__webpack_require__(10);var Gridicon=__webpack_require__(26);module.exports=React.createClass({displayName:"StatModulePaginationPage",propTypes:{pageNumber:React.PropTypes.node.isRequired,currentPage:React.PropTypes.number.isRequired,totalPages:React.PropTypes.number.isRequired,pageClick:React.PropTypes.func.isRequired},clickHandler:function clickHandler(event){event.stopPropagation();switch(this.props.pageNumber){case"<--":if(this.props.currentPage-1<1){return}this.props.pageClick(this.props.currentPage-1);break;case"-->":if(this.props.currentPage+1>this.props.totalPages){return}this.props.pageClick(this.props.currentPage+1);break;default:if(this.props.currentPage===this.props.pageNumber){return}this.props.pageClick(this.props.pageNumber);break}},render:function render(){var listClass,pageNumberElement;switch(this.props.pageNumber){case"...":pageNumberElement=React.createElement("li",{className:"stats-pagination__list-item stats-pagination__ellipsis","aria-hidden":"true"},"â€¦");break;case"<--":listClass=classNames("stats-pagination__list-item stats-pagination__arrow","is-left",{"is-active":this.props.currentPage>1});pageNumberElement=React.createElement("li",{className:listClass,onClick:this.clickHandler,tabIndex:"0"},React.createElement(Gridicon,{icon:"arrow-left"}));break;case"-->":listClass=classNames("stats-pagination__list-item stats-pagination__arrow","is-right",{"is-active":this.props.currentPage<this.props.totalPages});pageNumberElement=React.createElement("li",{className:listClass,onClick:this.clickHandler,tabIndex:"0"},React.createElement(Gridicon,{icon:"arrow-right"}));break;default:listClass=classNames("stats-pagination__list-item stats-pagination__page-number",{"is-selected":this.props.currentPage===this.props.pageNumber});pageNumberElement=React.createElement("li",{className:listClass,onClick:this.clickHandler,tabIndex:"0"},this.numberFormat(this.props.pageNumber));break}return pageNumberElement}})},2955:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _extends2=__webpack_require__(16);var _extends3=_interopRequireDefault(_extends2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _reactRedux=__webpack_require__(15);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _analytics=__webpack_require__(20);var _analytics2=_interopRequireDefault(_analytics);var _button=__webpack_require__(69);var _button2=_interopRequireDefault(_button);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _statsTabs=__webpack_require__(1851);var _statsTabs2=_interopRequireDefault(_statsTabs);var _tab=__webpack_require__(1852);var _tab2=_interopRequireDefault(_tab);var _placeholder=__webpack_require__(1729);var _placeholder2=_interopRequireDefault(_placeholder);var _emojify=__webpack_require__(2044);var _emojify2=_interopRequireDefault(_emojify);var _sectionHeader=__webpack_require__(1644);var _sectionHeader2=_interopRequireDefault(_sectionHeader);var _queryPosts=__webpack_require__(762);var _queryPosts2=_interopRequireDefault(_queryPosts);var _queryPostStats=__webpack_require__(2034);var _queryPostStats2=_interopRequireDefault(_queryPostStats);var _selectors=__webpack_require__(112);var _selectors2=__webpack_require__(1926);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var StatsPostPerformance=_react2.default.createClass({displayName:"StatsPostPerformance",propTypes:{viewCount:_react.PropTypes.number,site:_react.PropTypes.oneOfType([_react.PropTypes.bool,_react.PropTypes.object]),siteID:_react.PropTypes.number,query:_react.PropTypes.object,post:_react.PropTypes.object,isRequesting:_react.PropTypes.bool},buildTabs:function buildTabs(summaryUrl){var _props=this.props;var viewCount=_props.viewCount;var post=_props.post;var loading=_props.loading;var tabClassName="is-post-summary";var tabs=[{label:this.translate("Views"),gridicon:"visible",value:viewCount,href:summaryUrl,className:tabClassName,loading:loading},{label:this.translate("Likes"),gridicon:"star",value:post?post.like_count:null,className:tabClassName,loading:loading},{label:this.translate("Comments"),gridicon:"comment",value:post?post.discussion.comment_count:null,className:tabClassName,loading:loading}];return tabs.map(function(tabOptions){return _react2.default.createElement(_tab2.default,(0,_extends3.default)({},tabOptions,{key:tabOptions.gridicon}))})},recordClickOnNewPostButton:function recordClickOnNewPostButton(){_analytics2.default.tracks.recordEvent("calypso_stats_new_post_click")},render:function render(){var _props2=this.props;var site=_props2.site;var query=_props2.query;var post=_props2.post;var isRequesting=_props2.isRequesting;var loading=!site||isRequesting;var postTime=post?this.moment(post.date):this.moment();var cardClass=(0,_classnames2.default)("stats-module","stats-post-performance","is-site-overview");var newPostUrl=site?"/post/"+site.slug:"/post";var summaryUrl=post?"/stats/post/"+post.ID+"/"+this.props.site.slug:undefined;var postTitle=void 0;if(post){if(!post.title){postTitle=this.translate("(no title)")}else{postTitle=post.title}}return _react2.default.createElement("div",null,site?_react2.default.createElement(_queryPosts2.default,{siteId:site.ID,query:query}):null,site&&post?_react2.default.createElement(_queryPostStats2.default,{siteId:site.ID,postId:post.ID,stat:"views"}):null,_react2.default.createElement(_sectionHeader2.default,{label:this.translate("Latest Post Summary"),href:summaryUrl}),_react2.default.createElement(_card2.default,{className:cardClass},_react2.default.createElement(_placeholder2.default,{isLoading:loading&&!post}),post?_react2.default.createElement("div",{className:"module-content-text"},_react2.default.createElement("p",null,this.translate("It's been %(timeLapsed)s since {{href}}{{postTitle/}}{{/href}} was published. Here's how the post has performed so farâ€¦",{args:{timeLapsed:postTime.fromNow(true)},components:{href:_react2.default.createElement("a",{href:post.URL,target:"_blank",rel:"noopener noreferrer"}),postTitle:_react2.default.createElement(_emojify2.default,null,postTitle)},context:"Stats: Sentence showing how much time has passed since the last post, and how the stats are"}))):null,!loading&&!post?_react2.default.createElement("div",{className:"module-content-text is-empty-message is-error"},_react2.default.createElement("p",{className:"stats-post-performance__no-posts-message"},this.translate("You haven't published any posts yet.")),_react2.default.createElement("div",{className:"stats-post-performance__start-post"},_react2.default.createElement(_button2.default,{primary:true,href:newPostUrl,onClick:this.recordClickOnNewPostButton},this.translate("Start a Post")))):null,post?_react2.default.createElement(_statsTabs2.default,null,this.buildTabs(summaryUrl)):null))}});exports.default=(0,_reactRedux.connect)(function(state,ownProps){var site=ownProps.site;var query={status:"publish",number:1};var posts=site?(0,_selectors.getSitePostsForQuery)(state,site.ID,query):null;var post=posts&&posts.length?posts[0]:null;var viewCount=post&&site?(0,_selectors2.getPostStat)(state,"views",site.ID,post.ID):null;var isRequesting=(0,_selectors.isRequestingSitePostsForQuery)(state,site.ID,query);return{viewCount:viewCount,query:query,post:post,isRequesting:isRequesting}})(StatsPostPerformance);module.exports=exports["default"]},2956:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _mixin=__webpack_require__(111);var _mixin2=_interopRequireDefault(_mixin);var _tooltip=__webpack_require__(722);var _tooltip2=_interopRequireDefault(_tooltip);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"PostTrendsDay",mixins:[_mixin2.default],propTypes:{label:_react.PropTypes.string,className:_react.PropTypes.string,postCount:_react.PropTypes.number},getDefaultProps:function getDefaultProps(){return{postCount:0}},getInitialState:function getInitialState(){return{showPopover:false}},mouseEnter:function mouseEnter(){this.setState({showPopover:true})},mouseLeave:function mouseLeave(){this.setState({showPopover:false})},buildTooltipData:function buildTooltipData(){var _props=this.props;var label=_props.label;var postCount=_props.postCount;var content=this.translate("%(posts)d post","%(posts)d posts",{count:postCount,args:{posts:postCount},comment:"How many posts published on a certain date."});return _react2.default.createElement("span",null,_react2.default.createElement("span",{className:"post-count"},content," "),_react2.default.createElement("span",{className:"date"},label))},render:function render(){var _props2=this.props;var postCount=_props2.postCount;var className=_props2.className;var hoveredClass={"is-hovered":this.state.showPopover};return _react2.default.createElement("div",{className:(0,_classnames2.default)("post-trends__day",hoveredClass,className),onMouseEnter:postCount>0?this.mouseEnter:null,onMouseLeave:postCount>0?this.mouseLeave:null,ref:"day"},postCount>0&&_react2.default.createElement(_tooltip2.default,{className:"chart__tooltip is-streak",id:"popover__chart-bar",context:this.refs&&this.refs.day,isVisible:this.state.showPopover,position:"top"},this.buildTooltipData()))}});module.exports=exports["default"]},2957:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _reactRedux=__webpack_require__(15);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _throttle=__webpack_require__(388);var _throttle2=_interopRequireDefault(_throttle);var _i18nCalypso=__webpack_require__(11);var _i18nCalypso2=_interopRequireDefault(_i18nCalypso);var _month=__webpack_require__(2958);var _month2=_interopRequireDefault(_month);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _sectionHeader=__webpack_require__(1644);var _sectionHeader2=_interopRequireDefault(_sectionHeader);var _querySiteStats=__webpack_require__(1881);var _querySiteStats2=_interopRequireDefault(_querySiteStats);var _selectors=__webpack_require__(47);var _selectors2=__webpack_require__(1863);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var PostTrends=_react2.default.createClass({displayName:"PostTrends",propTypes:{siteId:_react.PropTypes.number,query:_react.PropTypes.object},getInitialState:function getInitialState(){return{canScrollLeft:false,canScrollRight:false}},componentDidMount:function componentDidMount(){var node=this.refs.wrapper,yearNode=this.refs.year,computedStyle=window.getComputedStyle(yearNode),margin=parseInt(computedStyle.getPropertyValue("margin-left"),10)+parseInt(computedStyle.getPropertyValue("margin-right"),10);yearNode.style.left=0-yearNode.scrollWidth+node.clientWidth-margin+"px";this.resize=(0,_throttle2.default)(this.resize,400);window.addEventListener("resize",this.resize);this.resize()},componentWillUnmount:function componentWillUnmount(){window.removeEventListener("resize",this.resize)},shouldComponentUpdate:function shouldComponentUpdate(nextProps){return nextProps.totalPosts!==this.props.totalPosts||nextProps.query.endDate!==this.props.query.endDate},resize:function resize(){var scrollProps={},node=this.refs.wrapper,yearNode=this.refs.year,computedStyle=window.getComputedStyle(yearNode),margin=parseInt(computedStyle.getPropertyValue("margin-left"),10)+parseInt(computedStyle.getPropertyValue("margin-right"),10),left=parseInt(yearNode.style.left,10);scrollProps.canScrollLeft=left<0;scrollProps.canScrollRight=left>0-yearNode.scrollWidth+node.clientWidth-margin;if(this.state.canScrollLeft&&node.clientWidth>=yearNode.scrollWidth-margin){yearNode.style.left="0px"}this.setState(scrollProps)},scroll:function scroll(direction){var node=this.refs.wrapper,yearNode=this.refs.year,computedStyle=window.getComputedStyle(yearNode),margin=parseInt(computedStyle.getPropertyValue("margin-left"),10)+parseInt(computedStyle.getPropertyValue("margin-right"),10),left=parseInt(computedStyle.getPropertyValue("left"),10);if(1!==direction){direction=-1}left-=Math.ceil(direction*node.clientWidth*.8);if(left>0){left=0}else if(left<0-yearNode.scrollWidth+node.clientWidth-margin){left=0-yearNode.scrollWidth+node.clientWidth-margin}yearNode.style.left=left+"px";this.resize()},scrollLeft:function scrollLeft(){this.scroll(-1)},scrollRight:function scrollRight(){this.scroll(1)},getMonthComponents:function getMonthComponents(){var i,months=[],startDate;for(i=11;i>=0;i--){startDate=_i18nCalypso2.default.moment().subtract(i,"months").startOf("month");months.push(_react2.default.createElement(_month2.default,{key:startDate.format("YYYYMM"),startDate:startDate,streakData:this.props.streakData,max:this.props.max}))}return months},render:function render(){var _props=this.props;var siteId=_props.siteId;var query=_props.query;var leftClass=(0,_classnames2.default)("post-trends__scroll-left",{"is-active":this.state.canScrollLeft});var rightClass=(0,_classnames2.default)("post-trends__scroll-right",{"is-active":this.state.canScrollRight});return _react2.default.createElement("div",{className:"post-trends"},siteId&&_react2.default.createElement(_querySiteStats2.default,{siteId:siteId,statType:"statsStreak",query:query}),_react2.default.createElement(_sectionHeader2.default,{label:this.translate("Posting Activity")}),_react2.default.createElement(_card2.default,null,_react2.default.createElement("div",{className:leftClass,onClick:this.scrollLeft},_react2.default.createElement("span",{className:"left-arrow"})),_react2.default.createElement("div",{className:rightClass,onClick:this.scrollRight},_react2.default.createElement("span",{className:"right-arrow"})),_react2.default.createElement("div",{ref:"wrapper",className:"post-trends__wrapper"},_react2.default.createElement("div",{ref:"year",className:"post-trends__year"},this.getMonthComponents()),_react2.default.createElement("div",{className:"post-trends__key-container"},_react2.default.createElement("span",{className:"post-trends__key-label"},this.translate("Fewer Posts",{context:"Legend label in stats post trends visualization"})),_react2.default.createElement("ul",{className:"post-trends__key"},_react2.default.createElement("li",{className:"post-trends__key-day is-today"}),_react2.default.createElement("li",{className:"post-trends__key-day is-level-1"}),_react2.default.createElement("li",{className:"post-trends__key-day is-level-2"}),_react2.default.createElement("li",{className:"post-trends__key-day is-level-3"}),_react2.default.createElement("li",{className:"post-trends__key-day is-level-4"})),_react2.default.createElement("span",{className:"post-trends__key-label"},this.translate("More Posts",{context:"Legend label in stats post trends visualization"}))))))}});exports.default=(0,_reactRedux.connect)(function(state){var siteId=(0,_selectors.getSelectedSiteId)(state);var query={startDate:_i18nCalypso2.default.moment().locale("en").subtract(1,"year").startOf("month").format("YYYY-MM-DD"),endDate:_i18nCalypso2.default.moment().locale("en").endOf("month").format("YYYY-MM-DD"),max:3e3};return{streakData:(0,_selectors2.getSiteStatsPostStreakData)(state,siteId,query),max:(0,_selectors2.getSiteStatsMaxPostsByDay)(state,siteId,query),totalPosts:(0,_selectors2.getSiteStatsTotalPostsForStreakQuery)(state,siteId,query),query:query,siteId:siteId}})(PostTrends);module.exports=exports["default"]},2958:function(module,exports,__webpack_require__){"use strict";var i18n=__webpack_require__(11),React=__webpack_require__(1);var Week=__webpack_require__(2959);module.exports=React.createClass({displayName:"PostTrendsMonth",propTypes:{startDate:React.PropTypes.object.isRequired,streakData:React.PropTypes.object,max:React.PropTypes.number},getWeekComponents:function getWeekComponents(){var monthStart=i18n.moment(this.props.startDate),monthEnd=i18n.moment(monthStart).endOf("month"),weekStart=i18n.moment(monthStart).startOf("week"),weeks=[];if(0===monthStart.day()){weekStart.subtract(6,"day")}else{weekStart.add(1,"day")}do{weeks.push(React.createElement(Week,{key:weekStart.format("YYYYMMDD"),startDate:i18n.moment(weekStart),month:monthStart,streakData:this.props.streakData,max:this.props.max}));weekStart.add(1,"week")}while(weekStart.isBefore(monthEnd,"day")||weekStart.isSame(monthEnd,"day"));return weeks},render:function render(){return React.createElement("div",{className:"post-trends__month"},React.createElement("div",{key:"weeks",className:"post-trends__weeks"},this.getWeekComponents()),React.createElement("div",{key:"label",className:"post-trends__label"},this.props.startDate.format("MMM")))}})},2959:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _i18nCalypso=__webpack_require__(11);var _i18nCalypso2=_interopRequireDefault(_i18nCalypso);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _day=__webpack_require__(2956);var _day2=_interopRequireDefault(_day);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"PostTrendsWeek",propTypes:{startDate:_react.PropTypes.object.isRequired,month:_react.PropTypes.object.isRequired,max:_react.PropTypes.number,streakData:_react.PropTypes.object},getDefaultProps:function getDefaultProps(){return{streakData:{},max:0}},getDayComponents:function getDayComponents(){var days=[];var _props=this.props;var month=_props.month;var startDate=_props.startDate;var streakData=_props.streakData;var max=_props.max;for(var i=0;i<7;i++){var dayDate=_i18nCalypso2.default.moment(startDate).locale("en").add(i,"day");var postCount=streakData[dayDate.format("YYYY-MM-DD")]||0;var classNames=[];var level=Math.ceil(postCount/max*4);if(dayDate.isBefore(_i18nCalypso2.default.moment(month).startOf("month"))||dayDate.isAfter(_i18nCalypso2.default.moment(month).endOf("month"))){classNames.push("is-outside-month")}else if(dayDate.isAfter(_i18nCalypso2.default.moment().endOf("day"))){classNames.push("is-after-today")}else if(level){if(level>4){level=4}classNames.push("is-level-"+level)}days.push(_react2.default.createElement(_day2.default,{key:dayDate.format("MMDD"),className:classNames.join(" "),label:dayDate.format("L"),postCount:postCount}))}return days},render:function render(){return _react2.default.createElement("div",{className:"post-trends__week"},this.getDayComponents())}});module.exports=exports["default"]},2960:function(module,exports,__webpack_require__){"use strict";var _page=__webpack_require__(33);var _page2=_interopRequireDefault(_page);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _debug=__webpack_require__(3);var _debug2=_interopRequireDefault(_debug);var _main=__webpack_require__(166);var _main2=_interopRequireDefault(_main);var _statsNavigation=__webpack_require__(2131);var _statsNavigation2=_interopRequireDefault(_statsNavigation);var _sidebarNavigation=__webpack_require__(1656);var _sidebarNavigation2=_interopRequireDefault(_sidebarNavigation);var _statsDatePicker=__webpack_require__(1912);var _statsDatePicker2=_interopRequireDefault(_statsDatePicker);var _statsCountries=__webpack_require__(2324);var _statsCountries2=_interopRequireDefault(_statsCountries);var _statsChartTabs=__webpack_require__(2961);var _statsChartTabs2=_interopRequireDefault(_statsChartTabs);var _statsModule=__webpack_require__(2129);var _statsModule2=_interopRequireDefault(_statsModule);var _statsStrings=__webpack_require__(2132);var _statsStrings2=_interopRequireDefault(_statsStrings);var _toTitleCase=__webpack_require__(724);var _toTitleCase2=_interopRequireDefault(_toTitleCase);var _analytics=__webpack_require__(20);var _analytics2=_interopRequireDefault(_analytics);var _statsFirstView=__webpack_require__(1850);var _statsFirstView2=_interopRequireDefault(_statsFirstView);var _config=__webpack_require__(12);var _config2=_interopRequireDefault(_config);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var debug=(0,_debug2.default)("calypso:stats:site");module.exports=_react2.default.createClass({displayName:"StatsSite",getInitialState:function getInitialState(){var scrollPosition=this.props.context.state.scrollPosition||0;return{date:this.props.date,chartDate:this.props.date,chartTab:this.props.chartTab,tabSwitched:false,period:this.props.period.period,scrollPosition:scrollPosition}},componentWillReceiveProps:function componentWillReceiveProps(nextProps){var newDate=this.moment(nextProps.date);var newState={date:newDate,chartDate:newDate};if(!this.state.tabSwitched||this.state.period!==nextProps.period.period){newState.chartTab=nextProps.chartTab;newState.period=nextProps.period.period;newState.tabSwitched=true}this.setState(newState)},scrollTop:function scrollTop(){if(window.pageYOffset){return window.pageYOffset}return document.documentElement.clientHeight?document.documentElement.scrollTop:document.body.scrollTop},componentDidMount:function componentDidMount(){var scrollPosition=this.state.scrollPosition;setTimeout(function(){window.scrollTo(0,scrollPosition)})},updateScrollPosition:function updateScrollPosition(){this.props.context.state.scrollPosition=this.scrollTop();this.props.context.save()},chartBarClick:function chartBarClick(bar){_page2.default.redirect(this.props.path+"?startDate="+bar.period)},barClick:function barClick(bar){_analytics2.default.ga.recordEvent("Stats","Clicked Chart Bar");_page2.default.redirect(this.props.path+"?startDate="+bar.data.period)},switchChart:function switchChart(tab){if(!tab.loading&&tab.attr!==this.state.chartTab){_analytics2.default.ga.recordEvent("Stats","Clicked "+(0,_toTitleCase2.default)(tab.attr)+" Tab");this.setState({chartTab:tab.attr,tabSwitched:true})}},render:function render(){var site=this.props.sites.getSite(this.props.siteId);var charts=this.props.charts();var queryDate=this.props.date.format("YYYY-MM-DD");var period=this.props.period.period;var moduleStrings=(0,_statsStrings2.default)();var nonPeriodicModules=void 0;var videoList=void 0;var podcastList=void 0;debug("Rendering site stats component",this.props);if(site){if(!site.jetpack){videoList=_react2.default.createElement(_statsModule2.default,{path:"videoplays",moduleStrings:moduleStrings.videoplays,site:site,dataList:this.props.videoPlaysList,period:this.props.period,date:queryDate,beforeNavigate:this.updateScrollPosition})}if(_config2.default.isEnabled("manage/stats/podcasts")&&site.options.podcasting_archive){podcastList=_react2.default.createElement(_statsModule2.default,{path:"podcastdownloads",moduleStrings:moduleStrings.podcastdownloads,site:site,dataList:this.props.podcastDownloadsList,period:this.props.period,date:queryDate,beforeNavigate:this.updateScrollPosition})}}return _react2.default.createElement(_main2.default,null,_react2.default.createElement(_statsFirstView2.default,null),_react2.default.createElement(_sidebarNavigation2.default,null),_react2.default.createElement(_statsNavigation2.default,{section:period,site:site}),_react2.default.createElement("div",{id:"my-stats-content"},_react2.default.createElement(_statsChartTabs2.default,{visitsList:this.props.visitsList,activeTabVisitsList:this.props.activeTabVisitsList,barClick:this.barClick,switchTab:this.switchChart,charts:charts,queryDate:queryDate,period:this.props.period,chartTab:this.state.chartTab}),_react2.default.createElement(_statsDatePicker2.default,{period:period,date:this.state.chartDate}),_react2.default.createElement("div",{className:"stats__module-list is-events"},_react2.default.createElement("div",{className:"stats__module-column"},_react2.default.createElement(_statsModule2.default,{path:"posts",moduleStrings:moduleStrings.posts,site:site,dataList:this.props.postsPagesList,period:this.props.period,date:queryDate,beforeNavigate:this.updateScrollPosition}),_react2.default.createElement(_statsModule2.default,{path:"referrers",moduleStrings:moduleStrings.referrers,site:site,dataList:this.props.referrersList,period:this.props.period,date:queryDate,beforeNavigate:this.updateScrollPosition}),_react2.default.createElement(_statsModule2.default,{path:"clicks",moduleStrings:moduleStrings.clicks,site:site,dataList:this.props.clicksList,period:this.props.period,date:queryDate,beforeNavigate:this.updateScrollPosition}),_react2.default.createElement(_statsModule2.default,{path:"authors",moduleStrings:moduleStrings.authors,site:site,dataList:this.props.authorsList,period:this.props.period,date:queryDate,followList:this.props.followList,className:"stats__author-views",beforeNavigate:this.updateScrollPosition})),_react2.default.createElement("div",{className:"stats__module-column"},_react2.default.createElement(_statsCountries2.default,{path:"countries",site:site,dataList:this.props.countriesList,period:this.props.period,date:queryDate}),_react2.default.createElement(_statsModule2.default,{path:"searchterms",moduleStrings:moduleStrings.search,site:site,dataList:this.props.searchTermsList,period:this.props.period,date:queryDate,beforeNavigate:this.updateScrollPosition}),videoList,podcastList)),nonPeriodicModules))}})},2961:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _find2=__webpack_require__(27);var _find3=_interopRequireDefault(_find2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _chart=__webpack_require__(2220);var _chart2=_interopRequireDefault(_chart);var _legend=__webpack_require__(2481);
var _legend2=_interopRequireDefault(_legend);var _statsTabs=__webpack_require__(1851);var _statsTabs2=_interopRequireDefault(_statsTabs);var _analytics=__webpack_require__(20);var _analytics2=_interopRequireDefault(_analytics);var _dataObserve=__webpack_require__(131);var _dataObserve2=_interopRequireDefault(_dataObserve);var _placeholder=__webpack_require__(1729);var _placeholder2=_interopRequireDefault(_placeholder);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatModuleChartTabs",mixins:[(0,_dataObserve2.default)("visitsList","activeTabVisitsList")],getInitialState:function getInitialState(){var activeTab=this.getActiveTab(),activeCharts=activeTab.legendOptions?activeTab.legendOptions.slice():[];return{activeLegendCharts:activeCharts,activeTab:activeTab}},componentWillReceiveProps:function componentWillReceiveProps(nextProps){var activeTab=this.getActiveTab(nextProps),activeCharts=activeTab.legendOptions?activeTab.legendOptions.slice():[];if(activeTab!==this.state.activeTab){this.setState({activeLegendCharts:activeCharts,activeTab:activeTab})}},buildTooltipData:function buildTooltipData(item){var tooltipData=[],date=this.moment(item.data.period),dateLabel;switch(this.props.period.period){case"day":dateLabel=date.format("LL");break;case"week":dateLabel=date.format("L")+" - "+date.add(6,"days").format("L");break;case"month":dateLabel=date.format("MMMM YYYY");break;case"year":dateLabel=date.format("YYYY");break}tooltipData.push({label:dateLabel,className:"is-date-label",value:null});switch(this.props.chartTab){case"comments":tooltipData.push({label:this.translate("Comments"),value:this.numberFormat(item.value),className:"is-comments",icon:"comment"});break;case"likes":tooltipData.push({label:this.translate("Likes"),value:this.numberFormat(item.value),className:"is-likes",icon:"star"});break;default:tooltipData.push({label:this.translate("Views"),value:this.numberFormat(item.data.views),className:"is-views",icon:"visible"});tooltipData.push({label:this.translate("Visitors"),value:this.numberFormat(item.data.visitors),className:"is-visitors",icon:"user"});tooltipData.push({label:this.translate("Views Per Visitor"),value:this.numberFormat(item.data.views/item.data.visitors,{decimals:2}),className:"is-views-per-visitor",icon:"chevron-right"});if(item.data.post_titles&&item.data.post_titles.length){if(item.data.post_titles.length>2){tooltipData.push({label:this.translate("Posts Published"),value:this.numberFormat(item.data.post_titles.length),className:"is-published-nolist",icon:"posts"})}else{tooltipData.push({label:this.translate("Post Published","Posts Published",{textOnly:true,count:item.data.post_titles.length})+":",className:"is-published",icon:"posts",value:""});item.data.post_titles.forEach(function(post_title){tooltipData.push({className:"is-published-item",label:post_title})})}}break}return tooltipData},onLegendClick:function onLegendClick(chartItem){var activeLegendCharts=this.state.activeLegendCharts,chartIndex=activeLegendCharts.indexOf(chartItem),gaEvent="Toggled Nested Chart "+chartItem,gaEventAction;if(-1===chartIndex){activeLegendCharts.push(chartItem);gaEventAction=" on"}else{activeLegendCharts.splice(chartIndex);gaEventAction=" off"}_analytics2.default.ga.recordEvent("Stats",gaEvent+gaEventAction);this.setState({activeLegendCharts:activeLegendCharts})},getActiveTab:function getActiveTab(nextProps){var props=nextProps||this.props;return(0,_find3.default)(props.charts,{attr:props.chartTab})||props.charts[0]},buildChartData:function buildChartData(){var chartData,labelKey,dataList="visitsList",activeTab=this.props.chartTab;labelKey="label"+this.props.period.period.charAt(0).toUpperCase()+this.props.period.period.slice(1);if(this.props.visitsList.isLoading()){dataList="activeTabVisitsList"}chartData=this.props[dataList].response.data.map(function(record){var chartDataItem,recordClassName,className,nestedValue;if(record.classNames&&record.classNames.length){recordClassName=record.classNames.join(" ")}if(this.state.activeLegendCharts.length){nestedValue=record[this.state.activeLegendCharts[0]]}className=(0,_classnames2.default)(recordClassName,{"is-selected":record.period===this.props.queryDate});chartDataItem={label:record[labelKey],value:record[activeTab],nestedValue:nestedValue,className:className,data:record};chartDataItem.tooltipData=this.buildTooltipData(chartDataItem);return chartDataItem},this);return chartData},render:function render(){var data=this.buildChartData(),activeTab=this.getActiveTab(),visitsList=this.props.visitsList,availableCharts=[],activeTabLoading=this.props.activeTabVisitsList.isLoading()&&this.props.visitsList.isLoading(),classes;classes=["stats-module","is-chart-tabs",{"is-loading":activeTabLoading}];if(visitsList.isLoading()){visitsList=this.props.activeTabVisitsList}if(activeTab.legendOptions){availableCharts=activeTab.legendOptions}return _react2.default.createElement("div",null,_react2.default.createElement(_card2.default,{className:_classnames2.default.apply(null,classes)},_react2.default.createElement(_legend2.default,{tabs:this.props.charts,activeTab:activeTab,availableCharts:availableCharts,activeCharts:this.state.activeLegendCharts,clickHandler:this.onLegendClick}),_react2.default.createElement(_placeholder2.default,{className:"is-chart",isLoading:activeTabLoading}),_react2.default.createElement(_chart2.default,{loading:activeTabLoading,data:data,barClick:this.props.barClick}),_react2.default.createElement(_statsTabs2.default,{dataList:visitsList,tabs:this.props.charts,switchTab:this.props.switchTab,selectedTab:this.props.chartTab,activeIndex:this.props.queryDate,activeKey:"period"})))}});module.exports=exports["default"]},2962:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _dataObserve=__webpack_require__(131);var _dataObserve2=_interopRequireDefault(_dataObserve);var _statsList=__webpack_require__(1817);var _statsList2=_interopRequireDefault(_statsList);var _legend=__webpack_require__(1818);var _legend2=_interopRequireDefault(_legend);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsCommentTab",mixins:[(0,_dataObserve2.default)("dataList")],propTypes:{dataList:_react.PropTypes.object,dataKey:_react.PropTypes.string,followList:_react.PropTypes.object,name:_react.PropTypes.string,value:_react.PropTypes.string,label:_react.PropTypes.string,isActive:_react.PropTypes.bool},render:function render(){var _props=this.props;var dataList=_props.dataList;var dataKey=_props.dataKey;var followList=_props.followList;var isActive=_props.isActive;var name=_props.name;var value=_props.value;var label=_props.label;var statsList=void 0;if(dataList.response.data&&dataList.response.data[dataKey]){statsList=_react2.default.createElement(_statsList2.default,{moduleName:name,data:dataList.response.data[dataKey],followList:followList})}var classes=(0,_classnames2.default)("stats-comments__tab-content",{"is-active":isActive});return _react2.default.createElement("div",{className:classes},_react2.default.createElement(_legend2.default,{value:value,label:label}),statsList)}});module.exports=exports["default"]},2963:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _dataObserve=__webpack_require__(131);var _dataObserve2=_interopRequireDefault(_dataObserve);var _analytics=__webpack_require__(20);var _analytics2=_interopRequireDefault(_analytics);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _commentTab=__webpack_require__(2962);var _commentTab2=_interopRequireDefault(_commentTab);var _statsError=__webpack_require__(1849);var _statsError2=_interopRequireDefault(_statsError);var _placeholder=__webpack_require__(1729);var _placeholder2=_interopRequireDefault(_placeholder);var _contentText=__webpack_require__(2128);var _contentText2=_interopRequireDefault(_contentText);var _selectDropdown=__webpack_require__(2130);var _selectDropdown2=_interopRequireDefault(_selectDropdown);var _sectionHeader=__webpack_require__(1644);var _sectionHeader2=_interopRequireDefault(_sectionHeader);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsComments",propTypes:{site:_react.PropTypes.oneOfType([_react.PropTypes.object,_react.PropTypes.bool]),commentsList:_react.PropTypes.object,commentFollowersList:_react.PropTypes.object},mixins:[(0,_dataObserve2.default)("commentsList","commentFollowersList")],data:function data(nextProps){var props=nextProps||this.props;return props.commentsList.response.data.authors},getInitialState:function getInitialState(){return{activeFilter:"top-authors",noData:this.props.commentsList.isEmpty("authors"),showInfo:false,showModule:true}},componentWillReceiveProps:function componentWillReceiveProps(nextProps){this.setState({noData:nextProps.commentsList.isEmpty("authors")})},changeFilter:function changeFilter(selection){var gaEvent=void 0;var filter=selection.value;if(filter!==this.state.activeFilter){switch(filter){case"top-authors":gaEvent="Clicked By Authors Comments Toggle";break;case"top-content":gaEvent="Clicked By Posts & Pages Comments Toggle";break}if(gaEvent){_analytics2.default.ga.recordEvent("Stats",gaEvent)}this.setState({activeFilter:filter})}},updateHeaderState:function updateHeaderState(options){this.setState(options)},renderCommentFollowers:function renderCommentFollowers(){var _props=this.props;var commentFollowersList=_props.commentFollowersList;var site=_props.site;if(!site||!commentFollowersList.response.data||!commentFollowersList.response.data.total){return null}var commentFollowURL="/stats/follows/comment/"+site.slug;return _react2.default.createElement(_contentText2.default,{className:"module-content-text-stat"},_react2.default.createElement("p",null,this.translate("Total posts with comment followers:")," ",_react2.default.createElement("a",{href:commentFollowURL},this.numberFormat(commentFollowersList.response.data.total))))},renderSummary:function renderSummary(){var data=this.data();if(!data||!data.monthly_comments){return null}return _react2.default.createElement(_contentText2.default,null,_react2.default.createElement("p",null,this.translate("Average comments per month:")," ",this.numberFormat(data.monthly_comments)))},render:function render(){var activeFilter=this.state.activeFilter;var _props2=this.props;var commentsList=_props2.commentsList;var followList=_props2.followList;var hasError=commentsList.isError();var noData=commentsList.isEmpty("authors");var data=this.data();var selectOptions=[{value:"top-authors",label:this.translate("Comments By Authors")},{value:"top-content",label:this.translate("Comments By Posts & Pages")}];var classes=(0,_classnames2.default)("stats-module",{"is-loading":!data,"has-no-data":noData,"is-showing-error":hasError||noData});return _react2.default.createElement("div",null,_react2.default.createElement(_sectionHeader2.default,{label:this.translate("Comments")}),_react2.default.createElement(_card2.default,{className:classes},_react2.default.createElement("div",{className:"module-content"},noData&&!hasError?_react2.default.createElement(_statsError2.default,{className:"is-empty-message",message:this.translate("No comments posted")}):null,_react2.default.createElement(_selectDropdown2.default,{options:selectOptions,onSelect:this.changeFilter}),this.renderCommentFollowers(),hasError?_react2.default.createElement(_statsError2.default,{className:"network-error"}):null,_react2.default.createElement(_commentTab2.default,{name:"Top Commenters",value:this.translate("Comments"),label:this.translate("Author"),dataList:commentsList,dataKey:"authors",followList:followList,isActive:"top-authors"===activeFilter}),_react2.default.createElement(_commentTab2.default,{name:"Most Commented",value:this.translate("Comments"),label:this.translate("Title"),dataList:commentsList,dataKey:"posts",followList:followList,isActive:"top-content"===activeFilter}),this.renderSummary,_react2.default.createElement(_placeholder2.default,{isLoading:!data}))))}});module.exports=exports["default"]},2964:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _keys=__webpack_require__(39);var _keys2=_interopRequireDefault(_keys);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _mixinToggle=__webpack_require__(2323);var _mixinToggle2=_interopRequireDefault(_mixinToggle);var _dataObserve=__webpack_require__(131);var _dataObserve2=_interopRequireDefault(_dataObserve);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _gridicon=__webpack_require__(26);var _gridicon2=_interopRequireDefault(_gridicon);var _placeholder=__webpack_require__(1729);var _placeholder2=_interopRequireDefault(_placeholder);var _contentText=__webpack_require__(2128);var _contentText2=_interopRequireDefault(_contentText);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsPostDetailMonths",propTypes:{postViewsList:_react.PropTypes.object},mixins:[(0,_mixinToggle2.default)("PostMonth"),(0,_dataObserve2.default)("postViewsList")],getInitialState:function getInitialState(){return{noData:this.props.postViewsList.isEmpty()}},componentWillReceiveProps:function componentWillReceiveProps(nextProps){this.setState({noData:nextProps.postViewsList.isEmpty()})},render:function render(){var _props=this.props;var title=_props.title;var total=_props.total;var dataKey=_props.dataKey;var postViewsList=_props.postViewsList;var _state=this.state;var showInfo=_state.showInfo;var noData=_state.noData;var data=postViewsList.response;var infoIcon=showInfo?"info":"info-outline";var isLoading=postViewsList.isLoading();var classes={"is-loading":isLoading,"is-showing-info":showInfo,"has-no-data":noData};var tableHeader=void 0;var tableRows=void 0;var tableBody=void 0;var highest=void 0;if(data&&data[dataKey]){tableHeader=_react2.default.createElement("thead",null,_react2.default.createElement("tr",{className:"top"},_react2.default.createElement("th",{className:"spacer"},"0000"),_react2.default.createElement("th",null,this.translate("Jan")),_react2.default.createElement("th",null,this.translate("Feb")),_react2.default.createElement("th",null,this.translate("Mar")),_react2.default.createElement("th",null,this.translate("Apr")),_react2.default.createElement("th",null,this.translate("May")),_react2.default.createElement("th",null,this.translate("Jun")),_react2.default.createElement("th",null,this.translate("Jul")),_react2.default.createElement("th",null,this.translate("Aug")),_react2.default.createElement("th",null,this.translate("Sep")),_react2.default.createElement("th",null,this.translate("Oct")),_react2.default.createElement("th",null,this.translate("Nov")),_react2.default.createElement("th",null,this.translate("Dec")),_react2.default.createElement("th",null,total)));highest="years"===dataKey?data.highest_month:data.highest_day_average;tableRows=(0,_keys2.default)(data[dataKey]).map(function(i){var year=data[dataKey][i];var cells=[];cells.push(_react2.default.createElement("th",{key:"header"+i},i));for(var j=1;j<=12;j++){var hasData=year.months[j]||0===year.months[j];var cellClass=(0,_classnames2.default)({"highest-count":0!==highest&&year.months[j]===highest,"has-no-data":!hasData});if(hasData){cells.push(_react2.default.createElement("td",{className:cellClass,key:"y"+i+"m"+j},_react2.default.createElement("span",{className:"value"},this.numberFormat(year.months[j]))))}else{cells.push(_react2.default.createElement("td",{className:cellClass,key:"y"+i+"m"+j}))}}cells.push(_react2.default.createElement("td",{key:"total"+i},this.numberFormat("years"===dataKey?year.total:year.overall)));return _react2.default.createElement("tr",{key:i},cells)},this);tableBody=_react2.default.createElement("tbody",null,tableRows)}return _react2.default.createElement(_card2.default,{className:(0,_classnames2.default)("stats-module","is-expanded","is-post-months",classes)},_react2.default.createElement("div",{className:"module-header"},_react2.default.createElement("h4",{className:"module-header-title"},title),_react2.default.createElement("ul",{className:"module-header-actions"},_react2.default.createElement("li",{className:"module-header-action toggle-info"},_react2.default.createElement("a",{href:"#",className:"module-header-action-link","aria-label":this.translate("Show or hide panel information",{context:"Stats panel action"}),title:this.translate("Show or hide panel information",{context:"Stats panel action"}),onClick:this.toggleInfo},infoIcon?_react2.default.createElement(_gridicon2.default,{icon:infoIcon}):null)))),_react2.default.createElement(_contentText2.default,{className:"module-content-text-info"},_react2.default.createElement("p",null,this.translate("This table gives you an overview of how many views your post or page has received.",{context:"Info box description for post stats page in Stats"})),_react2.default.createElement("span",{className:"legend achievement"},this.translate("%(value)s = The all-time highest value",{args:{value:this.numberFormat(highest)},context:"Legend for post stats page in Stats"}))),_react2.default.createElement(_placeholder2.default,{isLoading:isLoading}),_react2.default.createElement("div",{className:"module-content-table"},_react2.default.createElement("div",{className:"module-content-table-scroll"},_react2.default.createElement("table",{cellPadding:"0",cellSpacing:"0"},tableHeader,tableBody))))}});module.exports=exports["default"]},2965:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _dataObserve=__webpack_require__(131);var _dataObserve2=_interopRequireDefault(_dataObserve);var _mixinToggle=__webpack_require__(2323);var _mixinToggle2=_interopRequireDefault(_mixinToggle);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _gridicon=__webpack_require__(26);var _gridicon2=_interopRequireDefault(_gridicon);var _placeholder=__webpack_require__(1729);var _placeholder2=_interopRequireDefault(_placeholder);var _contentText=__webpack_require__(2128);var _contentText2=_interopRequireDefault(_contentText);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsPostDetailWeeks",mixins:[(0,_mixinToggle2.default)("PostWeek"),(0,_dataObserve2.default)("site","postViewsList")],propTypes:{postViewsList:_react.PropTypes.object},getInitialState:function getInitialState(){return{noData:this.props.postViewsList.isEmpty()}},componentWillReceiveProps:function componentWillReceiveProps(nextProps){this.setState({noData:nextProps.postViewsList.isEmpty()})},render:function render(){var _this=this;var data=this.props.postViewsList.response;var post=data.post;var _state=this.state;var showInfo=_state.showInfo;var noData=_state.noData;var infoIcon=this.state.showInfo?"info":"info-outline";var isLoading=this.props.postViewsList.isLoading();var tableHeader=void 0,tableRows=void 0,tableBody=void 0,highest=void 0;var classes={"is-loading":isLoading,"is-showing-info":showInfo,"has-no-data":noData};if(data&&data.weeks){(function(){var publishDate=post.post_date?_this.moment(post.post_date):null;highest=data.highest_week_average;tableHeader=_react2.default.createElement("thead",null,_react2.default.createElement("tr",{className:"top"},_react2.default.createElement("th",null,_this.translate("Mon")),_react2.default.createElement("th",null,_this.translate("Tue")),_react2.default.createElement("th",null,_this.translate("Wed")),_react2.default.createElement("th",null,_this.translate("Thu")),_react2.default.createElement("th",null,_this.translate("Fri")),_react2.default.createElement("th",null,_this.translate("Sat")),_react2.default.createElement("th",null,_this.translate("Sun")),_react2.default.createElement("th",null,_this.translate("Total")),_react2.default.createElement("th",null,_this.translate("Average"))));tableRows=data.weeks.map(function(week,index){var cells=[];var iconType=void 0;var lastDay=week.days[week.days.length-1];var lastDayOfWeek=lastDay.day?this.moment(lastDay.day,"YYYY-MM-DD"):null;if(7===week.days.length&&publishDate&&lastDayOfWeek&&lastDayOfWeek.isBefore(publishDate)){return null}if(week.days.length<7&&0===index){for(var j=0;j<7-week.days.length;j++){cells.push(_react2.default.createElement("td",{key:"w0e"+j}))}}var dayCells=week.days.map(function(event,dayIndex){var day=this.moment(event.day,"YYYY-MM-DD"),cellClass=(0,_classnames2.default)({"highest-count":0!==highest&&event.count===highest});return _react2.default.createElement("td",{key:dayIndex,className:cellClass},_react2.default.createElement("span",{className:"stats-detail-weeks__date"},day.format("MMM D")),_react2.default.createElement("span",{className:"stats-detail-weeks__value"},this.numberFormat(event.count)))},this);cells=cells.concat(dayCells);if(week.days.length<7&&0!==index){for(var _j=0;_j<7-week.days.length;_j++){cells.push(_react2.default.createElement("td",{key:"w"+index+"e"+_j}))}}cells.push(_react2.default.createElement("td",{key:"total"+index},this.numberFormat(week.total)));if("number"===typeof week.change){var changeClass=(0,_classnames2.default)({"is-rising":week.change>0,"is-falling":week.change<0,"is-same":week.change===0});var displayValue=this.numberFormat(week.change,2)+"%";if(week.change>0){iconType="arrow-up"}if(week.change<0){iconType="arrow-down"}if(week.change===0){displayValue=this.translate("No change",{context:"Stats: No change in stats value from prior period"})}cells.push(_react2.default.createElement("td",{key:"average"+index},this.numberFormat(week.average),_react2.default.createElement("span",{className:"stats-detail-weeks__value "+changeClass,key:"change"+index},iconType?_react2.default.createElement(_gridicon2.default,{icon:iconType,size:18}):null,displayValue)))}else{cells.push(_react2.default.createElement("td",{className:"no-data",key:"change"+index}))}return _react2.default.createElement("tr",{key:index},cells)},_this);tableBody=_react2.default.createElement("tbody",null,tableRows)})()}return _react2.default.createElement(_card2.default,{className:(0,_classnames2.default)("stats-module","is-expanded","is-post-weeks",classes)},_react2.default.createElement("div",{className:"module-header"},_react2.default.createElement("h4",{className:"module-header-title"},this.translate("Recent Weeks")),_react2.default.createElement("ul",{className:"module-header-actions"},_react2.default.createElement("li",{className:"module-header-action toggle-info"},_react2.default.createElement("a",{href:"#",className:"module-header-action-link","aria-label":this.translate("Show or hide panel information",{textOnly:true,context:"Stats panel action"}),title:this.translate("Show or hide panel information",{textOnly:true,context:"Stats panel action"}),onClick:this.toggleInfo},_react2.default.createElement(_gridicon2.default,{icon:infoIcon}))))),_react2.default.createElement(_contentText2.default,{className:"module-content-text-info"},_react2.default.createElement("p",null,this.translate("This table gives you an overview of how many views your post or page has received in the recent weeks.")),_react2.default.createElement("span",{className:"legend achievement"},this.translate("%(value)s = The highest recent value",{args:{value:this.numberFormat(highest)},context:"Legend for post stats page in Stats"}))),_react2.default.createElement(_placeholder2.default,{isLoading:isLoading}),_react2.default.createElement("div",{className:"module-content-table"},_react2.default.createElement("div",{className:"module-content-table-scroll"},_react2.default.createElement("table",{cellPadding:"0",cellSpacing:"0"},tableHeader,tableBody))))}});module.exports=exports["default"]},2966:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),classNames=__webpack_require__(10);var StatsList=__webpack_require__(1817),StatsListLegend=__webpack_require__(1818),StatsModuleSelectDropdown=__webpack_require__(2130),StatsModulePlaceholder=__webpack_require__(1729),ErrorPanel=__webpack_require__(1849),Pagination=__webpack_require__(2953),analytics=__webpack_require__(20),Card=__webpack_require__(89),SectionHeader=__webpack_require__(1644),Button=__webpack_require__(69);module.exports=React.createClass({displayName:"StatModuleFollowersPage",data:function data(nextProps){var props=nextProps||this.props;return props.followersList.response.data},getInitialState:function getInitialState(){return{activeFilter:"wpcom-followers",noData:this.props.followersList.isEmpty("subscribers")}},componentWillReceiveProps:function componentWillReceiveProps(nextProps){this.setState({noData:nextProps.followersList.isEmpty("subscribers")})},filterSelect:function filterSelect(){var selectFilter,options=[{value:"wpcom",label:this.translate("WordPress.com Followers")},{value:"email",label:this.translate("Email Followers")}];if("comment"!==this.props.followType){selectFilter=React.createElement(StatsModuleSelectDropdown,{options:options,onSelect:this.props.changeFilter})}return selectFilter},recordDownloadClick:function recordDownloadClick(){analytics.ga.recordEvent("Stats","Clicked Download Email Followers CSV link")},render:function render(){var data=this.data(),hasError=this.props.followersList.isError(),noData=this.props.followersList.isEmpty("subscribers"),isLoading=this.props.followersList.isLoading(),followers,labelLegend,valueLegend,pagination,paginationSummary,startIndex,endIndex,emailExportUrl,itemType,classes;classes=["stats-module","summary","is-followers-page",{"is-loading":isLoading,"has-no-data":noData,"is-showing-error":hasError||noData}];switch(this.props.followType){case"comment":itemType=this.translate("Comments");break;case"email":itemType=this.translate("Email");break;case"wpcom":itemType=this.translate("WordPress.com");break}if(data.total){startIndex=this.props.perPage*(this.props.page-1)+1;endIndex=this.props.perPage*this.props.page;if(endIndex>data.total){endIndex=data.total}paginationSummary=this.translate("Showing %(startIndex)s - %(endIndex)s of %(total)s %(itemType)s followers",{context:"pagination",comment:'"Showing [start index] - [end index] of [total] [item]" Example: Showing 21 - 40 of 300 WordPress.com followers',args:{startIndex:this.numberFormat(startIndex),endIndex:this.numberFormat(endIndex),total:this.numberFormat(data.total),itemType:itemType}});paginationSummary=React.createElement("div",{className:"module-content-text module-content-text-stat"},React.createElement("p",null,paginationSummary))}pagination=React.createElement(Pagination,{page:this.props.page,perPage:this.props.perPage,total:data.total,pageClick:this.props.pageClick});if(data&&data.posts){followers=React.createElement(StatsList,{data:data.posts,moduleName:"Followers"});labelLegend=this.translate("Post",{context:"noun"});valueLegend=this.translate("Followers")}else if(data&&data.subscribers){followers=React.createElement(StatsList,{data:data.subscribers,followList:this.props.followList,moduleName:"Followers"});labelLegend=this.translate("Follower");valueLegend=this.translate("Since")}if("email"===this.props.followType){emailExportUrl="https://dashboard.wordpress.com/wp-admin/index.php?page=stats&blog="+this.props.site.ID+"&blog_subscribers=csv&type=email"}return React.createElement("div",{className:"followers"},React.createElement(SectionHeader,{label:this.translate("Followers")},emailExportUrl?React.createElement(Button,{compact:true,href:emailExportUrl},this.translate("Download Data as CSV")):null),React.createElement(Card,{className:classNames(classes)},React.createElement("div",{className:"module-content"},this.filterSelect(),noData&&!hasError?React.createElement(ErrorPanel,{className:"is-empty-message",message:this.translate("No followers")}):null,paginationSummary,pagination,React.createElement(StatsListLegend,{value:valueLegend,label:labelLegend}),followers,hasError?React.createElement(ErrorPanel,{className:"network-error"}):null,React.createElement(StatsModulePlaceholder,{isLoading:isLoading}),pagination)))}})},2967:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),classNames=__webpack_require__(10);var StatsListLegend=__webpack_require__(1818),StatsModuleSelectDropdown=__webpack_require__(2130),StatsModulePlaceholder=__webpack_require__(1729),StatsList=__webpack_require__(1817),observe=__webpack_require__(131),ErrorPanel=__webpack_require__(1849),analytics=__webpack_require__(20),Card=__webpack_require__(89),SectionHeader=__webpack_require__(1644);module.exports=React.createClass({displayName:"StatModuleFollowers",mixins:[observe("wpcomFollowersList","emailFollowersList")],data:function data(list){if(list&&this.props[list]){return this.props[list].response.data}},getInitialState:function getInitialState(){return{activeFilter:"wpcom-followers",noData:this.props.wpcomFollowersList.isEmpty("subscribers")&&this.props.emailFollowersList.isEmpty("subscribers")}},componentWillReceiveProps:function componentWillReceiveProps(nextProps){this.setState({noData:nextProps.wpcomFollowersList.isEmpty("subscribers")&&nextProps.emailFollowersList.isEmpty("subscribers")})},changeFilter:function changeFilter(selection){var gaEvent,filter=selection.value;if(filter!==this.state.activeFilter){switch(filter){case"wpcom-followers":gaEvent="Clicked By WordPress.com Followers Toggle";break;case"email-followers":gaEvent="Clicked Email Followers Toggle";break}if(gaEvent){analytics.ga.recordEvent("Stats",gaEvent)}this.setState({activeFilter:filter})}},filterSelect:function filterSelect(){var selectFilter,options=[{value:"wpcom-followers",label:this.translate("WordPress.com Followers")},{value:"email-followers",label:this.translate("Email Followers")}];if(!this.props.wpcomFollowersList.isEmpty("subscribers")&&!this.props.emailFollowersList.isEmpty("subscribers")){selectFilter=React.createElement(StatsModuleSelectDropdown,{options:options,onSelect:this.changeFilter})}return selectFilter},render:function render(){var wpcomData=this.data("wpcomFollowersList"),emailData=this.data("emailFollowersList"),noData=this.props.wpcomFollowersList.isEmpty("subscribers")&&this.props.emailFollowersList.isEmpty("subscribers"),hasError=this.props.wpcomFollowersList.isError()||this.props.emailFollowersList.isError(),isLoading=this.props.wpcomFollowersList.isLoading()||this.props.emailFollowersList.isLoading(),wpcomFollowers,emailFollowers,wpcomTotalFollowers,emailTotalFollowers,summaryPageLink,viewSummary,activeFilter,activeFilterClass,classes;activeFilter=this.state.activeFilter;if(this.props.wpcomFollowersList.isEmpty("subscribers")){activeFilter="email-followers"}activeFilterClass="tab-"+activeFilter;classes=["stats-module","is-followers",activeFilterClass,{"is-loading":isLoading,"has-no-data":noData,"is-showing-error":hasError||noData}];var summaryPageSlug=this.props.site?this.props.site.slug:"";if("email-followers"===activeFilter){summaryPageLink="/stats/follows/email/"+summaryPageSlug;
}else{summaryPageLink="/stats/follows/wpcom/"+summaryPageSlug}if(wpcomData&&wpcomData.subscribers){wpcomFollowers=React.createElement(StatsList,{moduleName:"wpcomFollowers",data:wpcomData.subscribers,followList:this.props.followList})}if(emailData&&emailData.subscribers){emailFollowers=React.createElement(StatsList,{moduleName:"EmailFollowers",data:emailData.subscribers})}if(wpcomData&&wpcomData.total){wpcomTotalFollowers=React.createElement("p",null,this.translate("Total WordPress.com Followers"),": ",this.numberFormat(wpcomData.total))}if(emailData&&emailData.total){emailTotalFollowers=React.createElement("p",null,this.translate("Total Email Followers"),": ",this.numberFormat(emailData.total))}if(wpcomData&&wpcomData.viewAll||emailData&&emailData.viewAll){viewSummary=React.createElement("div",{key:"view-all",className:"module-expand"},React.createElement("a",{href:summaryPageLink},this.translate("View All",{context:"Stats: Button label to expand a panel"}),React.createElement("span",{className:"right"})))}return React.createElement("div",null,React.createElement(SectionHeader,{label:this.translate("Followers"),href:summaryPageLink}),React.createElement(Card,{className:classNames.apply(null,classes)},React.createElement("div",{className:"followers"},React.createElement("div",{className:"module-content"},noData&&!hasError?React.createElement(ErrorPanel,{className:"is-empty-message",message:this.translate("No followers")}):null,this.filterSelect(),React.createElement("div",{className:"tab-content wpcom-followers stats-async-metabox-wrapper"},React.createElement("div",{className:"module-content-text module-content-text-stat"},wpcomTotalFollowers),React.createElement(StatsListLegend,{value:this.translate("Since"),label:this.translate("Follower")}),wpcomFollowers,this.props.wpcomFollowersList.isError()?React.createElement(ErrorPanel,{className:"is-error"}):null),React.createElement("div",{className:"tab-content email-followers stats-async-metabox-wrapper"},React.createElement("div",{className:"module-content-text module-content-text-stat"},emailTotalFollowers),React.createElement(StatsListLegend,{value:this.translate("Since"),label:this.translate("Follower")}),emailFollowers,this.props.emailFollowersList.isError()?React.createElement(ErrorPanel,{className:"network-error"}):null),React.createElement(StatsModulePlaceholder,{isLoading:isLoading})),viewSummary)))}})},2968:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _i18nCalypso=__webpack_require__(11);var _i18nCalypso2=_interopRequireDefault(_i18nCalypso);var _get=__webpack_require__(24);var _get2=_interopRequireDefault(_get);var _statsNavigation=__webpack_require__(2131);var _statsNavigation2=_interopRequireDefault(_statsNavigation);var _sidebarNavigation=__webpack_require__(1656);var _sidebarNavigation2=_interopRequireDefault(_sidebarNavigation);var _allTime=__webpack_require__(2947);var _allTime2=_interopRequireDefault(_allTime);var _statsComments=__webpack_require__(2963);var _statsComments2=_interopRequireDefault(_statsComments);var _statsFollowers=__webpack_require__(2967);var _statsFollowers2=_interopRequireDefault(_statsFollowers);var _postTrends=__webpack_require__(2957);var _postTrends2=_interopRequireDefault(_postTrends);var _statsSiteOverview=__webpack_require__(2326);var _statsSiteOverview2=_interopRequireDefault(_statsSiteOverview);var _statsModule=__webpack_require__(2129);var _statsModule2=_interopRequireDefault(_statsModule);var _connectedList=__webpack_require__(2974);var _connectedList2=_interopRequireDefault(_connectedList);var _statsStrings=__webpack_require__(2132);var _statsStrings2=_interopRequireDefault(_statsStrings);var _mostPopular=__webpack_require__(2951);var _mostPopular2=_interopRequireDefault(_mostPopular);var _postPerformance=__webpack_require__(2955);var _postPerformance2=_interopRequireDefault(_postPerformance);var _domainTip=__webpack_require__(2770);var _domainTip2=_interopRequireDefault(_domainTip);var _main=__webpack_require__(166);var _main2=_interopRequireDefault(_main);var _statsFirstView=__webpack_require__(1850);var _statsFirstView2=_interopRequireDefault(_statsFirstView);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsInsights",propTypes:{commentFollowersList:_react.PropTypes.object.isRequired,commentsList:_react.PropTypes.object.isRequired,emailFollowersList:_react.PropTypes.object.isRequired,followList:_react.PropTypes.object.isRequired,site:_react2.default.PropTypes.oneOfType([_react2.default.PropTypes.bool,_react2.default.PropTypes.object]),summaryDate:_react.PropTypes.string,wpcomFollowersList:_react.PropTypes.object},render:function render(){var _props=this.props;var commentFollowersList=_props.commentFollowersList;var commentsList=_props.commentsList;var emailFollowersList=_props.emailFollowersList;var followList=_props.followList;var site=_props.site;var wpcomFollowersList=_props.wpcomFollowersList;var moduleStrings=(0,_statsStrings2.default)();var tagsList=void 0;var momentSiteZone=_i18nCalypso2.default.moment();var gmtOffset=(0,_get2.default)(site.options,"gmt_offset",null);if(gmtOffset){momentSiteZone=_i18nCalypso2.default.moment().utcOffset(gmtOffset)}var summaryDate=momentSiteZone.format("YYYY-MM-DD");if(!site.jetpack){tagsList=_react2.default.createElement(_statsModule2.default,{path:"tags-categories",moduleStrings:moduleStrings.tags,site:site,dataList:this.props.tagsList,beforeNavigate:this.updateScrollPosition})}return _react2.default.createElement(_main2.default,null,_react2.default.createElement(_statsFirstView2.default,null),_react2.default.createElement(_sidebarNavigation2.default,null),_react2.default.createElement(_statsNavigation2.default,{section:"insights",site:site}),_react2.default.createElement("div",{id:"my-stats-content"},_react2.default.createElement(_postTrends2.default,null),_react2.default.createElement(_postPerformance2.default,{site:site}),_react2.default.createElement(_statsSiteOverview2.default,{siteId:site?site.ID:0,period:"day",date:summaryDate,path:"/stats/day",title:this.translate("Today's Stats")}),_react2.default.createElement(_allTime2.default,null),_react2.default.createElement(_mostPopular2.default,null),_react2.default.createElement(_domainTip2.default,{siteId:site?site.ID:0,event:"stats_insights_domain"}),_react2.default.createElement("div",{className:"stats-insights__nonperiodic has-recent"},_react2.default.createElement("div",{className:"stats__module-list"},_react2.default.createElement("div",{className:"stats__module-column"},_react2.default.createElement(_statsComments2.default,{path:"comments",site:site,commentsList:commentsList,followList:followList,commentFollowersList:commentFollowersList}),tagsList),_react2.default.createElement("div",{className:"stats__module-column"},_react2.default.createElement(_statsFollowers2.default,{path:"followers",site:site,wpcomFollowersList:wpcomFollowersList,emailFollowersList:emailFollowersList,followList:followList}),_react2.default.createElement(_connectedList2.default,{path:"publicize",moduleStrings:moduleStrings.publicize,statType:"statsPublicize"}))))))}});module.exports=exports["default"]},2969:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),classNames=__webpack_require__(10),debug=__webpack_require__(3)("calypso:stats:action-follow");var observe=__webpack_require__(131),analytics=__webpack_require__(20),Gridicon=__webpack_require__(26);module.exports=React.createClass({displayName:"StatsActionFollow",mixins:[observe("followSite")],clickHandler:function clickHandler(event){var site=this.props.followSite,gaEvent;event.stopPropagation();event.preventDefault();debug("handling follower click",this.props.data);if(!site.is_following){gaEvent="Follow";site.follow()}else{gaEvent="Unfollow";site.unfollow()}analytics.ga.recordEvent("Stats","Clicked "+gaEvent+" in "+this.props.moduleName+" List")},render:function render(){var site=this.props.followSite,following=site.is_following,wrapperClass=classNames("module-content-list-item-action-wrapper",{follow:!following,following:following}),label=following?this.translate("Following",{context:"Stats: Follow action / Following status"}):this.translate("Follow",{context:"Stats: Follow action / Following status"}),gridiconType=following?"reader-following":"reader-follow",wrapperClassSet;wrapperClassSet=classNames(wrapperClass);return React.createElement("li",{className:"module-content-list-item-action"},React.createElement("a",{href:"#",onClick:this.clickHandler,className:wrapperClassSet,title:site.blog_domain,"aria-label":this.translate("Follow or unfollow user",{textOnly:true,context:"Stats ARIA label: Follow/Unfollow action"})},React.createElement("span",{className:"module-content-list-item-action-label"},React.createElement(Gridicon,{icon:gridiconType,size:18}),label),React.createElement("span",{className:"module-content-list-item-action-label unfollow"},React.createElement(Gridicon,{icon:"cross",size:18}),this.translate("Unfollow",{context:"Stats ARIA label: Unfollow action"}))))}})},2970:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=__webpack_require__(21);var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=__webpack_require__(8);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(9);var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=__webpack_require__(23);var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=__webpack_require__(22);var _inherits3=_interopRequireDefault(_inherits2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _i18nCalypso=__webpack_require__(11);var _analytics=__webpack_require__(20);var _analytics2=_interopRequireDefault(_analytics);var _gridicon=__webpack_require__(26);var _gridicon2=_interopRequireDefault(_gridicon);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var StatsActionLink=function(_PureComponent){(0,_inherits3.default)(StatsActionLink,_PureComponent);function StatsActionLink(props){(0,_classCallCheck3.default)(this,StatsActionLink);var _this=(0,_possibleConstructorReturn3.default)(this,(StatsActionLink.__proto__||(0,_getPrototypeOf2.default)(StatsActionLink)).call(this,props));_this.onClick=_this.onClick.bind(_this);return _this}(0,_createClass3.default)(StatsActionLink,[{key:"onClick",value:function onClick(event){event.stopPropagation();_analytics2.default.ga.recordEvent("Stats","Clicked on External Link in "+this.props.moduleName+" List Action Menu")}},{key:"render",value:function render(){var _props=this.props;var href=_props.href;var translate=_props.translate;return _react2.default.createElement("li",{className:"module-content-list-item-action"},_react2.default.createElement("a",{href:href,onClick:this.onClick,target:"_blank",rel:"noopener noreferrer",className:"module-content-list-item-action-wrapper",title:translate("View content in a new window",{textOnly:true,context:"Stats action tooltip: View content in a new window"}),"aria-label":translate("View content in a new window",{textOnly:true,context:"Stats ARIA label: View content in new window action"})},_react2.default.createElement(_gridicon2.default,{icon:"external",size:18}),_react2.default.createElement("span",{className:"module-content-list-item-action-label module-content-list-item-action-label-view"},translate("View",{context:"Stats: List item action to view content"}))))}}]);return StatsActionLink}(_react.PureComponent);StatsActionLink.propTypes={href:_react.PropTypes.string,moduleName:_react.PropTypes.string,translate:_react.PropTypes.func};exports.default=(0,_i18nCalypso.localize)(StatsActionLink);module.exports=exports["default"]},2971:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),page=__webpack_require__(33),debug=__webpack_require__(3)("calypso:stats:action-page");var analytics=__webpack_require__(20),Gridicon=__webpack_require__(26);module.exports=React.createClass({displayName:"StatsActionPage",clickHandler:function clickHandler(event){event.stopPropagation();event.preventDefault();debug("handling page click",this.props);analytics.ga.recordEvent("Stats","Clicked on Summary Link in "+this.props.moduleName+" List Action Menu");page(this.props.page)},render:function render(){return React.createElement("li",{className:"module-content-list-item-action"},React.createElement("a",{href:"#",onClick:this.clickHandler,className:"module-content-list-item-action-wrapper",title:this.translate("View in a new window",{textOnly:true,context:"Stats action tooltip: View content in a new window"}),"aria-label":this.translate("View in a new window",{textOnly:true,context:"Stats ARIA label: View content in a new window"})},React.createElement(Gridicon,{icon:"stats",size:18}),React.createElement("span",{className:"module-content-list-item-action-label"},this.translate("View",{context:"Stats: List item action to view content"}))))}})},2972:function(module,exports,__webpack_require__){"use strict";var React=__webpack_require__(1),classNames=__webpack_require__(10),debug=__webpack_require__(3)("calypso:stats:action-spam");var wpcom=__webpack_require__(28),analytics=__webpack_require__(20),Gridicon=__webpack_require__(26);module.exports=React.createClass({displayName:"StatsActionSpam",getInitialState:function getInitialState(){return{spammed:false}},clickHandler:function clickHandler(event){var spamType=this.state.spammed?"statsReferrersSpamDelete":"statsReferrersSpamNew",gaEvent=this.state.spammed?"Undid Referrer Spam":"Marked Referrer as Spam",wpcomSite;event.stopPropagation();event.preventDefault();debug(this.state);this.setState({spammed:!this.state.spammed});if(this.props.afterChange){this.props.afterChange(!this.state.spammed)}wpcomSite=wpcom.site(this.props.data.siteID);wpcomSite[spamType].call(wpcomSite,this.props.data.domain,function(){});analytics.ga.recordEvent("Stats",gaEvent+" in "+this.props.moduleName+" List")},render:function render(){var label=this.state.spammed?this.translate("Not Spam"):this.translate("Spam",{context:"Stats: Action to mark an item as spam",comment:'Default label (changes into "Not Spam").'}),title=this.state.spammed?this.translate("Not Spam",{textOnly:true,context:"Stats: Action to undo marking an item as spam",comment:'Secondary label (default label is "Spam"). Recommended to use a very short label.'}):this.translate("Spam",{textOnly:true,context:"Stats: Action to mark an item as spam",comment:'Default label (changes into "Not Spam").'}),wrapperClass=classNames("module-content-list-item-action-wrapper",{spam:!this.state.spammed,unspam:this.state.spammed});return React.createElement("li",{className:"module-content-list-item-action"},React.createElement("a",{href:"#",onClick:this.clickHandler,className:wrapperClass,title:title,"aria-label":title},React.createElement(Gridicon,{icon:"spam",size:18}),React.createElement("span",{className:"module-content-list-item-action-label"},label)))}})},2973:function(module,exports,__webpack_require__){"use strict";var _typeof2=__webpack_require__(32);var _typeof3=_interopRequireDefault(_typeof2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var React=__webpack_require__(1),classNames=__webpack_require__(10),debug=__webpack_require__(3)("calypso:stats:list-item"),page=__webpack_require__(33);var Follow=__webpack_require__(2969),Page=__webpack_require__(2971),OpenLink=__webpack_require__(2970),Spam=__webpack_require__(2972),Emojify=__webpack_require__(2044),titlecase=__webpack_require__(724),analytics=__webpack_require__(20),Gridicon=__webpack_require__(26);module.exports=React.createClass({displayName:"StatsListItem",getInitialState:function getInitialState(){return{active:this.props.active,actionMenuOpen:false,disabled:false}},addMenuListener:function addMenuListener(){document.addEventListener("click",this.closeMenu)},removeMenuListener:function removeMenuListener(){document.removeEventListener("click",this.closeMenu)},componentWillUnmount:function componentWillUnmount(){if(this.props.data.actionMenu){this.removeMenuListener()}},closeMenu:function closeMenu(){this.removeMenuListener();this.setState({actionMenuOpen:false})},actionMenuClick:function actionMenuClick(event){event.stopPropagation();event.preventDefault();if(!this.state.actionMenuOpen){this.addMenuListener();this.setState({actionMenuOpen:true})}else{this.closeMenu()}},onClick:function onClick(event){var gaEvent,moduleName=titlecase(this.props.moduleName);debug("props",this.props);if(!this.state.disabled){if(this.props.children){var moduleState=this.state.active?"Collapsed ":"Expanded ";gaEvent=moduleState+moduleName;this.setState({active:!this.state.active})}if("function"===typeof this.props.itemClickHandler){event.stopPropagation();this.props.itemClickHandler(event,this.props.data)}else{if(this.props.data.page&&!this.props.children){gaEvent=["Clicked",moduleName,"Summary Link"].join(" ");page(this.props.data.page)}else if(this.props.data.link&&!this.props.children){gaEvent=["Clicked",moduleName,"External Link"].join(" ");window.open(this.props.data.link)}else if(!this.props.children){gaEvent="Clicked on "+moduleName}}if(gaEvent){analytics.ga.recordEvent("Stats",gaEvent+" in List")}}},spamHandler:function spamHandler(isSpammed){this.setState({disabled:isSpammed})},buildActions:function buildActions(){var data=this.props.data,moduleName=titlecase(this.props.moduleName),actionMenu=data.actionMenu,actionClassSet=classNames("module-content-list-item-actions",{collapsed:actionMenu&&!this.state.disabled}),actionList;if(data.actions){var actionItems=[];data.actions.forEach(function(action){var actionItem;switch(action.type){case"follow":if(action.data&&this.props.followList){var followSite=this.props.followList.add(action.data);actionItem=React.createElement(Follow,{followSite:followSite,key:action.type,moduleName:moduleName})}break;case"page":actionItem=React.createElement(Page,{page:action.page,key:action.type,moduleName:moduleName});break;case"spam":actionItem=React.createElement(Spam,{data:action.data,key:action.type,afterChange:this.spamHandler,moduleName:moduleName});break;case"link":actionItem=React.createElement(OpenLink,{href:action.data,key:action.type,moduleName:moduleName});break}if(actionItem){actionItems.push(actionItem)}},this);if(actionItems.length>0){actionList=React.createElement("ul",{className:actionClassSet},actionItems)}}return actionList},buildLabel:function buildLabel(){var data=this.props.data,labelData=data.label,wrapperClassSet,label;if(false===labelData instanceof Array){labelData=[data]}wrapperClassSet=classNames({"module-content-list-item-label-section":labelData.length>1});label=labelData.map(function(labelItem,i){var iconClassSetOptions={avatar:true},icon,avatar,gridiconSpan;if(labelItem.labelIcon){gridiconSpan=React.createElement(Gridicon,{icon:labelItem.labelIcon})}if("icon"in labelItem){if(labelItem.iconClassName){iconClassSetOptions[labelItem.iconClassName]=true}if(labelItem.icon){avatar=React.createElement("span",{className:"icon"},React.createElement("img",{alt:"",src:labelItem.icon,width:"20",height:"20",className:classNames(iconClassSetOptions)}))}icon=avatar}return React.createElement("span",{className:wrapperClassSet,key:i},gridiconSpan,icon,React.createElement(Emojify,null,labelItem.label))},this);return label},buildValue:function buildValue(){var data=this.props.data,valueData=data.value,value;if("object"!==(typeof valueData==="undefined"?"undefined":(0,_typeof3.default)(valueData))||!valueData.type){valueData={type:"number",value:valueData}}switch(valueData.type){case"relative-date":value=this.moment(valueData.value).fromNow(true);break;default:case"number":value=this.numberFormat(valueData.value);break}return value},render:function render(){var data=this.props.data,rightClassOptions={"module-content-list-item-right":true},toggleOptions={"module-content-list-item-actions-toggle":true,show:data.actionMenu&&!this.state.disabled},actions=this.buildActions(),toggleGridicon=React.createElement(Gridicon,{icon:"chevron-down"}),toggleIcon=this.props.children?toggleGridicon:null,mobileActionToggle,groupClassOptions,groupClassName;groupClassOptions={"module-content-list-item":true,disabled:this.state.disabled,"module-content-list-item-link":this.props.children||data.link||data.page,"module-content-list-item-toggle":this.props.children,"is-expanded":this.state.active};if(data.className){groupClassOptions[data.className]=true}if(actions){mobileActionToggle=React.createElement("a",{href:"#",onClick:this.actionMenuClick,className:classNames(toggleOptions),title:this.translate("Show Actions",{context:"Label for hidden menu in a list on the Stats page."})},React.createElement(Gridicon,{icon:"ellipsis"}));rightClassOptions["is-expanded"]=this.state.actionMenuOpen}groupClassName=classNames(groupClassOptions);return React.createElement("li",{key:this.key,"data-group":this.key,className:groupClassName},React.createElement("span",{className:"module-content-list-item-wrapper",onClick:this.onClick,tabIndex:"0"},React.createElement("span",{className:classNames(rightClassOptions)},mobileActionToggle,actions,React.createElement("span",{className:"module-content-list-item-value"},data.value?this.buildValue():null)),React.createElement("span",{className:"module-content-list-item-label"},toggleIcon,this.buildLabel())),this.props.children)}})},2974:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=__webpack_require__(21);var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=__webpack_require__(8);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(9);var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=__webpack_require__(23);var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=__webpack_require__(22);var _inherits3=_interopRequireDefault(_inherits2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _reactRedux=__webpack_require__(15);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _statsError=__webpack_require__(1849);var _statsError2=_interopRequireDefault(_statsError);var _expand=__webpack_require__(2975);var _expand2=_interopRequireDefault(_expand);var _statsList=__webpack_require__(1817);var _statsList2=_interopRequireDefault(_statsList);var _legend=__webpack_require__(1818);var _legend2=_interopRequireDefault(_legend);var _statsDatePicker=__webpack_require__(1912);var _statsDatePicker2=_interopRequireDefault(_statsDatePicker);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _placeholder=__webpack_require__(1729);var _placeholder2=_interopRequireDefault(_placeholder);var _sectionHeader=__webpack_require__(1644);var _sectionHeader2=_interopRequireDefault(_sectionHeader);var _querySiteStats=__webpack_require__(1881);var _querySiteStats2=_interopRequireDefault(_querySiteStats);var _selectors=__webpack_require__(47);var _selectors2=__webpack_require__(79);var _selectors3=__webpack_require__(1863);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var StatsConnectedModule=function(_Component){(0,_inherits3.default)(StatsConnectedModule,_Component);function StatsConnectedModule(){(0,_classCallCheck3.default)(this,StatsConnectedModule);return(0,_possibleConstructorReturn3.default)(this,(StatsConnectedModule.__proto__||(0,_getPrototypeOf2.default)(StatsConnectedModule)).apply(this,arguments))}(0,_createClass3.default)(StatsConnectedModule,[{key:"getModuleLabel",value:function getModuleLabel(){if(!this.props.summary){return this.props.moduleStrings.title}return _react2.default.createElement(_statsDatePicker2.default,{period:this.props.period.period,date:this.props.period.startOf,summary:true})}},{key:"getHref",value:function getHref(){var _props=this.props;var summary=_props.summary;var period=_props.period;var path=_props.path;var siteSlug=_props.siteSlug;var date=_props.date;if(!summary&&period&&path&&siteSlug){return"/stats/"+period.period+"/"+path+"/"+siteSlug+"?startDate="+date}}},{key:"render",value:function render(){var _props2=this.props;var className=_props2.className;var summary=_props2.summary;var siteId=_props2.siteId;var path=_props2.path;var data=_props2.data;var moduleStrings=_props2.moduleStrings;var requesting=_props2.requesting;var statType=_props2.statType;var query=_props2.query;var noData=data&&!requesting&&!data.length;var isLoading=requesting&&!(data&&data.length);var hasError=false;var cardClasses=(0,_classnames2.default)("stats-module",{"is-loading":isLoading,"has-no-data":noData,"is-showing-error":noData},className);var summaryLink=this.getHref();return _react2.default.createElement("div",null,siteId&&statType&&_react2.default.createElement(_querySiteStats2.default,{statType:statType,siteId:siteId,query:query}),_react2.default.createElement(_sectionHeader2.default,{label:this.getModuleLabel(),href:!summary?summaryLink:null}),_react2.default.createElement(_card2.default,{compact:true,className:cardClasses},noData&&_react2.default.createElement(_statsError2.default,{message:moduleStrings.empty}),hasError&&_react2.default.createElement(_statsError2.default,null),_react2.default.createElement(_legend2.default,{value:moduleStrings.value,label:moduleStrings.item}),_react2.default.createElement(_placeholder2.default,{isLoading:isLoading}),_react2.default.createElement(_statsList2.default,{moduleName:path,data:data}),this.props.showSummaryLink&&_react2.default.createElement(_expand2.default,{href:summaryLink})))}}]);return StatsConnectedModule}(_react.Component);StatsConnectedModule.propTypes={summary:_react.PropTypes.bool,moduleStrings:_react.PropTypes.object,period:_react.PropTypes.object,path:_react.PropTypes.string,siteSlug:_react.PropTypes.string,siteId:_react.PropTypes.number,date:_react.PropTypes.string,data:_react.PropTypes.array,query:_react.PropTypes.object,statType:_react.PropTypes.string,showSummaryLink:_react.PropTypes.bool};StatsConnectedModule.defaultProps={showSummaryLink:false,query:{}};exports.default=(0,_reactRedux.connect)(function(state,ownProps){var siteId=(0,_selectors.getSelectedSiteId)(state);var siteSlug=(0,_selectors2.getSiteSlug)(state,siteId);var statType=ownProps.statType;var query=ownProps.query;return{requesting:(0,_selectors3.isRequestingSiteStatsForQuery)(state,siteId,statType,query),data:(0,_selectors3.getSiteStatsNormalizedData)(state,siteId,statType,query),siteId:siteId,siteSlug:siteSlug}})(StatsConnectedModule);module.exports=exports["default"]},2975:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _getPrototypeOf=__webpack_require__(21);var _getPrototypeOf2=_interopRequireDefault(_getPrototypeOf);var _classCallCheck2=__webpack_require__(8);var _classCallCheck3=_interopRequireDefault(_classCallCheck2);var _createClass2=__webpack_require__(9);var _createClass3=_interopRequireDefault(_createClass2);var _possibleConstructorReturn2=__webpack_require__(23);var _possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2);var _inherits2=__webpack_require__(22);var _inherits3=_interopRequireDefault(_inherits2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var StatsModuleExpand=function(_PureComponent){(0,_inherits3.default)(StatsModuleExpand,_PureComponent);function StatsModuleExpand(){(0,_classCallCheck3.default)(this,StatsModuleExpand);return(0,_possibleConstructorReturn3.default)(this,(StatsModuleExpand.__proto__||(0,_getPrototypeOf2.default)(StatsModuleExpand)).apply(this,arguments))}(0,_createClass3.default)(StatsModuleExpand,[{key:"render",value:function render(){if(!this.props.href){return null}return _react2.default.createElement("div",{className:"stats-module__expand"},_react2.default.createElement("a",{href:this.props.href},this.translate("View All",{context:"Stats: Button label to expand a panel"}),_react2.default.createElement("span",{className:"stats-module__expand-right"})))}}]);return StatsModuleExpand}(_react.PureComponent);StatsModuleExpand.propTypes={href:_react2.default.PropTypes.string};exports.default=StatsModuleExpand;module.exports=exports["default"]},2976:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _gridicon=__webpack_require__(26);var _gridicon2=_interopRequireDefault(_gridicon);var _analytics=__webpack_require__(20);var _analytics2=_interopRequireDefault(_analytics);var _toTitleCase=__webpack_require__(724);var _toTitleCase2=_interopRequireDefault(_toTitleCase);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsModuleHeader",propTypes:{siteId:_react.PropTypes.number,path:_react.PropTypes.string,title:_react.PropTypes.string,titleLink:_react.PropTypes.string,showInfo:_react.PropTypes.bool,showModule:_react.PropTypes.bool,isCollapsed:_react.PropTypes.bool,showActions:_react.PropTypes.bool,showCollapse:_react.PropTypes.bool,onActionClick:_react.PropTypes.func},getDefaultProps:function getDefaultProps(){return{showCollapse:true,showModule:true,showActions:true,onActionClick:function onActionClick(){}}},toggleInfo:function toggleInfo(event){event.stopPropagation();event.preventDefault();var _props=this.props;var path=_props.path;var onActionClick=_props.onActionClick;var showInfo=_props.showInfo;var gaEvent=showInfo?"Closed":"Opened";if(path){_analytics2.default.ga.recordEvent("Stats",gaEvent+" More Information Panel",(0,_toTitleCase2.default)(path))}onActionClick({showInfo:!showInfo})},toggleModule:function toggleModule(event){event.preventDefault();var _props2=this.props;var path=_props2.path;var onActionClick=_props2.onActionClick;var showModule=_props2.showModule;var gaEvent=showModule?"Collapsed":"Expanded";if(path){_analytics2.default.ga.recordEvent("Stats",gaEvent+" Module",(0,_toTitleCase2.default)(path))}onActionClick({showModule:!showModule})},renderActions:function renderActions(){var _props3=this.props;var showCollapse=_props3.showCollapse;var showInfo=_props3.showInfo;var showActions=_props3.showActions;var infoIcon=showInfo?"info":"info-outline";if(!showActions){return null}return _react2.default.createElement("ul",{className:"module-header-actions"},_react2.default.createElement("li",{className:"module-header-action toggle-info"},_react2.default.createElement("a",{href:"#",className:"module-header-action-link","aria-label":this.translate("Show or hide panel information",{context:"Stats panel action"}),title:this.translate("Show or hide panel information",{context:"Stats panel action"}),onClick:this.toggleInfo},_react2.default.createElement(_gridicon2.default,{icon:infoIcon}))),showCollapse?this.renderChevron():null)},renderChevron:function renderChevron(){return _react2.default.createElement("li",{className:"module-header-action toggle-services"},_react2.default.createElement("a",{href:"#",className:"module-header-action-link","aria-label":this.translate("Expand or collapse panel",{context:"Stats panel action"}),title:this.translate("Expand or collapse panel",{context:"Stats panel action"}),onClick:this.toggleModule},_react2.default.createElement(_gridicon2.default,{icon:"chevron-down"
})))},renderTitle:function renderTitle(){var _props4=this.props;var title=_props4.title;var titleLink=_props4.titleLink;if(titleLink){return _react2.default.createElement("h3",{className:"module-header-title"},_react2.default.createElement("a",{href:titleLink,className:"module-header__link"},_react2.default.createElement("span",{className:"module-header__right-icon"},_react2.default.createElement(_gridicon2.default,{icon:"stats"})),title))}return _react2.default.createElement("h3",{className:"module-header-title"},title)},render:function render(){return _react2.default.createElement("div",{className:"module-header"},this.renderTitle(),this.renderActions())}});module.exports=exports["default"]},2977:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);var _gridicon=__webpack_require__(26);var _gridicon2=_interopRequireDefault(_gridicon);var _statsTabs=__webpack_require__(1851);var _statsTabs2=_interopRequireDefault(_statsTabs);var _tab=__webpack_require__(1852);var _tab2=_interopRequireDefault(_tab);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsOverviewPlaceholder",propTypes:{insights:_react.PropTypes.bool},render:function render(){var icon=void 0;if(!this.props.insights){icon=_react2.default.createElement("div",{className:"module-header__site-icon"},_react2.default.createElement("img",{width:"24",height:"24"}))}return _react2.default.createElement(_card2.default,{className:"stats-module is-loading"},_react2.default.createElement("div",{className:"module-header"},_react2.default.createElement("h3",{className:"module-header-title"},_react2.default.createElement("a",{href:"#",className:"module-header__link"},icon,_react2.default.createElement("span",{className:"module-header__right-icon"},_react2.default.createElement(_gridicon2.default,{icon:"stats"})),_react2.default.createElement("span",null,this.translate("Loading Stats"))))),_react2.default.createElement(_statsTabs2.default,null,_react2.default.createElement(_tab2.default,{isLoading:true,gridicon:"visible",label:this.translate("Views",{context:"noun"}),value:null}),_react2.default.createElement(_tab2.default,{isLoading:true,gridicon:"user",label:this.translate("Visitors",{context:"noun"}),value:null}),_react2.default.createElement(_tab2.default,{isLoading:true,gridicon:"star",label:this.translate("Likes",{context:"noun"}),value:null}),_react2.default.createElement(_tab2.default,{isLoading:true,gridicon:"comment",label:this.translate("Comments",{context:"noun"}),value:null})))}});module.exports=exports["default"]},2978:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _page=__webpack_require__(33);var _page2=_interopRequireDefault(_page);var _dataObserve=__webpack_require__(131);var _dataObserve2=_interopRequireDefault(_dataObserve);var _emojify=__webpack_require__(2044);var _emojify2=_interopRequireDefault(_emojify);var _statsSummaryChart=__webpack_require__(2327);var _statsSummaryChart2=_interopRequireDefault(_statsSummaryChart);var _statsDetailMonths=__webpack_require__(2964);var _statsDetailMonths2=_interopRequireDefault(_statsDetailMonths);var _statsDetailWeeks=__webpack_require__(2965);var _statsDetailWeeks2=_interopRequireDefault(_statsDetailWeeks);var _headerCake=__webpack_require__(1650);var _headerCake2=_interopRequireDefault(_headerCake);var _formatting=__webpack_require__(81);var _main=__webpack_require__(166);var _main2=_interopRequireDefault(_main);var _statsFirstView=__webpack_require__(1850);var _statsFirstView2=_interopRequireDefault(_statsFirstView);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatsPostDetail",mixins:[(0,_dataObserve2.default)("postViewsList")],propTypes:{path:_react.PropTypes.string,postViewsList:_react.PropTypes.object},goBack:function goBack(){var pathParts=this.props.path.split("/");var defaultBack="/stats/"+pathParts[pathParts.length-1];(0,_page2.default)(this.props.context.prevPath||defaultBack)},componentDidMount:function componentDidMount(){window.scrollTo(0,0)},render:function render(){var title=void 0;var post=this.props.postViewsList.response.post;var isLoading=this.props.postViewsList.isLoading();var postOnRecord=post&&post.post_title!==null;if(postOnRecord){if(typeof post.post_title==="string"&&post.post_title.length){title=_react2.default.createElement(_emojify2.default,null,(0,_formatting.decodeEntities)(post.post_title))}}if(!postOnRecord&&!isLoading){title=this.translate("We don't have that post on record yet.")}return _react2.default.createElement(_main2.default,null,_react2.default.createElement(_statsFirstView2.default,null),_react2.default.createElement(_headerCake2.default,{onClick:this.goBack},title),_react2.default.createElement(_statsSummaryChart2.default,{key:"chart",loading:isLoading,dataList:this.props.postViewsList,barClick:this.props.barClick,activeKey:"period",dataKey:"value",labelKey:"period",labelClass:"visible",tabLabel:this.translate("Views")}),_react2.default.createElement(_statsDetailMonths2.default,{dataKey:"years",title:this.translate("Months and Years"),total:this.translate("Total"),postViewsList:this.props.postViewsList}),_react2.default.createElement(_statsDetailMonths2.default,{dataKey:"averages",title:this.translate("Average per Day"),total:this.translate("Overall"),postViewsList:this.props.postViewsList}),_react2.default.createElement(_statsDetailWeeks2.default,{postViewsList:this.props.postViewsList}))}});module.exports=exports["default"]},2979:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _classnames=__webpack_require__(10);var _classnames2=_interopRequireDefault(_classnames);var _statsList=__webpack_require__(1817);var _statsList2=_interopRequireDefault(_statsList);var _legend=__webpack_require__(1818);var _legend2=_interopRequireDefault(_legend);var _placeholder=__webpack_require__(1729);var _placeholder2=_interopRequireDefault(_placeholder);var _header=__webpack_require__(2976);var _header2=_interopRequireDefault(_header);var _card=__webpack_require__(89);var _card2=_interopRequireDefault(_card);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}exports.default=_react2.default.createClass({displayName:"StatModuleVideoDetails",render:function render(){var isLoading=this.props.summaryList.isLoading();var classes=(0,_classnames2.default)("stats-module","is-expanded","summary",{"is-loading":isLoading,"has-no-data":this.props.summaryList.isEmpty()});return _react2.default.createElement(_card2.default,{className:classes},_react2.default.createElement(_header2.default,{title:this.translate("Video Embeds"),showActions:false}),_react2.default.createElement(_legend2.default,{label:this.translate("Page")}),_react2.default.createElement(_placeholder2.default,{isLoading:isLoading}),_react2.default.createElement(_statsList2.default,{moduleName:"Video Details",data:this.props.summaryList.response.pages?this.props.summaryList.response.pages:[]}))}});module.exports=exports["default"]},2980:function(module,exports,__webpack_require__){"use strict";var _freeze=__webpack_require__(276);var _freeze2=_interopRequireDefault(_freeze);var _find2=__webpack_require__(27);var _find3=_interopRequireDefault(_find2);var _react=__webpack_require__(1);var _react2=_interopRequireDefault(_react);var _page=__webpack_require__(33);var _page2=_interopRequireDefault(_page);var _debug=__webpack_require__(3);var _debug2=_interopRequireDefault(_debug);var _dataObserve=__webpack_require__(131);var _dataObserve2=_interopRequireDefault(_dataObserve);var _headerCake=__webpack_require__(1650);var _headerCake2=_interopRequireDefault(_headerCake);var _statsModule=__webpack_require__(2129);var _statsModule2=_interopRequireDefault(_statsModule);var _statsStrings=__webpack_require__(2132);var _statsStrings2=_interopRequireDefault(_statsStrings);var _statsCountries=__webpack_require__(2324);var _statsCountries2=_interopRequireDefault(_statsCountries);var _statsSummaryChart=__webpack_require__(2327);var _statsSummaryChart2=_interopRequireDefault(_statsSummaryChart);var _statsVideoDetails=__webpack_require__(2979);var _statsVideoDetails2=_interopRequireDefault(_statsVideoDetails);var _main=__webpack_require__(166);var _main2=_interopRequireDefault(_main);var _statsFirstView=__webpack_require__(1850);var _statsFirstView2=_interopRequireDefault(_statsFirstView);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var debug=(0,_debug2.default)("calypso:stats:site");var StatsStrings=(0,_statsStrings2.default)();module.exports=_react2.default.createClass({displayName:"StatsSummary",mixins:[(0,_dataObserve2.default)("sites","summaryList")],getActiveFilter:function getActiveFilter(){var _this=this;return(0,_find3.default)(this.props.filters(),function(filter){return _this.props.path===filter.path||filter.altPaths&&-1!==filter.altPaths.indexOf(_this.props.path)})},goBack:function goBack(){var pathParts=this.props.path.split("/");var queryString=this.props.context.querystring?"?"+this.props.context.querystring:null;if(history.length){history.back()}else{setTimeout(function(){_page2.default.show("/stats/"+pathParts[pathParts.length-1]+queryString)})}},getDefaultProps:function getDefaultProps(){return{filters:(0,_freeze2.default)([])}},getInitialState:function getInitialState(){return{date:this.props.date}},componentDidMount:function componentDidMount(){window.scrollTo(0,0)},render:function render(){var site=this.props.sites.getSelectedSite();var summaryViews=[];var title=void 0;var summaryView=void 0;var chartTitle=void 0;var barChart=void 0;debug("Rendering summary-top-posts.jsx",this.props);switch(this.props.context.params.module){case"referrers":title=this.translate("Referrers");summaryView=_react2.default.createElement(_statsModule2.default,{key:"referrers-summary",path:"referrers",moduleStrings:StatsStrings.referrers,site:site,dataList:this.props.summaryList,period:this.props.period,summary:true});break;case"clicks":title=this.translate("Clicks");summaryView=_react2.default.createElement(_statsModule2.default,{key:"clicks-summary",path:"clicks",moduleStrings:StatsStrings.clicks,site:site,dataList:this.props.summaryList,period:this.props.period,summary:true});break;case"countryviews":title=this.translate("Countries");summaryView=_react2.default.createElement(_statsCountries2.default,{key:"countries-summary",path:"countries-summary",site:site,dataList:this.props.summaryList,period:this.props.period,summary:true});break;case"posts":title=this.translate("Posts & Pages");summaryView=_react2.default.createElement(_statsModule2.default,{key:"posts-summary",path:"posts",moduleStrings:StatsStrings.posts,site:site,dataList:this.props.summaryList,period:this.props.period,summary:true});break;case"authors":title=this.translate("Authors");summaryView=_react2.default.createElement(_statsModule2.default,{key:"authors-summary",path:"authors",moduleStrings:StatsStrings.authors,site:site,dataList:this.props.summaryList,period:this.props.period,followList:this.props.followList,className:"stats__author-views",summary:true});break;case"videoplays":title=this.translate("Videos");summaryView=_react2.default.createElement(_statsModule2.default,{key:"videoplays-summary",path:"videoplays",moduleStrings:StatsStrings.videoplays,site:site,dataList:this.props.summaryList,period:this.props.period,followList:this.props.followList,summary:true});break;case"podcastdownloads":title=this.translate("Podcasts");summaryView=_react2.default.createElement(_statsModule2.default,{key:"podcastdownloads-summary",path:"podcastdownloads",moduleStrings:StatsStrings.podcastdownloads,site:site,dataList:this.props.summaryList,period:this.props.period,followList:this.props.followList,summary:true});break;case"videodetails":title=this.translate("Video");if(this.props.summaryList.response.post){title=this.props.summaryList.response.post.post_title}chartTitle=_react2.default.createElement("h3",{key:"summary-title",className:"stats-section-title"},this.translate("Video Details"));summaryViews.push(chartTitle);barChart=_react2.default.createElement(_statsSummaryChart2.default,{key:"video-chart",loading:this.props.summaryList.isLoading(),dataList:this.props.summaryList,activeKey:"period",dataKey:"value",labelKey:"period",labelClass:"video",tabLabel:this.translate("Plays")});summaryViews.push(barChart);summaryView=_react2.default.createElement(_statsVideoDetails2.default,{summaryList:this.props.summaryList,key:"page-embeds"});break;case"searchterms":title=this.translate("Search Terms");summaryView=_react2.default.createElement(_statsModule2.default,{key:"search-terms-summary",path:"searchterms",moduleStrings:StatsStrings.search,site:site,dataList:this.props.summaryList,period:this.props.period,summary:true});break}summaryViews.push(summaryView);return _react2.default.createElement(_main2.default,null,_react2.default.createElement(_statsFirstView2.default,null),_react2.default.createElement("div",{id:"my-stats-content"},_react2.default.createElement(_headerCake2.default,{onClick:this.goBack},title),summaryViews))}})},3307:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.receiveSiteStats=receiveSiteStats;exports.requestSiteStats=requestSiteStats;var _wp=__webpack_require__(28);var _wp2=_interopRequireDefault(_wp);var _actionTypes=__webpack_require__(2);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function receiveSiteStats(siteId,statType,query,data){return{type:_actionTypes.SITE_STATS_RECEIVE,statType:statType,siteId:siteId,query:query,data:data}}function requestSiteStats(siteId,statType,query){return function(dispatch){dispatch({type:_actionTypes.SITE_STATS_REQUEST,statType:statType,siteId:siteId,query:query});return _wp2.default.site(siteId)[statType](query).then(function(data){dispatch(receiveSiteStats(siteId,statType,query,data));dispatch({type:_actionTypes.SITE_STATS_REQUEST_SUCCESS,statType:statType,siteId:siteId,query:query})}).catch(function(error){dispatch({type:_actionTypes.SITE_STATS_REQUEST_FAILURE,statType:statType,siteId:siteId,query:query,error:error})})}}}});